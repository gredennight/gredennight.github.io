# [На главную](./index.html)

# 08.02.22  Лекція 1. Метод розв'язання нелінійних рівнянь

Ссыль на запись: https://youtu.be/33170Mi2gEk

чисельні розвязання нелінійних рівнянь вигляду 
$$
\label{1.1}\tag{1}
f(x)=0
$$
полягає в знаходженні такого x=x* для якого рівняння (1) задовольняється з заданою точністю Е тобто

$$ {2}
|f(x^*)|\leq E\tag{2}
$$
Складається з наступних етапів:

1) відокрремлення кореня
2) уточнення кореня за допомогою обчислюваного алгоритма

на першому етапі застосовуєжться графічний або аналітичний підходи

## Аналітичний підхід

### теорема

неперервна строго монотонна функція f(x) має і при тому єдиний нуль на відрізку [a,b] тоді і тільки тоді коли на його кінцях вона приймає значення різних знаків.

## Графічний спосіб

побудування графіка функції f(x)

## 1. Метод половинного ділення

попередньо граф методом визначений інтервал локалізації кореня $x^*:x^*\in [a_0,b_0]$

### Алгоритм методу:

1. початковий інтервал [a0,b0] ділиться навпіл:	$c=\frac{a_0+b_0}{2}$
2. Визначаються значення функції f(x) в точках x1=a0, x2=c, x3=b0, тобто f(a0), f(c) f(b0).
3. Далі обирається та половина початкового інтервалу [a0,b0], на кінцях якої функція f(x) має протилежні знаки.
   Якщо $f(a_0)*f(c)<0$ то наступний відрізок [a1,b1]=[a0,c], інакше [a1,b1]=[c,b0].
4. Перевіряється умова закінчення процесу пошуку:
   $$
   |b_1-a_1|\leq 2E\tag{3}
   $$
   E - задана точність.
   Якщо умова (у) виконана, то $x^*=\frac{b_1+1_1}{2}$ , якщо умова (3) не виконана, процес пошуку треба повторити.

Таким чином на якомусь етапі визначено корінь x* з заданою точністю на основі побудованих вкладених один в одного відрізків$[a_0,b_0],[a_1,b_1],[a_2,b_2],..,[a_k,b_k],b_k>a_k$​ 
Для цих відрізків довжини:
$$
|b_1-a_1|=\frac{1}{2}|b_0-a_0|\\
|b_2-a_2|=\frac{1}{2}|b_1-a_1|\\...\\
|b_3-a_3|=\frac{1}{2}|b_2-a_2|\\
$$

звідки і назва методу.

![image-20220208193856276](https://s2.loli.net/2022/02/23/53Xp21D9viudwHm.png)

рис.1 Метод половинного ділення

### <u>Приклад</u>

Розв'язати рівняння $e^{2x}+3x-4=0$ з точністю $E=10^{-2}$ 
попередньо графічним способом знайдений інтервал локалізації кореня
[a0,b0]=[0,4;0,6]

| $k$  | $a_k$  | $b_k$  | $f(a_k)$ | $f(b_k)$ | $\frac{a_k+b_k}{2}$ |
| ---- | ------ | ------ | -------- | -------- | ------------------- |
| 0    | 0,4000 | 0,6000 | -0,5745  | 1,2101   | 0,5000              |
| 1    | 0,4000 | 0,5000 | -0,5745  | 0,2183   | 0,4500              |
| 2    | 0,4500 | 0,5000 | -0,1904  | 0,2183   | 0,4750              |
| 3    | 0,4500 | 0,4750 | -0,1904  | 0,0107   | 0,4625              |
| 4    | 0,4625 | 0,4750 | -0,0906  | 0,0107   | 0,4688              |
| 5    | 0,4688 | 0,4750 | -0,0402  | 0,0107   | 0,4719              |
| 6    | 0,4719 | 0,4750 | -0,0148  | 0,0107   | 0,4734              |
| 7    | 0,4734 | 0,4750 | -0,0020  | 0,0107   | [0,4742]            |


Табл. 1

## 2. Метод Ньютона (метод дотичних)

Графічна інттерпретація метода
<img src="https://s2.loli.net/2022/02/23/4MRNmJzpigZtD9k.png" alt="image-20220208195255967" style="zoom:80%;" /> 

Проведемо дотичну до лінії y=f(x) в точці x=x0. Рівняння дотичної:$y-y_0=f'(x_0)(x-x_0)$ 
Знайдемо точку перетину дотичної з віссю Ox$-y_0=f'(x_0)(x_1-x_0)$
Тобто $x_1=x_0-\frac{y_0}{f'(x_0)}=x_0-\frac{f(x_0)}{f'(x_0)}$
Процес повторюється:
$$
$x_{k+1}=x_k-\frac{f(x_k)}{f'(x_k)};\,\,x=0,1,2.\tag{4}
$$
Для початку обчислень треба задати початкове приближення x0.
Умова закінчення процесу пошуку:$|x_1-x_0|\leq E$
Якщо умова (5) виконується, то $x^*=x_{k+1}$

### Теорема

Нехай на відрізку [a0,b0] функція f(x) має першу і другу похідні постійного знаку і нехай f(a0)*f(b0)<0. Тоді, якщо для $x_0\in [a_0,b_0]$ виконується 
$$
f(x_0)f''(x_0)>0\tag{6}
$$
то почати з точки x0 послідовність {Xk},(k=0,1,2...), яка задається формулою (4), монотонно збігається до кореня x`*` , рівняння f(x)=0.

### <u>Приклад</u>

$e^{2x}+3x-4=0$ з точністю $E=10^{-2}$ 
Маємо:
$$
f(x)=e^{2x}+3x-4\\
f'(x)=2e^{2x}+3\\
f''(x)=4e^{2x}\\
f'(x)\,\,та\,f''(x)
$$
додатні на всій області визначення f(x).

Виберемо x0=0,6
Маємо:$f(0.6)f''(0.6)>0$
Результат обчислень:

| $k$  | $x_k$    | $f(x_k)$ | $f'(x_k)$ | $-\frac{f(x_k)}{f'(x_k)}$ |
| ---- | -------- | -------- | --------- | ------------------------- |
| 0    | 0,6000   | 1,1201   | 9,6402    | -0,1162                   |
| 1    | 0,4838   | 0,0831   | 8,2633    | -0,0101                   |
| 2    | 0,4738   | 0,0005   | 8,1585    | -0,0001                   |
| 3    | [0,4737] |          |           |                           |

## 3. Метод січних

Застосування методу Ньютона потребує на кожній ітерації обчислення значення функції та її похідної. Замінемо похідну функції наближенням різницевим співвідношенням:
$f'(x_k)=\frac{f(x_k)-f(x_{k-1})}{x_k-x_{k-1}}$
Тоді формула (4) набуває вигляду:
$$
x_{k+1}=x_k-\frac{f(x_k)(x_k-x_{k-1})}{f(x_k)-f(x_{k-1})}; k=0,1,2..\tag{7}
$$
Після перетворень:
$$
x_{k+1}=\frac{x_{k-1}f(x_k)-x_kf(x_{k-1})}{f(x_k)-f(x_{k-1})}\tag{8}
$$
![image-20220208201554777](https://s2.loli.net/2022/02/23/JBmZyUuef6Mptvx.png)

Легко отримати, що $x_2=\frac{x_0y_1-x_1y_1}{y_1-y_0}$ це точка перетину січної AB з лінією абсцис.
    Для початку розрахунків за формулою (8) необхідне завдання двох початкових точок x0 x1. Вибір точки х0 можна здійснювати за тим же принципом, що і в методі дотичних. Друга початкова точка х1 обирається в безпосередній близості від х0, бажано між точкою х0 і шуканим коренем.

Умова закінчення процесу:$|x_{k+1}-x_k|\leq E$

### Приклад

$e^{2x}+3x-4=0$

$x_0=0.6;x_1=0.59$

| $k$  | $x_K$    | $f(x_k)$ |
| ---- | -------- | -------- |
| 0    | 0,6000   | 1,1201   |
| 1    | 0,5900   | 1,0244   |
| 2    | 0,4830   | 0,0765   |
| 3    | 0,4744   | 0,0056   |
| 4    | [0,4737] |          |



## 4. Метод простої ітерації

Початкове рівняння f(x)=0 приводиться до вигляду
$$
x=\varphi(x)\tag{9}
$$
Розв'язок  шукається на основі побудування послідовності
$$
x_{k+1}=\varphi(x_k);k=0,1,2..\tag{10}
$$
починаючи з деякого х0.

Умови збіжності методу і оцінка похибки результату визначаються теоремою:

### Теорема

Нехай u(x) - визначена і диференційована на [a,b]. тоді, якщо виконується умови
1)$\varphi(x) \in [a,b],\,\,\, \forall x \in[a,b]$
2)$\exist q: |\varphi'(x)\leq q<1|,\forall x \in(a,b)$
то рівняння (9)має і при тому єдиний на [a,b] корінь x`*` і до цього кореня збігається послідовність {Xk},(k=0,1,2...), побудована за формулою (10):$\lim _{k \rightarrow \infty} x_{k+1}=x^{*}$, яка починається з будь-якого $x_0 \in[a,b]$

Умови закінчення:$|x_{k+1}-x_k|\leq E$

### Зауваження

Якщо безпосереднє перетворення початкового рівняння f(x)=0 до вигляду х=u(x) не дозволяє отримати умови збіжності методу, можна застосувати таке еквівалентне рівняння:
$$
x=x-\lambda f(x)\tag{11}
$$
Де $\lambda$ - параметр, який підбирається таким чином, що в потрібній області виконується умова$|\varphi'(x)|=|1-\lambda f'(x)|\leq q<1$

### Приклад

$e^{2x}+3x-4=0;x\in[0.5;0.6]$

Перетворимо початкове рівняння до вигляду
$$
x=\frac{ln(4-3x)}{2}
$$
Оскільки для (12) маємо:

$\varphi'(x)=-\frac{3}{2(4-3x)}\\max_{x\in[0.5;0.6]}\frac{3}{2(4-3*0.6)}=0.6818<1$
то процес $x_{k+1}=\frac{ln(4-3x_k)}{2},k=0,1,2...$збігається.
В якості початкової точки візьмемо х0=0,5.

![image-20220208203152947](https://s2.loli.net/2022/02/23/zILel8tEUoYPZjn.png)

# 15.02.22 Лекція 2. Наближення функції

Запись: https://youtu.be/sD3HdA475sk

## Наближення функції

### Постановка задачі

Нехай на деякій множині задана система функцій
$$
\varphi_0(x),\varphi_1(x),..,\varphi_m(x)\tag{1}
$$


які будемо вважати достатньо гладкими (тобто неперервно диференційованими).
Система функцій (1) називається <u>основною системою</u>

Виведемо поліном
$$
Q_m(x)=c_0\varphi_0(x)+c_1\varphi_1(x)+..+c_m\varphi_m(x)\tag{2}
$$

де C0,C1,C2,...,Cm - постійні коефіцієнти.

Qm(x) називається узагальненим поліномом порядку m. Наприклад, якщо

$\varphi_0(x)=1;\varphi_1(x)=x;\varphi_2(x)=x^2,...,\varphi_m(x)=x^m$, то
 $Q_m(x)=c_0+c_1x+c_2x^2+...+c_mx^m$
маємо звичайний алгебраїчний поліном степені m.

Якщо

$\begin{aligned}
&\varphi_{0}(x)=1, \varphi_{1}(x)=\cos x, \quad \varphi_{2}(x)=\sin x, \varphi_{3}(x)=\cos 2 x, \\
&\varphi_{4}(x)=\sin 2 x, \ldots \\
&Q_{n}(x)=a_{0}+a_{1} \cos x+b_{1} \sin x+\ldots, a_{m} \cos m x+b_{m} \sin m x
\end{aligned}$

Це тригонометричний поліном порядку m.

Сформулюємо задачу наближення функції.

### задача

Задану функцію f(x) треба замінити узагальненим поліномом Qm(x) заданого порядку m так, щоб відхилення функції f(x) від Qm(x) на вказаній множині х було найменшим.

Q(x) називається <u>апроксимуючим поліномом</u>.

Множина х може складатися з окремих точок х0,х1,...,хn - тоді маємо точкове неближення.

Якщо х - це відрізок a<=x<=b, то наближення називається <u>інтегральним</u>

Відхилення розуміється по-різному: якщо значення f(Xk) i Qm(Xk), k=0,1...,n співпадають - маємо задачу інтерполяції:

Існують також задачі середньоквадратичного наближення, рівномірного наближення і т.д.

## Інтерполювання функцій

Нехай у=f(x) задана в точках х0,х1,...,хn своїми значеннями у0,у1,...yn (рис1)

![image-20220216202536153](https://s2.loli.net/2022/02/23/BDoh8J2n61Q5taG.png)

​                                                                        рис1

Будемо вважати функцію f(x) і поліном $Q_m(x)=c_0+c_1x+c_2x^2+...+c_mx^m$ близкими, якщо вони співпадають на заданій множині точок х0,х1,...,хn. Ці точки називаються вузлами інтерполяції.

### Задача

Знайти поліном Qm(x) найнижчої степені m такий, що$Q_m(x_k)=f(x_k);k=0,1,2,..$

Qm(x) - називається <u>інтерполяціонним поліномом</u>

Доведено, що існує єдиний поліном степені не вище n, який приймає в точках х0,х1,...,хn задані значення.
Покладемо m=n

Коефіцієнти полінома Qn(x) знайдемо із системи
$$
\tag{1}
\left\{\begin{array}{l}
c_{0}+c_{1} x_{0}+c_{2} x_{0}^{2}+\ldots+c_{n} x_{0}^{n}=y_{0} \\
c_{0}+c_{1} x_{1}+c_{2} x_{1}^{2}+\ldots+c_{n} x_{1}^{n}=y_{1} \\
............\\
c_0+c_1x_n+c_2x^2_n+...+c_nx^n_n=y_n
\end{array}\right.
$$
Визначник системи (1) - це визначник Вандельмонда.
$$
\Delta=\left|\begin{array}{ccccc}
1 & x_{0} & x_{0}^{2} & \cdots & x_{0}^{n} \\
1 & x_{1} & x_{1}^{2} & \cdots & x_{1}^{n} \\
- & - & - & \cdots & - \\
1 & x_{n} & x_{n}^{2} & \ldots & x_{n}^{n}
\end{array}\right|=\prod \begin{gathered}
 \\

\end{gathered} (x_q-x_p)\neq 0\\
(0 \leqslant p<q<n)
$$
Система (1) має єдиний роз'вязок.
Поліном Ln(x) - це інтерполяційний поліном Лагранжа.

Він має вигляд:
$$
\tag{2}
L_{n}(x)=\sum_{i=0}^{n} \frac{\left(x-x_{0}\right)\left(x-x_{1}\right) \ldots\left(x-x_{i-1}\right)\left(x-x_{i+1}\right) \ldots\left(x-x_{n}\right)}{\left(x_{i}-x_{0}\right)\left(x_{i}-x_{1}\right) \ldots\left(x_{i}-x_{i-1}\right)\left(x_{i}-x_{i+1}\right) \ldots\left(x_{i}-x_{n}\right)} y_{i}
$$
Отже

$$
\begin{aligned}
&L_{n}(x)=\frac{\left(x-x_{1}\right)\left(x-x_{2}\right) \ldots\left(x-x_{n}\right)}{\left(x_{0}-x_{1}\right)\left(x_{0}-x_{2}\right) \ldots\left(x_{0}-x_{n}\right)} y_{0}+\frac{\left(x-x_{0}\right)\left(x-x_{2}\right) \ldots\left(x-x_{n}\right)}{\left(x_{1}-x_{0}\right)\left(x_{1}-x_{2}\right) \ldots\left(x_{1}-x_{n}\right)} y_{1}+ \\
&+\ldots+\frac{\left(x-x_{0}\right)\left(x-x_{1}\right) \ldots\left(x-x_{n-1}\right)}{\left(x_{n}-x_{0}\right)\left(x_{11}-x_{1}\right) \ldots\left(x_{n}-x_{n-1}\right)} y_{n} 
\end{aligned}\tag{3}
$$
Формула (2) - це інтерполяційна формула Лагранжа.

### Приклад

Знайти поліном степені m<=2, який в точках х0=1, х1=5, х2=-2 приймає значення у0=4, у1=1, у2=7

Маємо:
$$
\begin{aligned}
&L_{2}(x)=\frac{(x-5)(x+2)}{-4 \cdot 3} \cdot 4+\frac{(x-1)(x+2)}{4 \cdot 7} \cdot 1+ \\
&+\frac{(x-1)(x-5)}{(-3)(-7)} \cdot 7=-\frac{1}{3}(x-5)(x+2)+\frac{1}{28}(x-1)(x+2)+ \\
&\quad+\frac{1}{3}(x-1)(x-5)
\end{aligned}
$$


### Приклад 2

![image-20220404220151314](https://s2.loli.net/2022/04/05/X9NnvuIUofaVcEA.png)

![image-20220404220224936](https://s2.loli.net/2022/04/05/2YB8Z4rXaMCF79k.png)

### Недолік полінома Лагранжа

при додаванні одного нового вузла треба все перерахувати.

## Роздільні різниці

Нехай f(x) задана значеннями у0,у1,...,уn в вузлах х0,х1,...хn
Складемо відношення:

$[y;x_0,x_1]=\frac{y_1-y_0}{x_2-x_1}$

це число називається роздільною різницею першого порядку функції f(x) в вузлі х0

Для точки х1 будемо мати: $[y;x_1,x_2]=\frac{y_2-y_1}{x_2-x_1}$

Для точки х2: $[y;x_2,x_3]=\frac{y_3-y_2}{x_3-x_2}$і т.д.

Роздільна різниця 2го порядку в точці х0:

$$
\begin{aligned}
&{\left[y_{j} ; x_{0}, x_{1}, x_{2}\right]=\frac{\left[y_{j} x_{1}, x_{2}\right]-\left[y_{j} x_{0}, x_{1}\right]}{x_{2}-x_{0}}=} \\
&=\frac{\frac{y_{2}-y_{1}}{x_{2}-x_{1}}-\frac{y_{1}-y_{0}}{x_{1}-x_{0}}}{x_{2}-x_{0}},
\end{aligned}
$$


### Приклад

Знайти роздільні різниці для функції у=х^3 в точках х0=1,х1=3,х2=5,х3=2,х4=4

Складемо таблицю для обчислення різниць

![image-20220216204028034](https://s2.loli.net/2022/02/23/Arb4Fw59OU2kVPC.png)

Очевидно, що різниці 4го порядку дорівнюють 0 (як і відповідні похідні функції у=х^3)

## Інтерполяційна формула Ньютона

Запишемо за допомогою роздільних різниць поліном  Pn(x), який в точках (вузлах) х0,х1,...,хn приймає значення у0,у1,...,уn
Запишемо роздільну різницю [y;x0,x1], а також [y;x0,x1,x2], ..., [y;x0,x1,...,xn] Це ми можемо зробити.
Очевидно, що

$$
\begin{array}{r}
{\left[y ; x_{0}, x_{0}\right]=\frac{P_{n}\left(x_{0}\right)-P_{n}(x)}{x_{0}-x}=} \\
=\frac{P_{n}(x)-P_{n}\left(x_{0}\right)}{x-x_{0}}=\frac{P_{n}(x)-y_{0}}{x-x_{0}}
\end{array}
$$
Звідки маємо:

$$
P_n(x)=y_0+[y;x,x_0](x-x_0)\tag{1}
$$
Аналогічно:

$$
[y;x_,x_0,x_1]=\frac{[y;x_0,x_1]-[y;x,x_0]}{x_1-x_0}=\frac{[y;x,x_0]-[y;x_0,x_1]}{x-x_1}
$$
Тобто

$$
[y;x,x_0]=[y;x_0,x_1]+[y;x,x0,x1](x-x1)\tag{2}
$$
Підставимо (2) в (1). Маємо:

$$
P_{n}(x)=y_{0}+\left[y_{j} ; x_{0}, x_{1}\right]\left(x-x_{0}\right)+\left[y ; x, x_{0}, x_{1}\right]\left(x-x_{0}\right)\left(x-x_{1}\right)
\label{2.3}\tag{3}
$$
Далі:

$$
[y;x,x0,x1,x2]=\frac{[y;x0,x1,x2]-[y;x,x0,x1]}{x2-x}=\\=\frac{[y;x,x0,x1]-[y;x0,x1,x2]}{x-x2}
$$
Тобто:

$$
\tag{4}[y;x,x_0,x_1]=[y;x0,x1,x2]+[y;x,x0,x1,x2](x-x2)
$$
Підставимо (4) в (3):

$$
\begin{aligned}
&P_{n}(x)=y_{0}+\left[y_{j} x_{0}, x_{1}\right]\left(x-x_{0}\right)+\left[y_{j} x_{0}, x_{1}, x_{2}\right]\left(x-x_{0}\right)\left(x-x_{1}\right)+ \\
&+\left[y ; x, x_{0}, x_{1}, x_{2}\right]\left(x-x_{0}\right)\left(x-x_{1}\right)\left(x-x_{2}\right)
\end{aligned}\tag{5}
$$
і т.д. В результаті отримаємо:

$$
\begin{aligned}
P_{n}(x) &=y_{0}+\left[y_{;} x_{0}, x_{1}\right]\left(x-x_{0}\right)+\left[y_{;} ; x_{0}, x_{1}, x_{2}\right]\left(x-x_{0}\right)\left(x-x_{1}\right)+\ldots \\
&+\ldots+\left[y ; x_{0}, x_{1}, \ldots, x_{n}\right]\left(x-x_{0}\right)\left(x-x_{1}\right) \ldots\left(x-x_{n-1}\right) \quad 
\end{aligned}\tag{6}
$$
Формула (6) - <u>інтерполяційна формула Ньютона</u>. (Відстань між вузлами може бути різна!)

При появі нового вузла в формулі (6) з'явиться ще один доданок.

### Приклад

Знайти поліном P3(x), який в вузлах х0=-1,х1=3,х2=4,х3=0 приймає значення у0=4, у1=2 у2=-3, у3=1

Запишемо обчислення в таблицю![image-20220216212637570](https://s2.loli.net/2022/02/23/fCbB1EARmcwdUPt.png)

Маємо:
$$
\begin{aligned}
&P_{3}(x)=4-\frac{1}{2}(x+1)-\frac{9}{10}(x+1)(x-3)- \\
&-13 / 30(x+1)(x-3)(x-4)
\end{aligned}\tag{7}
$$
Поліном P3(x) має бути таким же, як і поліном L3(x) Лагранжа.

### Зауваження

Вузли інтерполяції х0,х1,...,хn можуть бути розташовані в довільній послідовності. Зокрема, якщо вузли перенумеровані в зворотному порядку, поліном (6) приймає вигляд:
$$
\begin{aligned}
P_{n}(x) &=y_{n}+\left[x_{n} ; x_{n}, x_{n-1}\right]\left(x-x_{n}\right)+\left[y_{j} x_{n}, x_{n-1}, x_{n-2}\right] \\
\cdot &\left(x-x_{n}\right)\left(x-x_{n-1}\right)+\ldots+\left[y ; x_{n}, x_{n-1}, \ldots, x_{0}\right]\left(x-x_{n}\right) \cdot\left(x-x_{n-1}\right)*...\\
& \cdot\left(x-x_{1}\right)
\end{aligned}\tag{8}
$$
Виразу (6) і (8) еквівалентні.

# 15.02.22 Лекція 2.5. Кінцеві різниці

## Кінцеві різниці

Нехай функція y=f(x) задана своїми значеннями в вузлах х0,х1,...,хn. де х1=х0+h, x2=x0+2h, ...

Тобто вузли є рівновіддаленими. Відповідні значення функції y0, y1, ..., yn

### Визначення

Кінцевою різницею 1 порядку функції y=f(x) в точці х0 називається величина
$$
\begin{aligned}
&\Delta f\left(x_{0}\right)=f\left(x_{1}\right)-f\left(x_{0}\right), \\
&\Delta y_{0}=y_{1}-y_{0}
\end{aligned}\tag{1}
$$
Аналогічно вводяться різниці 2го порядку $\Delta^2y_0=\Delta[\Delta y_0]=\Delta[y_1-y_0]=y_2-2y_1+y_0\tag{2}$

Для точки х1 будемо мати: 
$\Delta y_1=y_2-y_1\\\Delta^2 y_1=y_3-2y_2+y_1$

### Приклад

Знайти кінцеві різниці для функції у=x^3 в вузлах х0=0, х1=1, х2=2, х3=3, х4=4

Обчислення зведемо в таблицю

![image-20220216215043189](https://s2.loli.net/2022/02/23/Ek8OFesTicpC5It.png)

Кінцеві різниці <img src="https://s2.loli.net/2022/02/23/8tBWNpDSyev79E3.png" alt="image-20220216215147730" style="zoom:80%;" /> називаються кінцевими різницями 1го роду.

Кінцеві різниці 2го роду позначаються ![image-20220216215230965](https://s2.loli.net/2022/02/23/WVLDgIzK5xhQbrY.png) (набла) і обчислюються так:![image-20220216215300708](https://s2.loli.net/2022/02/23/fT97MlDApwPL4v3.png)

Тобто береться різниця "назад".

Різниця 2го порядку:

![image-20220216215331771](https://s2.loli.net/2022/02/23/MTwq3b9csPYxySn.png)

### Приклад

Обчислити кінцеві різниці 2го роду для функції y=x^3 в вузлаї х0=0, х1=1, х2=2, х3=3, х4=4. 

Розрахунки представлені в таблиці

![image-20220216215455366](https://s2.loli.net/2022/02/23/aOiZj9FSkUxwgpA.png)

## Формула Ньютона для рівновіддалених вузлів

Розглянемо рівновіддалені вузли:
х0,х1=х0+h, x2=x0+2h, ... , xn=x0+n*h

Отримаємо для цього випадку співвідношення між роздільними і кінцевими різницями:$\begin{aligned}
&{\left[y_{;}, x_{0}, x_{1}\right]=\frac{y_{1}-y_{0}}{x_{1}-x_{0}}=\frac{\Delta y_{0}}{h}} \\
&{\left[y ; x_{0}, x_{1}, x_{2}\right]=\frac{\left[y ; x_{1}, x_{2}\right]-\left[y ; x_{0}, x_{1}\right]}{x_{2}-x_{0}}=}
\end{aligned}$
$$
=\frac{\frac{y_{2}-y_{1}}{h}-\frac{y_{1}-y_{0}}{h}}{2 h}=\frac{y_{2}-2 y_{1}+y_{0}}{2 h^{2}}=\frac{\Delta^{2} y_{0}}{2 h^{2}}\tag{3}
$$
Аналогічно неважко отримати, що

$$
\begin{aligned}
&{\left[y ; x_{0}, x_{1}, x_{2}, x_{3}\right]=\frac{\Delta^{3} y_{0}}{3 ! h^{3}}, \ldots,} \\
&{\left[y ; x_{0}, x_{1}, \ldots, x_{n}\right]=\frac{\Delta^{n} y_{0}}{n ! h^{n}}}
\end{aligned}
$$
Перепишемо інтерполяційну формулу Ньютона в кінцевих різницях 1го роду:

$$
\begin{aligned}
&P_{n}(x)=y_{0}+\frac{\Delta y_{0}}{1 ! h}\left(x-x_{0}\right)+\frac{\Delta^{2} y_{0}}{2 ! h}\left(x-x_{0}\right)\left(x-x_{1}\right)+\ldots \\
&+\frac{\Delta^{n} y_{0}}{n ! h^{n}}\left(x-x_{0}\right)\left(x-x_{1}\right) \ldots\left(x-x_{n-1}\right)
\end{aligned}\tag{4}
$$
Це <u>інтерполяційна формула Ньютона 1го роду</u>

### Приклад

Знайти P3(x) за формулою (4), якщо х0=0, х1=2, х2=4, х3=6, у0=1, у1=4, у2=2, у3=7
(Очевидно, що вузли є рівновіддаленими і h=2)

Розрахунки кінцевих різниць зведемо в таблицю

![image-20220216220005372](https://s2.loli.net/2022/02/23/uoxaneb3kPNEXDA.png)

Використовуємо перший рядок (тут більше всього інформації про кінцеві різниці)

![image-20220216220057344](https://s2.loli.net/2022/02/23/7UxIWG8vqCeVJRa.png)![image-20220216220109177](https://s2.loli.net/2022/02/23/hqQeYSosGOZv4RK.png)

Отримаємо співвідношення між кінцевими різницями 2го роду і відповідними розділеними різницями.

Маємо:

![image-20220216220213370](https://s2.loli.net/2022/02/23/rwz4Ms32jGeZR9x.png)

Можна показати, що

![image-20220216220235922](https://s2.loli.net/2022/02/23/suJH4aONzlmFGWM.png)

Отримаємо <u>інтерполяційну формулу Ньютона 2го роду</u> (з використанням кінцевих різниць 2го роду)

Після підстановки виразів для кінцевих різниць в формулу

![image-20220216220358499](https://s2.loli.net/2022/02/23/hyLgCEV8x7WqslB.png)

Отримаємо, що

$\begin{aligned}
&P_{n}(x)=y_{n}+\frac{\nabla y_{n}}{1 ! h}\left(x-x_{n}\right)+\frac{\nabla y_{n}}{2 ! h^{2}}\left(x-x_{n}\right)\left(x-x_{n-1}\right)+\ldots+ \\
&+\frac{\nabla^{n} y_{n}}{n ! h^{n}}\left(x-x_{n}\right)\left(x-x_{n-1}\right) \ldots\left(x-x_{1}\right)
\end{aligned}$

Формули Ньютона (4), (5) - це кінцево-різницевий аналого формули Тейлора.

### Приклад

Знайти P3(x) за формулою (5), якщо х0=0, х1=2, х2=4, х3=6, у0=1, у1=4, у2=2, у3=7

Розрахунки зведемо в таблицю

| xk  | yk  | $\nabla$yk | $\nabla _2y_k$ | $\nabla _3y_k$ |
| --- | --- | ---------- | -------------- | -------------- |
| 0   | 1   | -          | -              | -              |
| 2   | 4   | 3          | -              | -              |
| 4   | 2   | -2         | -5             | -              |
| 6   | 7   | 5          | 7              | 12             |

(таблиця заповнюється знизу)

Використовуємо останній рядок

$\begin{aligned}
& P_{3}(x)=7+\frac{5}{1 ! 2}(x-6)+\frac{7}{2 ! 2}=(x-6)(x-4)+\\
+& \frac{12}{3 ! 2^{3}}(x-6)(x-4)(x-2)=7+\frac{5}{2}(x-6)+\frac{7}{8}(x-6)(x-4)+\\
+& \frac{1}{4}(x-6)(x-4)(x-2)
\end{aligned}$

# 22.02.22 Лекція 2.6. Інтерполяція кубічним сплайном

Сплайн (spline) -це гнучка лінійка, яка використовується для креслення кривих ліній.

![](https://i.imgur.com/x4zm1FO.png)

<u>Дано</u>

yi=y(xi), xi (i=0,1,2,...,n)

<u>Треба</u>

Наблизити y(x) на інтервалі $\left[x_{i-1}, x_{i}\right],(i=1,2,...,n)$ кубічним поліномом

**<u>(1)</u>**
$$
\begin{aligned} u_{i}(x) &=a_{i}+b_{i}\left(x-x_{i-1}\right)+c_{i}\left(x-x_{i-1}\right)^{2}+\\ &+d_{i}\left(x-x_{i-1}\right)^{3}, \quad i=\overline{1, n} \end{aligned}
$$
Так щоб 
$$
u_{i}(x)=y_{i}, \quad i=\overline{1, n}
$$
 і виконати умови неперервності перших і других похідних $u_{i}(x)$ на границях часткових інтервалів$\left[x_{i-1}, x_{i}\right], \quad i=\overline{1, n}$

Знайдемо невідомі $a_i, b_i, c_i, d_i$:

Для лівого кінця інтервалу $\left[x_{i-1}, x_{i}\right]$ (за номером це і-й інтервал) з **<u>(1)</u>** маємо:

**<u>(2)</u>**

$y_{i-1}=a_{i} \quad, \quad i=\overline{1, n}$

Для правого кінця

**<u>(3)</u>**

$y_{i}=a_{i}+b_{i} h_{i}+c_{i} h_{i}^{2}+d_{i} h_{i}^{3}, i=\overline{1, n}$

де $h_i$ - відстань між вузлами $x_{i-1}$ i $x_i$ , $\quad i=\overline{1, n}$, тобто $h_i=x_i, \quad i=\overline{1, n}$ .

Рівності **<u>(2)</u>** і **<u>(3)</u>** записані з умови співпадання значень функції $y(x_i)$ i $y(x_{i-1})$ із значеннями сплайну в вузлах $x_i$ і $x_{i-1}$.

Таким чином, маємо $2n$ рівнянь **<u>(2) і (3)</u>** для відшукування $4n$ невідомих  $a_i, b_i, c_i, d_i$ .

Необхідно отримати ще $2n$ умов.

Для цього будемо вимагати рівність перших і других похідних поліномів **<u>(1)</u>** у внутрішніх вузлах (їх кількість $n-1$). Це забезпечить гладкість сукупного сплайну.

Отже маємо:

$u_{i+1}^{\prime}\left(x_{i}\right)=u_{i}^{\prime}\left(x_{i}\right)$,                                               **<u>(4)</u>**
$u_{i+1}^{\prime \prime}\left(x_{i}\right)=u_{i}^{\prime \prime}\left(x_{i}\right), \quad i=1,2, \ldots, n-1$     **<u>(5)</u>**

Залежності **<u>(4)</u>** і **<u>(5)</u>** дадуть ще $2(n-1)$ додаткові умови для визначення $a_i, b_i, c_i, d_i$.

Отримаємо ці умови. Продиференціюємо **<u>(1)</u>**:

$u_{i}^{\prime}(x)=b_{i}+2 c_{i}\left(x-x_{i-1}\right)+3 d_{i}\left(x-x_{i-1}\right)^{2}, i=\overline{1, n-1}$,    **<u>(6)</u>**

$u_{i}^{\prime \prime}(x)=2 c_{i}+6 d_{i}\left(x-x_{i-1}\right), \quad i=1, n-1$                                 **<u>(7)</u>**

Вимагаємо неперервності і гладкості у всіх точках, включаючи вузли. Прирівнюючи ліву і праву похідні для внутрішнього вузла $x_i$, маємо:

$b_{i}+2 c_{i} h_{i}+3 d_{i} h_{i}^{2}=b_{i+1}, \quad i=\overline{1, n-1}$                                        **<u>(8)</u>**

$c_{i}+3 d_{i} h_{i}=c_{i+1}, \quad i=\overline{1, n-1}$                                                         **<u>(9)</u>**

Необхідні ще 2 умови. Їх отримаємо, якщо припустимо, що на кінцях всього інтервалу $[x_0,x_n]$ другі похідні дорівнюють нулю:

$e_{n}^{\prime \prime}\left(x_{n}\right)=0, \quad e_{1}^{\prime \prime}\left(x_{0}\right)=0$                                                                     **<u>(10)</u>**

Це відповідає умові незакріплених кінців сплайну (нульова кривизна лінії).

З **<u>(10)</u>** маємо:

$\frac{1}{2} u_{1}^{\prime \prime}\left(x_{0}\right)=c_{1}=0$                                                                                      **<u>(11)</u>**

$\frac{1}{2} u_{n}^{\prime \prime}\left(x_{n}\right)=c_{n}+3 d_{n} h_{n}=0$                                                                   **<u>(12)</u>**

Таким чином, отримали систему лінійних рівнянь **<u>(2),(3),(8),(9),(11),(12)</u>** для визначення $4n$ невідомих коефіцієнтів $a_i,b_i,c_i,d_i$.

Цю систему можна розв'язати методом Гаусса. Але набагато простіше розв'язати її методом прогонки.

Для цього попередньо приведемо цю систему до потрібного вигляду.

З рівняння **<u>(2)</u>** маємо:

$a_i=y_{i-1}, \quad i=\overline{1,n}$

З рівнянь **<u>(9)</u>** і **<u>(12)</u>** визначимо:

$d_{i}=\left(c_{i+1}-c_i\right) / 3 h_{i}, i=\overline{1, n-1}$                                                      **<u>(13)</u>**

$d_{n}=-c_{n} / 3 h_{n}$                                                                                            **<u>(14)</u>**

Якщо покласти $c_{n+1}=0$, то систему (13),(14) можна записати одним рівнянням:

$d_{i}=\left(c_{i+1}-c_{i}\right) / 3 h_{i},     i=\overline{1,n} $                                                            **<u>(15)</u>**

де $c_{n+1}=0$

Підставимо (15) в (3), одночасно виключаючи $a_i=y_{i-1}$, отримаємо:

$b_{i}=\frac{1}{h_{i}}\left(y_{i}-y_{i-1}\right)-\frac{1}{3}\left(2 с_{i}+с_{i+1}\right) h_{i}, \quad i=\overline{1, n}$                            **<u>(16)</u>**

Виключимо тепер з (8) величини $b_i$ та $b_{i+1}$ за допомогою (16), збільшуючи у другому випадку індекс на одиницю, а величину $d_i$ на основі (15).

В результаті маємо систему лінійних рівнянь відносно $c_i$:

**<u>(17)</u>**

$\left\{\begin{array}{c}c_{1}=0 \\ h_{i-1} c_{i-1}+2\left(h_{i-1}+h_{i}\right) c_{i}+h_{i} c_{i+1}=3\left(\frac{y_{1}-y_{i-1}}{h_{i}}-\frac{y_{i-1}-y_{i-2}}{h_{i-1}}\right),  \quad i=\overline{2,n}\\ c_{n+1}=0\end{array}\right.$

Матриця системи (17) - трьохдіагональна. такі системи розв'язуються спеціальним методом - методом прогонки.
Після того, як знайдені коефіцієнти $c_{i}$ , решту коефіцієнтів нескладно знайти з формул (15) і (16)

## Метод прогонки розв'язання систем лінійних рівнянь з трьохдіагональною матрицею

Представимо друге рівняння системи (17) у вигляді:

<u>**(18)**</u>
$$
u_{i} c_{i+1}-v_{i} c_{1}+w_{i} c_{i-1}=F_{i}, \quad i=\overline{2, n}
$$
де позначено:
$$
u_{i}=h_{i}, \quad v_{i}=-2\left(h_{i-1}+h_{i}\right), \quad w_{i}=h_{i-1},\\
F_{i}=3\left(\frac{y_{i}-y_{i-1}}{h_{i}}-\frac{y_{i-1}-y_{i-2}}{h_{i-1}}\right)
$$
Коефіцієнти $u_i,v_i,w_i$ і праві частини $F_i$ можна вважати відомими, оскільки їх можна обчислити заздалегідь.

Покладемо в (18) $i=2$ і виразимо з рівняння
$$
u_2c_3-v_2c_2+w_2c_1=F_2
$$ {\equation*}
Невідомий коефіцієнт $c_2$ через $c_3$ і $c_1=0$:

**<u>(19)</u>**
$$
c_{2}=\frac{u_{2}}{v_{2}} c_{3}+\frac{w_{2} C_{1}-F_{2}}{v_{2}}
$$
Перепишемо (19) у вигляді

**<u>(20)</u>**
$$
\begin{gathered}
c_{2}=A_{2} c_{3}+B_{2}, \text { де } \\
A_{2}=\frac{u_{2}}{v_{2}} ; \quad B_{2}=\frac{w_{2} c_{1}-F_{2}}{v_{2}}
\end{gathered}
$$
Далі для $i=3$ з відповідного рівняння (18) маємо
$$
u_3c_4-v_3c_3+w_3c_2=F_3
$$
Підставляючи сюди $c_2=A_2c_3+B_2$, отримаємо
$$
u_3c_4-v_3c_3+w_3(A_2c_3+B_2)=F_3\\
u_3c_4-(v_3-w_3A_2)c_3+w_3B_2=F_3
$$
виразимо $c_3$ через $c_4$:

**<u>(21)</u>**
$$
c_{3}=\frac{u_{3}}{v_{3}-w_{3} A_{2}} c_{4}+\frac{w_{3} B_{2}-F_{3}}{v_{3}-w_{3} A_{2}}
$$
Представимо (21) у вигляді

**<u>22</u>**, **<u>23</u>**
$$
c_3=A_3c_4+B_3,\ \ \ \text{де}
\\A_3=\frac{u_3}{v_3-w_3A_2};\ \ B_3=\frac{w_3B_2-F_3}{v_3-W_3A_2}
$$
Для $i=4,5,...,n$ аналогічно отримуємо:
$$
\begin{aligned}
&\left\{\begin{array}{l}
C_{4}=A_{4} C_{5}+B_{4}, \\
C_{5}=A_{5} C_{6}+B_{5}, \\...............\\
C_{n}=A_{n} C_{n+1}+B_{n},
\end{array}\right.\\
&\text { дe } \quad A_{4}=\frac{u_{4}}{v_{4}-w_{4} A_{3}} ; \quad B_{4}=\frac{w_{4} B_{3}-F_{4}}{v_{4}-w_{4} A_{3}} ;\\
&A_{5}=\frac{u_{5}}{v_{5}-w_{5} A_{4} ; B_{5}}=\frac{w_{5} B_{4}-F_{5}}{v_{5}-W_{5} A_{4}},\\....\\
&A_{n}=\frac{u_{n}}{V_{n}-W_{n} A_{n-1}} ; B_{n}=\frac{W_{n} B_{n-1}-F_{n}}{V_{n}-W_{n} A_{n-1}} .
\end{aligned}
$$
Таким чином, для визначення $c_i$ маємо дві системи рівнянь: Перша - відносно невідомих $A_i,\ B_i,\ (i=\overline{2,n})$:

**<u>24</u>**
$$
\left\{\begin{array}{l}
A_{2}=\frac{u_{2}}{v_{2}} ; B_{2}=\frac{-F_{2}}{v_{2}} \\
A_{k}=\frac{u_{k}}{v_{k}-W_{k} A_{k-1}} ; B_{k}=\frac{W_{k} B_{k-1}-F_{k}}{v_{k}-W_{k} A_{k-1}}, \ \ \
k=\overline{3, n}
\end{array}\right.
$$
Друга - відносно невідомих $c_i \ \ (i=\overline{2,n})$:

**<u>25</u>**
$$
\left\{\begin{array}{l}
C_{1}=0, \\
C_{2}=A_{2} C_{3}+B_{2}, \\
C_{3}=A_{3} C_{4}+B_{3}, \\........\\
C_{n}=A_{n} C_{n+1}+B_{n}, \\
C_{n+1}=0
\end{array}\right.
$$
Системи (24)(25) - це системи рекурентних лінійних рівнянь, які розв'язуються послідовно:

- перша ''зверху вниз''
- друга ''знизу вверх''

В результаті такої ''прогонки'' знаходяться конфіцієнти $c_i$ сплайна (1)

## Алгоритм інтерполювання кубічним сплайном

1) Обчислити коефіцієнти і праві частини системи рівнянь (18):
   $u_{i} c_{i+1}-v_{i} c_{1}+w_{i} c_{i-1}=F_{i}, \quad i=\overline{2, n}$ 
   $u_{i}=h_{i}, v_{i}=-2\left(h_{i-1}+h_{i}\right), \quad w_{i}=h_{i-1},\\
   F_{i}=3\left(\frac{y_{i}-y_{i-1}}{h_{i}}-\frac{y_{i-1}-y_{i-2}}{h_{i-1}}\right)$ 
2) Розв'язати систему (18) методом прогонки. Для цього спочатку визначити  $A_i,B_i\ \ (i=\overline{2,n})$ з системи (24), послідовно позв'язуючи перше, друге,..., останнє рівняння.
   Далі знайти коефіцієнти $c_i\ \ (i=\overline{2,n})$ з системи (25), розглядаючи рівнння в зворотній послідовності.
3) Визначити коефіцієнти
   $\begin{gathered}
   a_{i}=y_{i}-1, \quad i=\overline{1, n} \\
   b_{i}=\frac{1}{h_{i}}\left(y_{i}-y_{i-1}\right)-\frac{1}{3}\left(2 c_{i}+c_{i+1}\right) h_{i}, \quad i=\overline{1, n} \\
   d_{i}=\left(c_{i+1}-c_{i}\right) / 3 h_{i} ; \quad i=\overline{1, n},
   \end{gathered}$ 

## Приклад

Есть такая таблица данных

| $x_i$ | 0,0  | 1,5  | 4,0  | 5,2  | 7,0  | 9,3  |
| ----- | ---- |:---- | ---- | ---- | ---- | ---- |
| $y_i$ | 1,00 | 2,52 | 4,16 | 3,20 | 5,10 | 6,20 |

Надо получить такую формулу для каждого отрезка, т.е. на $x=[0;1,5]$, на $x=[1,5;4]$ и т.д.
$$
\varphi_{i}(x)=a_{i}+b_{i}\left(x-x_{i-1}\right)+c_{i}\left(x-x_{i-1}\right)^{2}+d_{i}\left(x-x_{i-1}\right)^{3},\quad i=1,2, \ldots, 5
$$
Не сложно догадаться, что $i$ это колво отрезков между заданными иксами, т.е. опять таки $i_1\ \ \text{это у нас для} \ \ x=[0;\ 1,5]$, i2 от 1.5 до 4 и т.д.

Задача сводится к тому, что надо найти эти коефициенты $a,b,c,d $ на разных і:

по алгоритму определяем коефициенты и правые части системы
$$
\begin{aligned}
&u_{2}=h_{2}=4,0-1,5=2,5 ; u_{3}=h_{3}=5,2-4,0=1,2 ; u_{4}=h_{4}=7,0-5,2=1,8 \\
&u_{5}=h_{5}=9,3-7,0=2,3 ; \\
&w_{2}=h_{1}=1,5-0,0 ; w_{3}=h_{2}=2,5 ; w_{4}=h_{3}=1,2 ; w_{5}=h_{4}=1,8 ; \\
&v_{2}=-2(1,5+2,5)=-8 ; v_{3}=-2(2,5+1,2)=-7,4 ; v_{4}=-2(1,2+1,8)=-6 ; \\
&v_{5}=-2(1,8+2,3)=-8,2 ; \\
&F_{2}=3\left(\frac{y_{2}-y_{1}}{h_{2}}-\frac{y_{1}-y_{0}}{h_{1}}\right)=3\left(\frac{4,16-2,52}{2,5}-\frac{2,52-1,0}{1,5}\right)=-1,072 ; \\
&F_{3}=3\left(\frac{y_{3}-y_{2}}{h_{3}}-\frac{y_{2}-y_{1}}{h_{2}}\right)=3\left(\frac{3,20-4,16}{1,2}-\frac{4,16-2,52}{2,5}\right)=-4,368 ; \\
&F_{4}=3\left(\frac{y_{4}-y_{3}}{h_{3}}-\frac{y_{3}-y_{2}}{h_{2}}\right)=3\left(\frac{5,10-3,20}{1,8}-\frac{3,20-4,16}{1,2}\right)=5,567 ; \\
&F_{5}=3\left(\frac{y_{5}-y_{4}}{h_{4}}-\frac{y_{4}-y_{3}}{h_{3}}\right)=3\left(\frac{6,20-5,10}{2,3}-\frac{5,10-3,20}{1,8}\right)=-1,732 ;
\end{aligned}
$$
Система будет иметь такой вид:
$$
\left\{\begin{array}{l}
1,5 c_{1}+8 c_{2}+2,5 c_{3}=-1,072 \\
2,5 c_{2}+7,4 c_{3}+1,2 c_{4}=-4,368 \\
1,2 c_{3}+6 c_{4}+1,8 c_{5}=5,567 \\
1,8 c_{4}+8,2 c_{5}+2,3 c_{6}=-1,732
\end{array}\right.
$$
Полученная матрица трёхдиагональная, чтобы решить используем метод прогонки
$$
\begin{aligned}
&A_{2}=\frac{u_{2}}{v_{2}}=\frac{25}{-8}=-0,1813 ; B_{2}=\frac{w_{2} c_{1}-F_{2}}{2 v_{2}}=\frac{0+1,072}{-8}=-0,1340 ; \\
&A_{3}=\frac{u_{3}}{v_{3}-w_{3} A_{2}}=\frac{1,2}{-7,4-2,5(-0,3125)}=-0,1813 ; \\
&B_{3}=\frac{w_{3} B_{2}-F_{3}}{v_{3}-w_{3} A_{2}}=\frac{2,5 \cdot(-0,1340)+4,368}{-7,4-2,5(-0,3125)}=-0,6093 ; \\
&A_{4}=\frac{u_{4}}{v_{4}-w_{4} A_{3}}=\frac{1,8}{-6-1,2((-0,1813)}=-0,3113 ; \\
&B_{4}=\frac{w_{4} B_{3}-F_{4}}{v_{4}-w_{4} A_{3}}=\frac{1,2(-0,6093)-5,567}{-7,4-2,5(-0,3125)}=1,0891 ; \\
&A_{5}=\frac{u_{5}}{v_{5}-w_{5} A_{4}}=\frac{2,3}{-8,2-1,8(-0,3113)}=-0,3011 ; \\
&B_{5}=\frac{w_{5} B_{4}-F_{5}}{v_{5}-w_{5} A_{4}}=\frac{1,8 \cdot 1,0891+1,7319}{-8,2-1,8(-0,3113)}=-0,4833 .
\end{aligned}
$$
Теперь можно получить коефициенты сплайна $c_{i}:$
$$
\begin{aligned}
&c_{5}=A_{5} c_{6}+B_{5}=(-0,3011) \cdot 0-0,4833=-0,4833 ; \\
&c_{4}=A_{4} c_{5}+B_{4}=-0,3113 \cdot(-0,4833)+1,0891=1,2396 ; \\
&c_{3}=A_{3} c_{4}+B_{3}=-0,1813 \cdot 1,2396-0,6093=-0,8340 ; \\
&c_{2}=A_{2} c_{3}+B_{2}=-0,3125 \cdot(-0,8340)-0,1340=0,1267 .
\end{aligned}
$$
Знайдемо коефіцієнти $a_{i}$ :
$$
a_{1}=y_{0}=1,0 ; \quad a_{2}=y_{1}=2,52 ; \quad a_{3}=y_{2}=4,16 ; \quad a_{4}=y_{3}=3,20 ; \quad a_{5}=y_{4}=5,10 .
$$
Отлично, теперь ищем коефы для $b$
$$
\begin{aligned}
&b_{1}=\frac{1}{h_{1}}\left(y_{1}-y_{0}\right)-\frac{1}{3}\left(2 c_{1}+c_{2}\right) h_{1}=\frac{1}{1,5}(2,52-1,0)-\frac{1}{3}(2 \cdot 0+0,1266) 1,5=0,950 ; \\
&b_{2}=\frac{1}{h_{2}}\left(y_{2}-y_{1}\right)-\frac{1}{3}\left(2 c_{2}+c_{3}\right) h_{2}=\frac{1}{2,5}(4,16-2,52)-\frac{1}{3}(2 \cdot 0,1266-0,8340) 2,5=1,140 ; \\
&b_{3}=\frac{1}{h_{3}}\left(y_{3}-y_{2}\right)-\frac{1}{3}\left(2 c_{3}+c_{4}\right) h_{3}=\frac{1}{1,2}(3,20-4,16)-\frac{1}{3}(2 \cdot(-0,8340)+1,2396) 1,2= \\
&=-0,6286 ; \\
&b_{4}=\frac{1}{h_{4}}\left(y_{4}-y_{3}\right)-\frac{1}{3}\left(2 c_{4}+c_{5}\right) h_{4}=\frac{1}{1,8}(5,10-3,20)-\frac{1}{3}(2 \cdot 1,2396-0,4833) 1,8=0,950 ; \\
&b_{5}=\frac{1}{h_{5}}\left(y_{5}-y_{4}\right)-\frac{1}{3}\left(2 c_{5}+c_{6}\right) h_{5}=\frac{1}{2,3}(6,20-5,10)-\frac{1}{3}(2 \cdot(-0,4833)+0) 2,3=1,219 ; \\
& \text {с формулок получаем дальше} \\
&d_{1}=\left(c_{2}-c_{1}\right) / 3 h_{1}=\frac{0,1266-0}{3 \cdot 1,5}=0,028 ; \quad d_{2}=\left(c_{3}-c_{2}\right) / 3 h_{2}=\frac{-0,8340-0,1267}{3 \cdot 2,5}=-0,1281 ; \\
&d_{3}=\left(c_{4}-c_{3}\right) / 3 h_{3}=\frac{1,2396+0,8340}{3 \cdot 1,2}=0,576 ; \\
&d_{4}=\left(c_{5}-c_{4}\right) / 3 h_{4}=\frac{-0,4833-1,2396}{3 \cdot 1,8}=-0,3191 ; \\
&d_{5}=\left(c_{6}-c_{5}\right) / 3 h_{5}=\frac{0-(-0,4833)}{3 \cdot 23}=0,070 .
\end{aligned}
$$
Интерполяция окончена, олды получены
$$
\begin{aligned}
&\varphi_{1}(x)=1,0+0,950 x+0,028 x^{3} \text { для } x \in[0 ; 1,5] \\
&\varphi_{2}(x)=2,52+1,14(x-1,5)+0,127(x-1,5)^{2}-0,128(x-1,5)^{3} \text { для } x \in[1,5 ; 4] \\
&\varphi_{3}(x)=4,16-0,629(x-4)-0,834(x-4)^{2}+0,576(x-4)^{3} \text { для } x \in[4 ; 5,2] \\
&\varphi_{4}(x)=3,20-0,142(x-5,2)+1,240(x-5,2)^{2}-0,319(x-5,2)^{3} \text { для } x \in[5,2 ; 7] \\
&\varphi_{5}(x)=5,10+1,219(x-7)-0,483(x-7)^{2}+0,070(x-7)^{3} \text { для } x \in[7 ; 9,3]
\end{aligned}
$$

## Тот же пример, но как я понял

![](https://i.imgur.com/c4G11ns.png)



| №       | 0   | 1   | 2   | 3   |
| ------- | --- |:--- | --- | --- |
| $x_i$   | 1   | 2   | 4   | 7   |
| $y_{i}$ | 2   | 3   | 1   | 4   |

### Коефы ищутся исходя из правил

Вернёмся к формуле
$$
\varphi_{i}(x)=a_{i}+b_{i}\left(x-x_{i-1}\right)+c_{i}\left(x-x_{i-1}\right)^{2}+d_{i}\left(x-x_{i-1}\right)^{3},\quad i=1,2, \ldots, 5
$$
это формулка для каждого отдельного участка сплайна.

$x_{i-1}$ это начальный х в отрезке сплайна

теперь попробуем составить это уравнение для первого участка, он же $x=[0;1]$ S0,S1,S2 это названия функций для соответствующих отрезков
$$
S_0=a_0+b_0(x-x_0)+c_0(x-x_0)^2+d_0(x-x_0)^3\\
S_1=a_1+b_1(x-x_1)+c_1(x-x_1)^2+d_1(x-x_1)^3\\
S_2=a_2+b_2(x-x_2)+c_2(x-x_2)^2+d_2(x-x_2)^3
$$
начинается этот участок на х=1, знач заменим в формулке $x_0$ на 1:
$$
S_0=a_0+b_0(x-1)+c_0(x-1)^2+d_0(x-1)^3\\
S_1=a_1+b_1(x-2)+c_1(x-2)^2+d_1(x-2)^3\\
S_2=a_2+b_2(x-4)+c_2(x-4)^2+d_2(x-4)^3
$$

### 1. Сплайн должен проходить через узловые точки

Это значит, что при х=1 у=2, а при х=2 у=3. Из этого ищем коеф $a_0$

![](https://i.imgur.com/9PtdIuf.png)

Подставим значения первой и второй точек в формулку, получим:
$$
S_0:\\
2=a_0+b_0(1-1)+c_0(1-1)^2+d_0(1-1)^3\\
3=a_0+b_0(2-1)+c_0(2-1)^2+d_0(2-1)^3\\
S_1:\\
3=a_1+b_1(2-2)+c_1(2-2)^2+d_1(2-2)^3\\
1=a_1+b_1(4-2)+c_1(4-2)^2+d_1(4-2)^3\\
S_2:\\
1=a_2+b_2(4-4)+c_2(4-4)^2+d_2(4-4)^3\\
4=a_2+b_2(7-4)+c_2(7-4)^2+d_2(7-4)^3\\
$$
Это можно упростить
$$
S_0:\\
2=a_0\\
3=a_0+b_0+c_0+d_0\\
S_1:\\
3=a_1\\
1=a_1+2b_1+4c_1+8d_1\\
S_2:\\
1=a_2\\
4=a_2+3b_2+9c_2+27d_2
$$

### 2. В стыках сплайнов всё должно быть гладенько

На пересечении отрезков должен быть плавный переход, для этого можно использовать производные, так как они показывают динамику роста функции

Сплайн должен заходить с одинаковой кривизной и углом. Первая производная отвечает за угол. Кривизна же идёт по второй производной, а вот собственно и они:
$$
\begin{aligned}
&S_{0}^{\prime}=\left(a_{0}+b_{0}(x-1)+c_{0}(x-1)^{2}+d_{0}(x-1)^{3}\right)^{\prime}=b_{0}+2 c_{0}(x-1)+3 d_{0}(x-1)^{2} \\
&S_{1}^{\prime}=\left(a_{1}+b_{1}(x-2)+c_{1}(x-2)^{2}+d_{1}(x-2)^{3}\right)^{\prime}=b_{1}+2 c_{1}(x-2)+3 d_{1}(x-2)^{2} \\
&S_{2}^{\prime}=\left(a_{2}+b_{2}(x-4)+c_{2}(x-4)^{2}+d_{2}(x-4)^{3}\right)^{\prime}=b_{2}+2 c_{2}(x-4)+3 d_{2}(x-4)^{2} \\\\
&\left( S_{0}^{\prime \prime}=\left(b_{0}+2 c_{0}(x-1)+3 d_{0}(x-1)^{2}\right)^{\prime}=2 c_{0}+6 d_{0}(x-1)\right. \\
&S_{1}^{\prime \prime}=\left(b_{1}+2 c_{1}(x-2)+3 d_{1}(x-2)^{2}\right)^{\prime}=2 c_{1}+6 d_{1}(x-2) \\
&S_{2}^{\prime \prime}=\left(b_{2}+2 c_{2}(x-4)+3 d_{2}(x-4)^{2}\right)^{\prime}=2 c_{2}+6 d_{2}(x-4)
\end{aligned}
$$
![](https://i.imgur.com/oWG7DZ3.png)

В первой точке стыка, она же (2,3)  производные сплайнов должны быть одинаковыми, т.е.:
$$
b_0+2c_0(2-1)+3d_0(2-1)^2=b_1+2c_1(2-2)+3d_1(2-2)^2\\
2c_0+6d_0(2-1)=2c_1+6d_1(2-2)
$$
оно же
$$
b_0+2c_0+3d_0-b_1=0\\
2c_0+6d_0-2c_1=0
$$

аналогично будет в точке (4,1):
$$
b_1+2c_1(4-2)+3d_1(4-2)^2=b_2+2c_2(4-4)+3d_2(4-4)^2\\
2c_1+6d_1(4-2)=2c_2+6d_2(4-4)
$$
оно же
$$
b_1+4c_1+12d_1-b_2=0\\
2c_1+12d_1-2c_2=0
$$
остнаётся ещё 2 уравнения

### Надо задать поведение сплайнов в начальной и конечной точках

Зададим нулевую кривизну для начала и конца, т.е. 

$S^{\prime\prime} _0=0$
$2c_0+6d_0(1-1)=0$
$2c_0=0$

$S^{\prime\prime} _2=0$
$2c_2+6d_2(7-4)=0$
$2c_2+18d_2=0$

### Из всего сверху получаем систему из 12 линейных уравнений

$$
\begin{aligned}
&a_{0}=2 \\
&a_{0}+b_{0}+c_{0}+d_{0}=3 \\
&a_{1}=3 \\
&a_{1}+2 b_{1}+4 c_{1}+8 d_{1}=1 \\
&a_{2}=1 \\
&a_{2}+3 b_{2}+9 c_{2}+27 d_{2}=4 \\
&b_{0}+2 c_{0}+3 d_{0}-b_{1}=0 \\
&2 c_{0}+6 d_{0}-2 c_{1}=0 \\
&b_{1}+4 c_{1}+12 d_{1}-b_{2}=0 \\
&2 c_{1}+12 d_{1}-2 c_{2}=0 \\
&2 c_{0}=0 \\
&2 c_{2}+18 d_{2}=0
\end{aligned}
$$

учитывая, что мы знаем некоторые коэфы - заменяем известные:
$$
\begin{aligned}
&a_{0}=2 \\
&a_{1}=3 \\
&a_{2}=1 \\
&c_{0}=0 \\
&b_{0}+d_{0}=1 \\
&2 b_{1}+4 c_{1}+8 d_{1}=-2 \\
&3 b_{2}+9 c_{2}+27 d_{2}=3 \\
&b_{0}+3 d_{0}-b_{1}=0 \\
&6 d_{0}-2 c_{1}=0 \\
&b_{1}+4 c_{1}+12 d_{1}-b_{2}=0 \\
&2 c_{1}+12 d_{1}-2 c_{2}=0 \\
&2 c_{2}+18 d_{2}=0
\end{aligned}
$$
Таким образом получаем матрицу СЛАУ значений коефов А и матрицу столбец значений В     

# 30.03.22 Лекція 3. Середньоквадратичне наближення функцій

Раніше було розглянуто наближення функцій методами інтерполювання. Вони забезпечують хорошу точність на невеликих відрізках. Середньоквадратична апроксимізація дозволяє будувати наближені формули у випадку великих відрізків з великою кількістю вузлів

## Задача середньоквадратичного наближення

Для заданої функції $f(x)$ треба знайти поліном
$$
Q_m(X)=c_0\mu_0(x)+c_1\mu_1(x)+...+c_m\mu_m(x)
\label{3.1}\tag{1}
$$

де $\mu _0(X),\mu _1(x),..,\mu_m(x)$ - задана система функцій, таких щоб середньоквадратичне відхилення від заданої функції $f(х)$ було мінімальним.
Середньоквадратичним відхиленням називається усереднення на заданій множині точок квадрата різниці заданої функції $f(x)$ і полінома $Q_m(X)$.
	У випадку, коли функція $f(x)$ задана своїми значеннями у вузлах $x_0,x_1,..,x_n$ за міру близості можна взяти величину $\Epsilon$, яка виражається формулою:
$$
\label{3.2}\tag{2}
\Epsilon=\sqrt{\sum\limits_{i=0}^n(f(x_i)-Q_m(x_i))^2}
$$
​	Якщо множина Х, на якій розглядається задача середньоквадратичного наближення, задана у вигляді інтервалу $X=(x|a\leq x\leq b)$,
$$
\Epsilon = \sqrt{\int\limits_a^b(f(x)-Q_m(x))^2dx}
\tag{3}\label{3.3}
$$


Принципова відмінність задачі середньоквадратичного наближення від задачі інтерполяції полягає в тому, що кількість невідомих коефіцієнтів $c_0,c_1,..,c_m$ суттєво менше, ніж кількість вузлів апроксимації, тобто $m<<n$.

![image-20220330193638128](https://s2.loli.net/2022/03/31/OVx2lUv9zmAZuCB.png)

Якщо розглядається міра відхилення $\ref{3.2}$, маємо задачу точкової середньоквадратичної апроксимації, якщо має місце міра відхилення $\ref{3.3}$ - це неперервна апроксимація.

## Точкове середньоквадратичне наближення функцій

В даному випадку задача розглядається для функції $f(x)$, яка задана своїми значеннями $y_0,y_1,...,y_n$ в вузлах $x_0,x_1,..,x_n$, а міра відхилення - формулою $\ref{3.2}$.

Оскільки $\Epsilon$ є функцією невідомих коефіцієнтів $c_0,c_1,..,c_m$, умова мінімізації оцінки $\ref{3.2}$ має вигляд
$$
\tag{4}\label{3.4}
\frac{\partial E}{\partial c_{i}}=0 \quad, i=0,1, \ldots, m
$$
Розглянемо випадок алгебраїчного поліному

$Q_{m}(x)=c_{0}+c_{1} x+c_{2} x^{2}+\ldots+c_{m} x^{m}$. тоді
$$
\Epsilon=\sqrt{\sum_{i=0}^{n}\left(c_{0}+c_{1} x_{i}+c_{2} x_{i}^{2}+\ldots+c_{m} x_{i}^{m}-y_{i}\right)^{2} .}
$$
Візьмемо похідні $\ref{3.4}$, отримаємо в результаті систему $(m+1)$ алгебраїчних рівнянь відносно невідомих $c_0,c_1,..,c_m$ 
$$
\left\{\begin{array}{l}
\sum_{i=0}^{n}\left[\left(c_{0}+c_{1} x_{i}+c_{2} x_{i}^{2}+\ldots+c_{m} x_{1}^{m}-y_{i}\right) \cdot 1\right]=0 \\
\sum_{i=0}^{n}\left[\left(c_{0}+c_{1} x_{i}+c_{2} x_{i}^{2}+\ldots+c_{m} x_{1}^{m}-y_{i}\right) \cdot x_{i}\right]=0 \\.......\\
\sum_{i=0}^{n}\left[\left(c_{0}+c_{1} x_{i}+c_{2} x_{1}^{2}+\ldots+c_{m} x_{i}^{m}-y_{i}\right) \cdot x_{i}^{m}\right]=0
\end{array}\right.\label{3.5}\tag{5}
$$
система $\ref{3.5}$ може бути переписана у вигляді
$$
\left\{\begin{array}{l}
c_{0} \sum_{i=0}^{n} 1+c_{1} \sum_{i=0}^{n} x_{i}+c_{2} \sum_{i=0}^{n} x_{i}^{2}+\ldots+c_{m} \sum_{i=0}^{n} x_{i}^{m}=\sum_{i=0}^{n} y_{i} \\
c_{0} \sum_{i=0}^{n} x_{i}+c_{1} \sum_{i=0}^{n} x_{i}^{2}+c_{2} \sum_{i=0}^{n} x_{i}^{3}+\ldots+c_{m} \sum_{i=0}^{n} x_{i}^{m+1}=\sum_{i=0}^{n} y_{i} x_{i} \\...........\\
c_{0} \sum_{i=0}^{n} x_{i}^{m}+c_{1} \sum_{i=0}^{n} x_{i}^{m+1}+c_{2} \sum_{i=0}^{n} x_{i}^{m+2}+\ldots+c_{m} \sum_{i=0}^{n} x_{i}^{2 m}=\sum_{i=0}^{n} y_{i} x_{i}^{m}
\end{array}\right.\label{3.6}\tag{6}
$$
Матриця системи $\ref{3.6}$ симетрична відносно головної діагоналі
$$
\left(\begin{array}{ccccc}
\sum_{i=0}^{n} 1 & \sum_{i=0}^{n} x_{i} & \sum_{i=0}^{n} x_{i}^{2} & \cdots & \sum_{i=0}^{n} x_{i}^{m} \\
\sum_{i=0}^{n} x_{i} & \sum_{i=0}^{n} x_{i}^{2} & \sum_{i=0}^{n} x_{i}^{3} & \cdots & \sum_{i=0}^{n} x_{i}^{m+1} \\
- & - & - & - & - \\
\sum_{i=0}^{n} x_{i}^{m} & \sum_{i=0}^{n} x_{i}^{m+1} & \sum_{i=0}^{n} x_{i}^{m+2} & \cdots & \sum_{i=0}^{n} x_{i}^{2 m}
\end{array}\right)
$$
Симетричність матриці є відмінною властивістю застосування методу найменших квадратів, який полягається в основу середньоквадратичного наближення.
Можна довести, що якщо серед вузлів $x_0,x_1,..,x_n$ нема співпадаючих, то визначник системи $\ref{3.6}$ відмінний від нуля, тобто існує єдиний розв'язок системи.

Якщо m-n, то апроксимуючий поліном $Q_m(x)$ співпадає з поліномом Лагранжа для системи вузлів $x_0,x_1,..,x_m$, причому $\Epsilon=0$.

Таким чином, наближення у вигляді апроксимації є більш узагальненим процесом в порівнянні з інтерполяцією.

Система $\ref{3.6}$ називається **нормальною** системою

### Приклад точкової середньоквадратичної апроксимації

Нехай функція $y=f(x)$ задана своїми значеннями в в**узлах:**

| **$x_i$** | 0,78 | 1,56 | 2,34 | 3,12 | 3,81 |
| --------- | ---- | ---- | ---- | ---- | ---- |
| $y_i$     | 2,50 | 1,20 | 1,12 | 2,25 | 4,28 |

Наблизимо функцію поліномом $Q_2(x)$
$$
Q_{2}(x)=c_{0}+c_{1} x+c_{2} x^{2}
$$
Нормальна система рівнянь $\ref{3.6}$ для знаходження невідомих $c_0,c_1,c_2$ має вигляд: 
$$
\left\{\begin{array}{l}
c_{0} \sum_{i=0}^{4} 1+c_{1} \sum_{i=0}^{4} x_{i}+c_{2} \sum_{i=0}^{4} x_{i}^{2}=\sum_{i=0}^{4} y_{i} \\
c_{0} \sum_{i=0}^{4} x_{i}+c_{1} \sum_{i=0}^{4} x_{i}^{2}+c_{2} \sum_{i=0}^{4} x_{i}^{3}=\sum_{i=0}^{4} y_{i} x_{i} \\
c_{0} \sum_{i=0}^{4} x_{i}^{2}+c_{1} \sum_{i=0}^{4} x_{i}^{3}+c_{2} \sum_{i=0}^{4} x_{i}^{4}=\sum_{i=0}^{4} y_{i} x_{i}^{2}
\end{array}\right.
$$
Обчислення коефіцієнтів нормальної системи запишемо в табличному вигляді

![image-20220330202039486](https://s2.loli.net/2022/03/31/ZVfxYKMbaUXNgGc.png)

Таким чином маємо систему:
$$
\left\{\begin{array}{c}
5 c_{0}+11,61 c_{1}+32,768 c_{2}=11,350 \\
11,61 c_{0}+32,768 c_{1}+102,761 c_{2}=29,770 \\
32,768 c_{0}+102,761 c_{1}+341,750 c_{2}=94,604
\end{array}\right.
$$
Розв'язок цієї системи:
$c_0=5,045,\,c_1=-4,043,\,c_2=1,009$

Апроксимуючий поліном має вигляд
$$
Q_{z}(x)=5,045-4,043 x_{1}+1,009 x^{2}
$$
Знайдемо значення величини відхилення
![image-20220330202315842](https://s2.loli.net/2022/03/31/Zd5B861o29lJrsV.png)
$$
\varepsilon=\sqrt{2,29 \cdot 10^{-4}}=0,015
$$
Для алгебраїчного полінома основна система функцій
$$
\varphi_{0}(x)=1, \quad \varphi_{1}(x)=x, \quad \varphi_{2}(x)=x^{2}, \ldots, \quad \operatorname{lnm}_{\operatorname{mi}}(x)=x^{3},
$$
Якщо ввести позначення
$$
\begin{aligned}
&\left(\varphi_{0}, \varphi_{0}\right)=\sum_{i=0}^{n} \varepsilon_{0}\left(\varepsilon_{i}\right) \varphi_{0}\left(x_{i}\right)=\sum_{i=0}^{n} 1 \\
&\left(\varphi_{k}, \varphi_{j}\right)=\sum_{i=0}^{n} \varphi_{k}\left(x_{i}\right) \varphi_{j}\left(x_{i}\right)=\sum_{i=0}^{n} x_{i}^{k} x_{i} \\
&\left(\varphi_{k}, y\right)=\sum_{i=0}^{n} \varphi_{k}\left(x_{i}\right) y\left(x_{i}\right)=\sum_{i=0}^{n} x_{i}^k y_{i},
\end{aligned}
$$
То систему нормальних рівнянь $\ref{3.6}$ можна переписати в компактному вигляді
$$
\left\{\begin{array}{l}
c_{0}\left(\varphi_{0}, \varphi_{0}\right)+c_{1}\left(\varphi_{0}, \varphi_{1}\right)+c_{2}\left(\varphi_{0}, \varphi_{2}\right)+\ldots+c_{m}\left(\varphi_{0}, \varphi_{m}\right)=\left(\varphi_{0}, y\right) \\
c_{0}\left(\varphi_{1}, \varphi_{0}\right)+c_{1}\left(\varphi_{1}, \varphi_{1}\right)+c_{2}\left(\varphi_{1}, \varphi_{2}\right)+\ldots+c_{m}\left(\varphi_{1}, \varphi_{m}\right)=\left(\varphi_{1}, y\right) \\..........\\
c_{0}\left(\varphi_{m}, \varphi_{0}\right)+c_{1}\left(\varphi_{m}, \varphi_{1}\right)+c_{2}\left(\varphi_{m}, \varphi_{2}\right)+\ldots+c_{m}\left(\varphi_{m}, \varphi_{m}\right)=\left(\varphi_{m}, y\right)
\end{array}\right.
\label{3.7}\tag{7}
$$

### Приклад 2

Функцію $f(x)=1-\frac{x^2}{\pi ^2}$, задану своїми значеннями в вузлах $x_0=0,x_1=\pi /3,x_2=\pi/2,x_3=2\pi/3,x_4=pi$ наблизити тригонометричним поліномом
$$
Q_{1}(x)=C_{0}+C_{1} \cos x
$$
В цьому випадку $
\varphi_{0}(x)=1, \quad \varphi_{1}(x)=\cos x
$.

Нормальна система має вигляд:
$$
\left\{\begin{array}{l}
c_{0}\left(\varphi_{0}, \varphi_{0}\right)+c_{1}\left(\varphi_{0}, \varphi_{1}\right)=\left(\varphi_{0}, y\right) \\
c_{0}\left(\varphi_{1}, \varphi_{0}\right)+c_{1}\left(\varphi_{1}, \varphi_{1}\right)=\left(\varphi_{1}, y\right)
\end{array}\right.
\label{3.8}\tag{8}
$$
Обчислення коефіцієнтів системи $\ref{3.8}$ запишемо в таблицю:

![image-20220330203502570](https://s2.loli.net/2022/03/31/JdXUQMs4YaTEHeF.png)

Нормальна система  розпадається на два незалежних рівняння
$$
\left\{\begin{array}{lll}
5 c_{0}=115 / 36 & \Rightarrow & c_{0}=23 / 36 \\
2,5 c_{1}=7 / 6 & \Rightarrow & c_{1}=7 / 15
\end{array}\right.
$$
Тобто $Q_1(x)=23/36+7/15$

# Лекція 5. Основні теореми квадратичного наближення

Нехай функція $f(X)$ задана на множині $x=(x|a\leq x\leq  b)$ і вибрана система лінійно незалежних функцій $\mu_0(x),\mu_1(x),..,\mu_m(x)$
Необхідно так підібрати коефіцієнти  $c_0,c_1,..,c_m$, щоб поліном
$$
\tag{1}
h(x)=c_0\mu_0(x)+c_1\mu_1(x)+...+c_m\mu_m(x)
$$
був якомога близьким до $f(x)$ на множині вузлів $a\leq x_i\leq b$ в сенсі мінімуму оцінки $\Epsilon$

Розглянемо систему нормальних рівнянь в загальному випадку:
$$
\left\{\begin{array}{l}
\left(\varphi_{0}, \varphi_{0}\right) c_{0}+\left(\varphi_{0}, \varphi_{1}\right) c_{1}+\ldots+\left(\varphi_{0}, \varphi_{m}\right) c_{m}=\left(\varphi_{0}, f\right) \\
\left(\varphi_{1}, \varphi_{0}\right) c_{0}+\left(\varphi_{1}, \varphi_{1}\right) c_{1}+\ldots+\left(\varphi_{1}, \varphi_{m}\right) \varphi_{m}=\left(\varphi_{1}, f\right) \\......\\
\left(\varphi_{m}, \varphi_{0}\right) c_{0}+\left(\varphi_{m}, \varphi_{1}\right) c_{1}+\ldots+\left(\varphi_{m}, \varphi_{m}\right) \varphi_{m}=\left(\varphi_{m}, f\right) \\

\end{array}\right.
\label{5.1}\tag{1}
$$

## Теорема 1.

Для того, щоб поліном $h(x)$ був розв'язком задачі найкращого квадратичного наближення, необхідно і достатньо, щоб числа $c_0,c_1,..,c_m$ були розв'язками системи $\ref{5.1}$.

### Достатність

Нехай числа $c_0,c_1,..,c_m$ - розв'язки системи $\ref{5.1}$. Візьмемо деякі інші числа $b_0,b_1,..,b_m$ і складемо функцію
$$
g(x)=b_{0} \varphi_{0}(x)+b_{1} \varphi_{1}(x)+\ldots+b_{m} \varphi_{m}(x)
\label{5.2}\tag{2}
$$
Доведемо, що $\|f-g\|>\|f-h\|$,
де позначено $
f=f(x), f=g(x), \quad h=h(x)
$,

Маємо:
$$
\|f-g\|^{2}=(f-g, f-g)=(f-h+h-g, f-h+h-g)=\\
=((f-h)+(h-g),(f-h)+(h-g))=\|f-h\|^{2}+\\
+2(f-h, h-g)+\|h-g\|^{2}
\label{5.*}\tag{*}
$$
Перепишемо перше рівняння системи у вигляді 
$$
\left(f-\left(c_{0} \varphi_{0}+c_{1} \varphi_{1}+\ldots+c_{m} \varphi_{m}\right), \varphi_{0}\right)=0,\\
\text{де }\,\varphi_k=\varphi_k(x)
\label{5.3}\tag{3}
$$
Приймаючи до уваги $\ref{5.1}$, отримаємо
$$
\left\{\begin{array}{l}
\left(f-h, \varphi_{0}\right)=0 \\
\left(f-h, \varphi_{1}\right)=0 \\........\\
{\left(f-h, \varphi_{m}\right)}=0
\end{array}\right.
\tag{5}\label{5.5}
$$
умова $\ref{5.5}$ - це умова ортогональної функції $(f-h)$ і $\varphi_0,\varphi_1,...,\varphi_m$.

Запишемо
$$
h(x)-g(x)=\sum_{i=0}^{m}\left(e_{i}-b_{i}\right) \varphi_{i}(x)
\label{5.6}\tag{6}
$$
Сформуємо:
$$
\begin{aligned}
&(f-h, h-g)=\left(f-h, \sum_{i=0}^{m}\left(c_{i}-b_{i}\right) \varphi_{i}\right)=\\
=&\left(c_{0}-b_{0}\right)\left(f-h, \varphi_{0}\right)+\left(c_{1}-b_{1}\right)\left(f-h, \varphi_{1}\right)+\ldots+\left(c_{m}-b_{m}\right)(f-h)
= 0,
\end{aligned}
$$
тобто
$$
(f-h,h-g)=0
\label{5.7}\tag{7}
$$
з урахуванням $\ref{5.7}$ перепишемо рівність $\ref{5.*}$ у вигляді
$$
\|f-g\|^{2}=\|f-h\|^{2}+\|h-g\|^{2}
\label{5.8}\tag{8}
$$
Рівняння 8 - це теорема Піфагора в Гільбертовому просторі. Оскільки $
\|h-g\|^{2}>0
$ в умовах $
h \neq g$, то
$$
\|f-g\|^{2}>\|f-h\|^{2}
$$
що і потрібно було довести.

### Доведемо необхідність.

Нехай $\|f-g\|>\|f-h\|$. при будь-якому $g=g(x)$. необхідно довести, що числа  $c_0,c_1,..,c_m$ задовольняють системі $\ref{5.1}$ 

Запишемо $\ref{5.*}$:
$$
\|f-g\|^{2}=\|f-h\|^{2}+2(f-h, h-g)+\|h-g\|^{2}
\label{5.8.1}\tag{8}
$$
Оскільки 8 виконується при будь-якому $g=g(x)$, розглянемо випадок $g(x)$, близького до $h(x)$, тобто $
h \rightarrow g$ 

Тоді величина $\|h-g\|^{2}$ - є величина другого порядку малості у зрівнянні з величиною $2(f-h, h-g)$

Тоді в першому наближенні
$$
\|f-g\|^{2}=\|f-h\|^{2}+2(f-h, h-g)
\label{5.9}\tag{9}
$$
Оскільки$(f-h, h-g)$ може приймати різні знаки, то для виконання 9 має бути
$$
(f-h, h-g)=0
\label{5.10}\tag{10}
$$
Таким чином з 9 будемо мати
$$
||f-g||^2=||f-h||^2
$$
тобто з 10 отримаємо з урахуванням $\ref{5.6}$ що
$$
\begin{gathered}
(f-h, h-g)=\left(f-h, \sum_{i=0}^{m}\left(c_{i}-b_{i}\right) \varphi_{i}(x)\right)= \\
=\left(с_{0}-b_{0}\right)\left(f-h, \varphi_{0}\right)+\left(c_{1}-b_{1}\right)\left(f-h, \varphi_{1}\right)+\ldots+\left(c_{m}-b_{m}\right)\left(f-h, \varphi_{m}\right)=0
\end{gathered}
$$
Оскільки функція $g(x)$ - довільна, то $b_0,b_1,..,b_m$ - теж довільні, тоді довільні і коефіцієнти $(c_0-b_0),(c_1-b_1),..,(c_m-b_m)$ 
Тоді з $\ref{5.10}$ випливає що одночасно
$$
\left\{\begin{array}{l}
\left(f-h, \varphi_{0}\right)=0 \\
\left(f-h, \varphi_{1}\right)=0 \\
\left(f-h, \varphi_{m}\right)=0
\end{array}\right.
\label{5.11}\tag{11}
$$
А система 11 як ми бачили раніше - це фактично система $\ref{5.1}$. тобто необхідність доведення.

## Теорема 2.

Система нормальних рівнянь $\ref{5.1}$ для будь-якої функції $f(x)$ має розв'язок і при тому єдиний.

Доведемо від противного. Нехай система $\ref{5.1}$ має два розв'язки: $c_0,c_1,...,c_m$ і $b_0,b_1,...,b_m$
Тоді маємо:
$$
h(x)=c_{0} \varphi_{0}(x)+c_{1} \varphi_{1}(x)+\ldots+c_{n} \varphi_{n}(x)
\label{5.12}\tag{12}
$$
в скороченому вигляді
$$
h(x)=\sum_{i=0}^{m} с_{i} \varphi_{i}(x) .
$$
Аналогічно:
$$
\begin{aligned}
g(x) &=b_{0} \varphi_{0}(x)+b_{1} \varphi_{i}(x)+\ldots+b_{m} \varphi_{m}(x)=\\
&=\sum_{i=0}^{m} b_{i} \varphi_{i}(x)
\end{aligned}
\label{5.13}\tag{13}
$$
Оскільки $c_i,i=1,2,..,m;\,\,b_i,i=0,1,2,..,m$ - розв'язки, то одночасно

$(f-h,\varphi_i)=0$ 		,$i=0,1,..,m$ 		(14)

$(f-g,\varphi_i)=0$		  ,$i=0,1,..,m$		 (15)

Віднімемо 14 від 15, маємо:
$$
\begin{aligned}
&\left(f-g, \varphi_{i}\right)-\left(f-h, \varphi_{i}\right)=0, i=\overline{0,m} \\
&\left(f-g-f+h, \varphi_{i}\right)=0, \quad i=\overline{0, m} .
\end{aligned}
$$
Остаточно отримали:
$$
\left(h-g, \varphi_{i}\right)=0\\i=\overline{0, m}
\label{5.16}\tag{16}
$$
Розпишемо 16 для $i=0,1,..m$:
$$
\left\{\begin{array}{l}
\left(h-g, \varphi_{0}\right)=0 \\
\left(h-g, \varphi_{1}\right)=0 \\
\left(h-g, \varphi_{m}\right)=0
\end{array}\right.
\label{5.17}\tag{17}
$$
Домножимо перше рівняння 17 на $(c_0-b_0)$, друге - на$(c_1-b_1)$ і т.д. і складемо:
$$
\begin{gathered}
\left(c_{0}-b_{0}\right)\left(h-g, \varphi_{0}\right)+\left(c_{1}-b_{1}\right)\left(h-g, \varphi_{1}\right)+\ldots+\left(c_{m}-b_{m}\right)\left(h-g, \varphi_{m}\right)=0 \\
\left(h-g,\left(c_{0}-b_{0}\right) \varphi_{0}+\left(c_{1}-b_{1}\right) \varphi_{1}+\ldots+\left(c_{m}-b_{m}\right) \varphi_{m}\right)=0
\end{gathered}
$$
тобто $(h-g,h-g)=0$, це означає, що $||h-g||^2=0$, звідки випливає, що $h=g$, тобто $c-i=b_i,i=\overline{0,m}$, що є протиріччям.
Теорема доведена

## Похибка квадратичного наближення

Розглянемо
$$
\|f-h\|^{2}=(f-h, f-h)=\|f\|^{2}-2(f, h)+\left\|h^{2}\right\|
\label{5.18}\tag{18}
$$
Оскільки
$$
(f, h)=(f-h+h, h)=(f-h, h)+\|h\|^{2}
\label{5.19}\tag{19}
$$
Але оскільки $(f-h,h)=0$, бо $(f-h,\varphi_i)=0,i=\overline{0,m}$, то з 18 з урахуванням 19 маємо
$$
\|f-h\|^{2}=\|f\|^{2}-2\|h\|^{2}+\|h\|^{2}=\|f\|^{2}-\|h\|^{2}
$$
Остаточно для похибки маємо:
$$
\|f-h\|^{2}=\|f\|^{2}-\|h\|^{2}
\label{5.20}\tag{20}
$$
з 20 випливає що значення похибки заздалегідь невідоме, тобто оцінка 20 є постеріорною (після досліду).

## Неперервне квадратичне наближення алгебраїчними поліномами

Нехай на множині $X=(x|a\leq x\leq b)$ задана система базисних функцій
$$
\varphi_{0}(x)=1, \varphi_{1}(x)=x, \varphi_{2}(x)=x^{2}, \ldots, \varphi_{m}(x)=x^{m}
$$
Апроксимуючий поліном має вигляд
$$
h_{m}(x)=c_{0}+c_{1} x+c_{2} x^{2}+1 .+c_{m} x^{m}
$$
Система нормальних рівнянь записується у вигляді
$$
\left\{\begin{array}{l}
(1,1) c_{0}+(x, 1) c_{1}+\ldots+\left(x^{m}, 1\right) c_{m}=(f, 1) \\
(1, x) c_{0}+(x, x) c_{1}+\ldots+\left(x^{m}, x\right) c_{m}=(f, x) \\............\\
\left(1, x^{m}\right) c_{0}+\left(x, x^{m}\right) c_{1}+\ldots+\left(x_{m},x_m)c_m=(f,x^m)\right.
\end{array}\right.
$$
де
$$
\begin{aligned}
(1,1) &=\int_{a}^{b} 1 \cdot 1 d x=b-a \\
(x, 1) &=\int_{a}^{b} 1 \cdot x d x=\int_{a}^{b} x d x=\left.\frac{x^{2}}{2}\right|_{a} ^{b}=\frac{1}{2}\left(b^{2}-a^{2}\right) \\
\left(x^{m}, 1\right) &=\int_{a}^{b} 1 x^{m} d x=\left.\frac{x^{m+1}}{m+1}\right|_{a} ^{b}=\frac{b^{m+1}-a^{m+1}}{m+1}
\end{aligned}
$$

### Приклад

задану функцію $f(x)=\sqrt{x+1}$ наблизити поліномом $Q(x)=c_0+c_1x$ на відрізку $x$є$[0,3]$ 

запишемо систему нормальних рівнянь:

$$
\tag{21}
\left\{\begin{array}{l}
\int_{0}^{3} d x \cdot c_{0}+\int_{0}^{3} x d x \cdot c_{1}=\int_{0}^{3} \sqrt{x+1} \cdot 1 d x \\
\int_{0}^{3} x d x \cdot c_{0}+\int_{0}^{3} x^{2} d x \cdot c_{1}=\int_{0}^{3} \sqrt{x+1} \cdot x d x
\end{array}\right.
$$
Обчислимо інтеграли в системі 21
$$
\begin{aligned}
&\int_{0}^{3} d x=3, \quad \int_{0}^{3} x d x=\left.\frac{x^{2}}{2}\right|_{0} ^{3}=\frac{9}{2}\\
&\int_{0}^{3} \sqrt{x+1} d x=\int_{0}^{3}(x+1)^{1 / 2} d x=\left.\frac{(x+1)^{3 / 2}}{3 / 2}\right|_{0} ^{3}=\\
&=\frac{2}{3}\left(4^{3 / 2}-1\right)=\frac{14}{3}\\
&\int_{0}^{3} x^{2} d x=\left.\frac{x^{3}}{3}\right|_{0} ^{3}=\frac{27}{3}=9\\
&\int_{0}^{3} \sqrt{x+1} x d x=\left|\begin{array}{ll}
u=x & d u=d x \\
d v=\sqrt{x+1} d x & v=\int \sqrt{x+1} d x=\mid=
\end{array}\right|=\\
&=\left.x \cdot \frac{2}{3}(x+1)^{3 / 2}\right|_{0} ^{3}-\frac{2}{3} \int_{0}^{3}(x+1)^{3 / 2} d x=\frac{(x+1)^{3 / 2}}{3 / 2}\\
&=3 \cdot \frac{2}{3} \cdot 4^{3 / 2}-0-\left.\frac{2}{3} \cdot \frac{2}{5}(x+1)^{5 / 2}\right|_{0} ^{3}=\\
&=2 \cdot 2^{3}-\frac{4}{15}\left(4^{5 / 2}-1\right)=16-\frac{4}{15} \cdot(32-1)=16-\frac{4 \cdot 31}{15}=\frac{116}{15}
\end{aligned}
$$


Нормальна система:

$$
\left\{\begin{array}{l}
3c_0+\frac{9}{2}c_1=14/3\\
\frac{9}{2}c_0+9c_1=\frac{116}{15}
\end{array}\right.
$$
Домножимо друге рівняння на $-\frac{1}{2}$ і додамо до першого:

###### <img src="https://i.imgur.com/oWcWFSA.png" style="zoom:80%;" />

Тоді з другого рівняння отримаємо:

<img src="https://i.imgur.com/tGDs4IY.png" style="zoom:67%;" />

Таким чином: $Q(x)=\frac{16}{15}+\frac{44}{135}x$ 

Оцінимо похибку наближення:

<img src="https://i.imgur.com/s3B3Ej4.png" style="zoom:67%;" />

Похибка достатньо мала

# 05.04.22 Лекція 6 

## Неперервне квадратичне наближення у випадку ортогонального базису

нехай базисні функції $\varphi_0(x),\varphi_1(x),...,\varphi_m(x)$ взаємно ортогональні на $[a.b]$ тобто 
$(\varphi_k,\varphi_p)=0,\,k\not= p$
тоді система нормальних рівнянь має вигляд:
$$
\left\{\begin{array}{l}
\left(\varphi_{0}, \varphi_{0}\right) c_{0}=\left(f, \varphi_{0}\right) \\
\left(\varphi_{1}, \varphi_{1}\right) c_{1}=\left(f, \varphi_{1}\right) \\.....\\
\left(\varphi_{m}, \varphi_{m}\right) c_{m}=\left(f, \varphi_{m}\right)
\end{array}\right.
\label{6.1}\tag{1}
$$
і розпадається на m окремих рівнянь
$$
\left(\varphi_{k}, \varphi_{k}\right) с_{k}=\left(f, \varphi_{k}\right), \quad k=\overline{0, m}
\label{6.2}\tag{2}
$$
з рівнянь 2 маємо:
$$
c_{k}=\frac{\left(f, \varphi_{k}\right)}{\left(\varphi_{k}, \varphi_{k}\right)}, k=\overline{0, m}\label{6.3}\tag{3}
$$

## неперервне квадратичне наближення тригонометричними поліномами

Розглянемо систему функцій
$$
\varphi_0(x)=1\\
\varphi_1(x)=cos(x)\\
\varphi_2(x)=sin(x)\\
\varphi_3(x)=cos(2x)\\
\varphi_4(x)=sin(2x)\\
....\\
\varphi_{2m-1}(x)=cos(mx)\\
\varphi_{2,}(x)=sin(mx)
$$
ці функції є ортогональними на інтервалі $x\in[-\pi,\pi]$ оскільки
$$
\begin{aligned}
& \int_{-\pi}^{\pi} \cos k x \cdot \cos p x d x=2 \int_{0}^{\pi} \cos k x \cdot \cos p x d x=\\
=& \int_{0}^{\pi}(\cos (k+p) x+\cos (k-p) x) d x=\\
=&\left.\frac{\sin (k+p) x}{k+p}\right|_{0} ^{\pi}+\left.\frac{\sin (k-p) x}{k-p}\right|_{0} ^{\pi}=0
\end{aligned}
$$

$$
\begin{aligned}
& \int_{-\pi}^{\pi} \sin k x \cdot \sin p x d x=2 \int_{0}^{\pi} \sin k x \cdot \sin p x d x=\\
=& \int_{0}^{\pi}(\cos (k-p) x-\cos (k+p) x) d x=\left.\frac{\sin (k-p) x}{k-p}\right|_{0} ^{\pi}-\\
-&\left.\frac{\sin (k+p) x}{k+p}\right|_{0} ^{\pi}=0 \\
& \int_{-\pi}^{\pi} \sin k x \cdot \cos p x d x=\frac{1}{2} \int_{-\pi}^{\pi}(\sin (k+p) x+\sin (k-p) x) d x=\\
=& \frac{1}{2}\left(-\left.\frac{\cos (k+p) x}{k+p}\right|_{-\pi} ^{\pi}-\left.\frac{\cos (k-p) x}{k-p}\right|_{-\pi} ^{\pi}\right)=\\
=& \frac{1}{2}\left(\frac{-\cos (k+p) \pi+\cos (k+p) \pi}{k+p}+-\frac{\cos (k-p) \pi+\cos (k-p) \pi}{k-p}\right)=\\
=& 0
\end{aligned}
$$

Тригонометричний поліном степені m має вигляд:
$$
Q_m(x)=a_0+a_1cos (x)+b_1sin(x)+a_2cos(2x)+b_2sin(2x)+...\\+a_mcos(mx)+b_msin(mx)\label{6.4}\tag{4}
$$

$$
\begin{aligned}
&(1,1)=\int_{-\pi}^{\pi} d x=\left.x\right|_{-\pi} ^{\pi}=2 \pi \\
&(\cos k x, \cos k x)=\int_{-\pi}^{\pi} \cos ^{2} k x d x=\frac{1}{2} \int_{-\pi}^{\pi}(1+\cos 2 k x) d x= \\
&=\left.\frac{1}{2}\left(x+\frac{1}{2} \sin 2 x\right)\right|_{-\pi} ^{\pi}=\pi \\
&(\sin k x, \sin k x)=\int_{-\pi}^{\pi} \sin ^{2} x d x=\frac{1}{2} \int_{-\pi}^{\pi}(1-\cos 2 x) d x= \\
&=\left.\frac{1}{2}\left(x-\frac{1}{2} \sin 2 x\right)\right|_{-\pi} ^{\pi}=\pi
\end{aligned}
$$

Система нормальних рівнянь має вигляд:
$$
\left\{\begin{array}{l}
(1,1) a_{0}=(f, 1) \\
(\cos k x, \cos k x) a_{k}=(f, \cos k x), k=\overline{1, m} \\
(\sin k x, \sin k x) b_{k}=(f, \sin k x), k=\overline{1, m}
\end{array}\right.
$$
звідки:
$$
a_{0}=\frac{1}{2 \pi} \int_{-\pi}^{\pi} f(x) d x
\label{6.5}\tag{5}
$$

$$
a_{k}=\frac{1}{\pi} \int_{-\pi}^{\pi} f(x) \cdot \cos k x d x
\label{6.6}\tag{6}
$$

$$
b_{k}=\frac{1}{\pi} \int_{-\pi}^{\pi} f(x) \sin k x d x\label{6.7}\tag{7}\\k=\overline{1,m}
$$

коефіцієнти $a_0,a_k,b_k$ співпадають з коефіцієнтами ряда фур'є для фунції $f(x)$:
$$
\begin{aligned}
&f(x)=\frac{\bar{a}_{0}}{2}+\sum_{n=1}^{\infty}\left(a_{n} \cos n x+b_{n} \sin n x\right), \\
&\text { де } \bar{a}_{0}=\frac{1}{\pi} \int_{-\pi}^{\pi} f(x) d x .
\end{aligned}\label{6.8}\tag{8}
$$
таким чином, ряд фур'є є оптимальним наближення функції на інтервалі $x\in[-\pi,\pi ]$ в сенсі мінімальності середньоквадратичної похибки.

### Приклад

функцію $f(x)=|x|$ на інтервалі $x\in[-\pi,\pi ]$ наблизити тригонометричним поліномом 3го порядку
$$
\begin{aligned}
&Q_{3}(x)=a_{0}+a_{1} \cos x+b_{1} \sin x+a_{2} \cos 2 x+b_{2} \sin 2 x+ \\
&+a_{3} \cos 3 x+b_{3} \sin 3 x
\end{aligned}
$$
знайдемо коефіцієнти:
$$
a_{0}=\frac{1}{2 \pi} \int_{-\pi}^{\pi}|x| d x=\frac{1}{\pi} \int_{0}^{\pi} x d x=\left.\frac{1}{\pi} \cdot \frac{x^{2}}{2}\right|_{0} ^{\pi}=\frac{\pi}{2}
$$
<img src="https://i.imgur.com/tsd0RzL.png" style="zoom:67%;" />

отримали: $Q_3(x)=\frac{\pi}{2}-\frac{4}{\pi}cosx-\frac{4}{9\pi}cos3x$



оцінимо похибку наближення

<img src="https://i.imgur.com/PH0NVvt.png" style="zoom: 67%;" />

# Лекція 7 наближене обчислення похідних і інтегралів

## табличне (чисельне) диференціювання

Спочатку розглянемо приклад. Є функція $f(x)=\Epsilon sin(\frac{x}{\Epsilon^2})$ де $\Epsilon >0$, яка задовольняє умові $|f(x)|\leq \Epsilon$ отже є обмеженою

![image-20220405174855092](https://s2.loli.net/2022/04/05/mo4erj7MzEXNaul.png)

Знайдемо похідну  $f'(x)=\frac{1}{E}cos(\frac{x}{E^2})$ отже $-\frac{1}{E}\leq f'(x)\leq\frac{1}{E}$. Якщо взяти дуже мале $E$ (близько 0) то для обмеженої функції $f(x)$  похідна буде приймати дуже великі значення.

Оскільки чисельні методи визначення похідних є наближенними, то застосовувати їх треба з обмеженістю, бо похибка може бути занадто великою. Якщо значення функції задані як результати вимірювань і необхідно дослідити поведінку похідних, то треба застосувати попереднє зглажування з подальшим диференціюванням.

## Формули Грегорі-Ньютона

Нехай функція $f(x)$ задана своїми значеннями в рівновіддалених вузлах $x_0,x_1=x_0+h,x_2=x_0+2h,..$ . Необхідно обчислити наближене значення $f'(x_0)$
Використаємо інтерполяційну формулу Ньютона:
<img src="https://i.imgur.com/hTbr3hL.png" style="zoom:50%;" />(1)

Введемо позначення $y_k=f(x_k)$, $\frac{x-x_0}{h}=u$, тоді

<img src="https://i.imgur.com/29JiYnO.png" style="zoom:50%;" /> (2)

запишемо з урахуванням (2)

<img src="https://i.imgur.com/eFsc1vc.png" style="zoom:50%;" />

і т.д.
Тоді з 1 маємо:

<img src="https://i.imgur.com/hrltolM.png" style="zoom:67%;" /> (3)

Групуючи коефіцієнти по степеням та в 3 отримаємо:



<img src="https://i.imgur.com/xMR4RVn.png" style="zoom:67%;" />

Покладемо $hu=\tau$  і перепишемо 4 у вигляді:

<img src="https://i.imgur.com/HfiinLp.png" style="zoom:67%;" /> (5)

Порівняємо формулу 5 з розкладанням функції $f(x)$ в ряд Тейлора:
$$
f(x_0+\tau)=y_0+\frac{y'_0}{1!}\tau+\frac{y''_0}{2!}\tau^2+...\tag{6}
$$


Оскільки розкладання в ряд по степеням $\tau$ можна виконати єдиним способом, то порівнюючи коефіцієнти при однакових степенях  $\tau$ в правих частинах рівностей 5 і 6 отримаємо:
$$
y'_0=(1/h)(\Delta y_0-\frac{\Delta ^2y_0}{2}+\frac{\Delta ^3y_0}{3}-...)\tag{7}
$$

$$
y'_0=(1/h^2)(\Delta ^2y_0-\Delta ^3y_0+\frac{11}{12}\Delta ^4y_0-...)\tag{8}
$$



 Формули 7 і 8 це формули Грегорі-Ньютона, які використовують кінцеві різниці 1го роду. Вони апроксимують першу і другу похідні функції $f(x)$

Формули 7 і 8 записані для вузла $x_0$​. Для довільного вузла $x_k$​ ці формули мають вигляд:
$$
\begin{aligned}
&f^{\prime}\left(x_{k}\right)=\frac{1}{h}\left(\Delta y_{k}-\frac{\Delta^{2} y_{k}}{2}+\frac{\Delta^{3} y_{k}}{3}-\ldots\right) \\
&f^{\prime \prime}\left(x_{k}\right)=\frac{1}{h^{2}}\left(\Delta^{2} y_{k}-\Delta^{3} y_{k}+\frac{11}{12} \Delta^{4} y_{k}-\ldots\right)
\end{aligned}\tag{9;10}
$$


### Приклад

Знайти $f'(2)$ якщо

![image-20220405180803992](https://s2.loli.net/2022/04/06/5ItyRqEVA7OiLTH.png)

Знайдемо кінцеві різниці. Результат представимо в таблиці

![image-20220405180836135](https://s2.loli.net/2022/04/06/9weDWjuULygVXT2.png)

Маємо:

![image-20220405180917665](https://s2.loli.net/2022/04/06/7vAFgmJYSPclX8x.png)

Для другої похідної маємо:

![image-20220405180945756](https://s2.loli.net/2022/04/06/A8UgjEWGpJzd1ru.png)

# Лекція 8 13.04.22

## Операторно-символічне виведення формули Грегорі-Ньютона

Запишемо формулу Тейлора для функції $y=f(x)$:
$$
f\left(x_{0}+h\right)=f\left(x_{0}\right)+\frac{f^{\prime}\left(x_{0}\right)}{1 !} h+\frac{f^{\prime \prime}\left(x_{0}\right)}{2 !} h^{2}+\ldots+\frac{f^{(n)}\left(x_{0}\right)}{n !} h^{n}\tag{11}
$$


Введемо оператор диференціювання:
$$
Df(x)=f'(x)\tag{12}
$$


Тоді
$\begin{aligned}
&f^{\prime \prime}(x)=D f^{\prime}(x)=D^{2} f(x), \\
&f^{(n)}(x)=D^{n} f(x)
\end{aligned}$ 

Перепишемо формулу 11 з урахування введеного оператора диференціювання:
$f\left(x_{0}+h\right)=f\left(x_{0}\right)+\frac{Df\left(x_{0}\right)}{1 !} h+\frac{D^{2} f\left(x_{0}\right)}{2 !} h^{2}+\ldots+\frac{D^{n} f\left(x_{0}\right)}{n !} h^{n}$

Використовуючи формальні операції отримаємо:
$$
\tag{13}f\left(x_{0}+h\right)=f\left(x_{0}\right)\left(1+\frac{D}{1 !} h+\frac{D^{2}}{2 !} h^{2}+\ldots+\frac{D^{n}}{n !} h^{n}\right)
$$
Порівняємо вираз в дужках в правій частині 13 з розкладенням функції $e^x$ в степеневий ряд: <img src="https://i.imgur.com/SVxn2RD.png" style="zoom:50%;" />

Отримаємо:
$$
\tag{14}f\left(x_{0}+h\right)=e^{D h} f\left(x_{0}\right) .
$$


Віднімемо $f(x_0)$​ з лівої і правої частини 14:
$$
\tag{15}\begin{gathered}
f\left(x_{0}+h\right)-f\left(x_{0}\right)=e^{D h} f\left(x_{0}\right)-f\left(x_{0}\right)=\left(e^{D h}-1\right) f\left(x_{0}\right) . \\
\Delta f\left(x_{0}\right)=\left(e^{D h}-1\right) f\left(x_{0}\right)
\end{gathered}
$$


Рівність 15 треба розуміти як рівність дій, а не величини.
Отже з (15) маємо:

$\Delta=e^{Dh}-1;e^{Dh}=1+\Delta$

Логарифмуємо:
$$
\tag{16}D h=\ln (1+\Delta), \quad D=\frac{1}{h} \operatorname{ln}(1+\Delta) .
$$
Оскільки для $\ln (1+\Delta)$ маємо розкладання:
$$
\ln (1+\Delta)=\Delta-\frac{\Delta^{2}}{2}+\frac{\Delta^{3}}{3}-\frac{\Delta^{4}}{4}+\ldots \text {, }
$$
то 3 (16)
$$
\infty=\frac{1}{h}\left(\Delta-\frac{\Delta^{2}}{2}+\frac{\Delta^{3}}{3}-\frac{\Delta^{4}}{4}+\ldots\right) \text { (17) }
$$
Домножимо (17) на $f\left(x_{0}\right) б$ маємо:
$$
D f\left(x_{0}\right)=\frac{1}{h}\left(\Delta-\frac{\Delta^{2}}{2}+\frac{\Delta^{3}}{3}-\frac{\Delta^{4}}{4}+\ldots\right) f\left(x_{0}\right)
$$
тобто
$$
f^{\prime}\left(x_{0}\right)=\frac{1}{h}\left(\Delta f\left(x_{0}\right)-\frac{\Delta^{2} f\left(x_{0}\right)}{2}+\frac{\Delta^{3} f\left(x_{0}\right)}{3}-\frac{\Delta^{4} f\left(x_{0}\right)}{4}+\ldots\right)
$$
Отримаємо формулу для $f^{\prime \prime}\left(x_{0}\right)$
Возведемо (17) в квадрат:
$$
\begin{aligned}
&D^{2}=\frac{1}{h^{2}}\left(\Delta-\frac{\Delta^{2}}{2}+\frac{\Delta^{3}}{3}-\frac{\Delta^{4}}{4}+\ldots\right)^{2}= \\
&=\frac{1}{h^{2}}\left(\Delta^{2}+\frac{\Delta^{4}}{4}-\Delta^{3}+\frac{2}{3} \Delta^{4}-\ldots\right)= \\
&=\frac{1}{h^{2}}\left(\Delta^{2}-\Delta^{3}+\frac{11}{12} \Delta^{4}-\ldots\right) \\
&\text { Тоді } \\
&\Delta^{2} f\left(x_{0}\right)=\frac{1}{h^{2}}\left(\Delta^{2}-\Delta^{3}+\frac{11}{12} \Delta^{4}-\ldots\right) f\left(x_{0}\right)
\end{aligned}
$$
і остаточно:
$$
f^{\prime \prime}\left(x_{0}\right)=\frac{1}{h^{2}}\left(\Delta^{2} f\left(x_{0}\right)-\Delta^{3} f\left(x_{0}\right)+\frac{11}{12} \Delta^{4} f\left(x_{0}\right)-\ldots\right)
$$
Виведемо формули для обчислення похідних з використанням різниць другого роду.
Запишемо формулу Тейлора у вигляді
$$
f\left(x_{n}-h\right)=f\left(x_{n}\right)-\frac{f^{\prime}\left(x_{n}\right)}{1 !} h+\frac{f^{\prime \prime}\left(x_{n}\right)^{2}}{2 !} h^{2}+\ldots+(-1)^{n} \frac{f^{(n)}\left(x_{n}\right)}{n !} h^{n} \ldots
$$
Використаємо оператор диференціювання $D:$
$$
\begin{aligned}
&f\left(x_{n}-h\right)=f\left(x_{n}\right)-\frac{\partial f\left(x_{n}\right)}{1 !} n+\frac{\partial^{2} f\left(x_{n}\right)}{2 !} h^{2}-\ldots+ \\
&+(-1)^{n} \frac{D^{n} f\left(x_{n}\right)}{n !} h^{n}+\ldots \\
&f\left(x_{n}-h\right)=\left(1-\frac{D h}{1 !}+\frac{D^{2} h^{2}}{2 !}-\ldots+(-1)^{n} \frac{D^{n} h^{n}}{n !}+\ldots\right) f\left(x_{n}\right)(18)
\end{aligned}
$$
Оскільки
$$
1-\frac{\phi h}{1 !}+\frac{\phi^{2} h^{2}}{2 !}-\ldots=e^{-\infty h},
$$
то формула (18) набуває вигляду:
$$
f\left(x_{n}-h\right)=e^{-\infty h} f\left(x_{n}\right)
$$
тоді
$$
f\left(x_{n}-h\right)-f\left(x_{n}\right)=\left(e^{-D n}-1\right) f\left(x_{n}\right)
$$
тобто
$$
-\nabla f\left(x_{n}\right)=\left(e^{-\infty h}-1\right) f\left(x_{n}\right) \text {. (19) }
$$
Прирівнюючи дії в виразі (19) маємо
$$
\begin{gathered}
e^{-D h}-1=-\nabla, \\
e^{-D h}=1-\nabla,
\end{gathered}
$$
Логарифмуємо:
$$
-\infty h=\ln (1-\nabla)=-\nabla-\frac{\nabla^{2}}{2}-\frac{\nabla^{3}}{3}-\frac{\nabla^{4}}{4}-\cdots .
$$
Отримаємо:
$$
\begin{aligned}
D=-& \frac{1}{n}\left(-\nabla-\frac{\nabla^{2}}{2}-\frac{\nabla^{3}}{3}-\frac{\nabla^{4}}{4}-\ldots\right)=\\
&=\frac{1}{n}\left(\nabla+\frac{\nabla^{2}}{2}+\frac{\nabla^{3}}{3}+\frac{\nabla^{4}}{4}+\ldots\right) \quad(20)
\end{aligned}
$$
Домножимо (20) на $f\left(x_{n}\right)$, отримаємо:
$$
\text { D } f\left(x x_{4}\right)=\frac{1}{n}\left(\nabla+\frac{\nabla^{2}}{2}+\frac{\nabla^{3}}{3}+\frac{\nabla^{4}}{4}+\ldots\right) f\left(x_{n}\right)
$$
тобто
$$
f^{\prime}\left(x_{n}\right)=\frac{1}{h}\left(\nabla f\left(x_{n}\right)+\frac{\nabla^{2} f\left(x_{n}\right)}{2}+\frac{\nabla^{3} f\left(x_{n}\right)}{3}+\ldots\right)(21) .
$$
Для другої похідної отримаємо:
$$
f^{\prime \prime}\left(x_{n}\right)=\frac{1}{h^{2}}\left(\nabla^{2} f\left(x_{n}\right)+\nabla^{3} f\left(x_{n}\right)+\frac{11}{12} \nabla^{4} f\left(x_{11}\right)+\ldots\right) \text { (22) }
$$

### Приклад

Для функції $y=x^3$ отримати значення похідних $y'(5)$ та $y''(5)$, використовуючи формули (21) та (22).

**Сформуємо таблицю**

| $x_k$ | $y_k$ | $\nabla y_k$ | $\nabla^2y_k$ | $\nabla^3 y_k$ | $\nabla^4 y_k$ | $y'_k$ | $y''_k$ |
| ----- | ----- | ------------ | ------------- | -------------- | -------------- | ------ | ------- |
| 0     | 0     |              |               |                |                |        |         |
| 1     | 1     | 1            |               |                |                |        |         |
| 2     | 8     | 7            | 6             |                |                |        |         |
| 3     | 27    | 19           | 12            | 6              |                |        |         |
| 4     | 64    | 37           | 18            | 6              | 0              |        |         |
| 5     | 125   | 61           | 24            | 6              | 0              |        |         |

$$
y'(5)=\frac{1}{1}(61+\frac{24}{2}+\frac{6}{3}=61+12+2=75\\
y''(5)=\frac{1}{1^2}(24+6)=30
$$

Оскільки $\nabla^4y_k=0$, то формули 21 і 22 дають точні значення похідних $y'(5)$ і $y''(5)$.

## Наближення обчислення первісних функцій. Перша та друга формули Адамса

### Постановка задачі

Функція $y=f(x)$ задана в рівновіддалених вузлах $x_0,x_1,x_2,..,x_n$. де $x_i=x_0+ih$, своїми значеннями $y_0,y_1,..,y_n$

Введемо позначення:
$$
\begin{aligned}
&F\left(x_{n+1}\right)=\int_{x_{0}}^{x_{n+1}} f(x) d x=\int_{x_{0}}^{x_{n}} f(x) d x+ \\
&+\int_{x_{n}}^{x_{n+1}} f(x) d x=F\left(x_{n}\right)+\int_{x_{n} x_{n+1}}^{x_{n+1}} f(x) d x .
\end{aligned}
$$
$$
\begin{aligned}
&\text { Отже } \\
&\qquad F\left(x_{n+1}\right)=F\left(x_{n}\right)+\int_{x_{n}}^{x_{n} x_{n+1}}(x) d x
\end{aligned}
$$
Квадратичною формулою називається всяка проста формула, що апроксимує інтеграл $\int_{e_{n}}^{x_{\text {int }}^{\prime}} f(x) d x$ Замінимо підінтегральну функцію $f(x)$ інтерполяційним многочленом Ньютона $P_{3}(x)$ :
$$
\begin{aligned}
& \int_{x_{n}}^{x_{n}+1} f(x) d x \doteq \int_{x_{n}}^{x_{n+1}} P_{3}(x) d x=\int_{x_{n}}^{x_{n+1}}\left(y_{n}+\frac{\nabla y_{n 1}}{1 ! h}\left(x-x_{n 1}\right)+\right.\\
+&\left.\frac{\nabla^{2} y_{n}}{2 ! h^{2}}\left(x-x_{n 1}\right)\left(x-x_{n-1}\right)+\frac{\nabla^{3} y_{n 1}}{3 ! h^{3}}\left(x-x_{n 1}\right)\left(x-x_{n-1}\right)\left(x-x_{n-2}\right)\right) d x
\end{aligned}
$$
Позначимо
$$
\begin{aligned}
&\frac{x-x_{n}}{h}=u, \quad \begin{array}{l}
x=x_{n} \Rightarrow H=0 \\
x=x_{n+1} \Rightarrow u=1
\end{array}
\end{aligned}
$$
Тоді:
$$
x-x_{n}=h u . \quad d x=h d u
$$
Маємо:
<img src="https://i.imgur.com/y9BM96C.png" style="zoom:50%;" />


Тоді:


<img src="https://i.imgur.com/teDv6Ev.png" style="zoom:67%;" />



### Отримали першу формулу Адамса:

$$
\tag{2}\int_{x_{n}}^{x_{n}+1} f(x) d x=h\left(y_{n}+\frac{1}{2} \nabla y_{n}+\frac{5}{12} \nabla y_{n }^{2}+\frac{3}{8} \nabla y_{n }\right)
$$

Це - наближена формула для обчислення інтеграла на інтервалі $x\in[x_n,x_{n+1}]$. Вона використовує значення функція $f(x)$ за межами цього інтегралу. Це - недолік формули.
Отримаємо другу формулу Адамса: для цього використаємо значення функції $f(x)$ у вузлах $x_{n-1},x_n,x_{n+1}$:
![image-20220413104454444](https://s2.loli.net/2022/04/13/idfeKauHFLzjcwR.png)
Введемо заміну
$$
u=\frac{x-x_{n}+1}{h}
$$

тоді:
![image-20220413104527456](https://s2.loli.net/2022/04/13/3YLgfQdPTqUwCtF.png)
![image-20220413104539453](https://s2.loli.net/2022/04/13/1znwG29xtkF6eoI.png)

### Друга формула Адамса

Остаточно:
$$
\int_{x_{n}}^{x_{n+1}} f(x) d x=h\left(y_{n+1}-\frac{1}{2} \nabla y_{n+1}-\frac{1}{12} \nabla^{2} y_{n+1}-\frac{1}{24} \nabla^{3} y_{n+1}\right)\tag{3}
$$

## Квадратична формула трапецій

Замінимо підінтегральну функцію $f(x)$ на інтервалі $[x_k,x_{k+1}]$ поліномом Ньютона першого порядку (рис1.) Маємо:

![image-20220413104742619](https://s2.loli.net/2022/04/13/T9uytjQ4GnDqUbe.png)

![image-20220413104756930](https://s2.loli.net/2022/04/13/HQX4UM7lbDEukC3.png)

<img src="https://i.imgur.com/hep3iqp.png" style="zoom:80%;" />
$$
\int_{x x}^{x x+1} f(x) d x=h \cdot \frac{y_{k}+y_{k+1}}{2}\tag{4}
$$
Формула (4) - квадратична формула трапецій. На рис 1. зображена трапеція, що апроксимує площину під графіком функції $f(x)$ на інтервалі $[x_k,x_{k+1}]$.
Отримаємо складову формули трапецій, що має міск при обчисленні інтеграла $\int_{a}^{b} f(x) d x \text {. }$

Розіб'ємо інтервал $[a,b]$ на n рівних інтервалів і застосуємо до кожного з них квадратичну формулу (4):
![image-20220413105043395](https://s2.loli.net/2022/04/13/GqJSCZQefzX1ljk.png)
Отримали велику (складову) формулу трапецій:
$$
\int_{a}^{b} f(x) d x=\frac{b-a}{n}\left(\frac{y_{0}+y_{n}}{2}+y_{1}+y_{2}+\ldots+y_{n-1}\right)\tag{5}
$$


## Квадратична формула середніх (прямокутників)

Формулу ілюструє рис 2.
![image-20220413105213975](https://s2.loli.net/2022/04/13/wvhpKXjt2bLsiCV.png)
Площина під графіком функції $y=f(x)$ замінюється площиною прямокутника зі сторонами $h$ і $y(x_{k+1/2})$, де $x_{k+1/2}=\frac{x_{k+1}+x_k}{2}$.
Таким чином:
$$
\int_{x k}^{x_{k+1}} f(x) d x=h*y_{k+1 / 2}\tag{6}
$$

Легко отримати і велику формулу прямокутників
$$
\int_{a}^{b} f(x) d x=\frac{b-a}{n}\left(x_{1 / 2}+x_{3 / 2}+\ldots+x_{n-1 / 2}\right)\tag{7}
$$


## Квадратична формула Сімпсона

Наблизимо підінтегральну функцію $f(x)$ на інтервалі $[x_k,x_{k+1}]$ поліномом 2го порядку. Для цього використаємо вузли $x_k,x_{k+1/2}=x_{k+h/2}$

![image-20220413105701771](https://s2.loli.net/2022/04/13/JPjZnytGUmcbDkQ.png)

![image-20220413105715129](https://s2.loli.net/2022/04/13/MtJ2HjiYxR5n8Il.png)
$$
\int_{x_k}^{x _{k+1}} f(x) d x \doteq \frac{h}{6}\left(y_{k}+4 y_{k+1 / 2}+y_{k+1}\right)\tag{8}
$$


Отримали квадратичну формулу Сімпсона.
Виведемо велику (складову) формулу Сімпсона. Інтервал $[a,b]$ розіб'ємо на n рівних інтервалів довжиною $\frac{b-a}{n}$, застосовуючи до кожного з них формулу (8) , маємо

![image-20220413105913236](https://s2.loli.net/2022/04/13/pVlRkfzJENZYs6C.png)
$$
\begin{aligned}
\int_{a}^{b} f(x) d x=& \frac{b-a}{6 n}\left(y_{0}+y_{n}+2\left(y_{1}+y_{2}+\ldots+y_{n-1}\right)+\right.\\
&\left.+4\left(y_{1 / 2}+y_{3 / 2}+\ldots+y_{n}-1 / 2\right)\right)
\end{aligned}\tag{9}
$$




# 21.04.22 Похибки квадратичних формул

На попередній лекції ми отримали наступні квадратичні формули:

## Формула трапецій:

## ![image-20220423171341047](https://s2.loli.net/2022/04/23/cQUDX2u3i8KwfTn.png)

## формула середніх:

![image-20220423171501312](https://s2.loli.net/2022/04/23/g76Ma2qfvR41emh.png)

## Формула Сімпсона:

![image-20220423171519327](https://s2.loli.net/2022/04/23/R3DOYp94KQmsdE8.png)

Оцінимо похибки квадратичних формул. Розкладемо підінтегральну функцію $y=f(x)$ в ряд Тейлора з центром розкладання $x=x_{k+1/2}$:

![image-20220423171648142](https://s2.loli.net/2022/04/23/8hcqumYUDMrkPvV.png)

Проінтегруємо (1) на інтервалі $[x_k,x_{k+1}]$:
![image-20220423171736558](https://s2.loli.net/2022/04/23/RjfGkiQ5cDlUVTM.png)
![image-20220423171828599](https://s2.loli.net/2022/04/23/6OHiQELqIVzTwJc.png)
Порівнюючи вираз (5) з формулою середніх (2), отримаємо, що похибка квадратичної формули середніх:
![image-20220423171915702](https://s2.loli.net/2022/04/23/MZaz1DAUQG3TxJd.png)
Щоб отримати похибку формули трапецій, підставимо в формулу (4) $x=x_k$, отримаємо:
![image-20220423171959094](https://s2.loli.net/2022/04/23/vCJ8dK4qxaRty6X.png)
![image-20220423172014558](https://s2.loli.net/2022/04/23/Z2ULlHpoQA7C9ak.png)
Якщо підставити в (4) $x=x_{k+1}$, отримаємо:
![image-20220423172043762](https://s2.loli.net/2022/04/23/wFX58Qp72nZlTDJ.png)
Враховуючи (7) і (8), маємо:
![image-20220423172117400](https://s2.loli.net/2022/04/23/ntbYTylgx24pRJQ.png)
![image-20220423172128790](https://s2.loli.net/2022/04/23/At4EW6jkK9LyoNf.png)

Віднімаючи (9) від (5), отримаємо похибку квадратичної формули трапецій:
![image-20220423173000750](https://s2.loli.net/2022/04/23/aA9zsHtTDPIXBlW.png)

![image-20220423173011731](https://s2.loli.net/2022/04/23/y6BYD93LdzZh1AO.png)

Таким чином формула середніх вдвічі точніша за формулу трапецій. Причому значення похибки протилежні.

Розглянемо похибку квадратичної формули Сімпсона.
Сформуємо формулу Сімпсона з використанням формул (7) і (8):
Маємо:

![image-20220423173244070](https://s2.loli.net/2022/04/23/cbpLJQg65xAEdfT.png)

Порівнюючи (11) з розкладанням (5), отримаємо, що
![image-20220423173432349](https://s2.loli.net/2022/04/23/2VYOQWLubPMya9A.png)

# Чисельні та чисельно аналітичні методи розв'язання задачі Коші для звичайних диференціальних рівнянь

## Задача Коші. Загальні відомості

Розв'язання звичайних диференціальних рівнянь займає важливе місце серед прикладних задач фізики, хімії та техніки.

Відомо, що звичайне диференціальне рівянння р-го порядку можна за допомогою заміни звести до еквівалентної системи р-рівнянь 1го порядку

### приклад

![image-20220423184656518](https://s2.loli.net/2022/04/23/yXMPAc2WVg1DzKs.png)
![image-20220423184707313](https://s2.loli.net/2022/04/23/uieXAzyUCW8GoMP.png)

Аналогічно, довільну систему диференціальних рівнянь любого порядку можна замінити деякою еквівалентною системою рівнянь 1го порядку.
Тому в подальшому будемо розглядати систему рівнянь 1го порядку

![image-20220423184836004](https://s2.loli.net/2022/04/23/Dw4vL8cfJgEyxOZ.png)
Представляючи її в векторному вигляді

![image-20220423184915081](https://s2.loli.net/2022/04/23/F7qmE3yo1aA8iLC.png)
Як відомо з теорії диференціальних рівнянь, система (1) має множину розв'язків, яка в загальному випадку залежить від р параметрів $c_1,c_2,..,c_p$.
Введемо вектор
![image-20220423185039613](https://s2.loli.net/2022/04/23/uTnJ3AdWCIL5kSM.png)
Тоді розв'язок системи (1) або векторного рівняння (2) можна записати у формі:
![image-20220423185113562](https://s2.loli.net/2022/04/23/ot4VAWOfHXu635P.png)
Для визначенння $c_1,c_2,..,c_p$, тобто для виділення єдиного розв'язку, необхідно накласти р додаткових умов на функції $y_k(x)$.

### Розрізняють 3 типи задач для звичайних диференціальних рівнянь:

1. Задачі Коші
2. крайтова задача
3. задача на власні значення

## Задача Коші (задача з початковими умовами)

Маємо додаткові умови для визначення постійних $c_1,c_2,..,c_p$:
![image-20220423185354157](https://s2.loli.net/2022/04/23/a6FWd1wvLD4ZfGc.png)
(тобто задані значення всіх функцій $y_k(x)$ в одній і тій же точці $x=x_0$).

Ці умови можна розглядати як завдання координат початкової точки $(x_0,y_0,y_{20},...,y_{p0})$ інтегральної кривої в $(p_{11})$-мірному просторі $(x,y_1,y_2,..,y_p)$
Розв'язок рівняння (2) при цьому необхідно знайти на деякому відрізку $x\in [x_0,x_n]$

Треба зауважити, що якщо праві частини рівнянь (1) неперервні і обмежені в деякому околі початкової точки $(x_0,y_{10},y_{20},..,y_{p0})$, то задача Коші
![image-20220423193606195](https://s2.loli.net/2022/04/24/jYEcnmaGVCfWrLp.png)
Має розв'язок, але взагалі кажучи, не єдиний.

Якщо праві частини $f_1,f_2,..f_p$ не тільки неперервні, але й задовольняють умові Ліпшиця по змінним $y_k$, то розв'язок задачі Коші єдиний.

#### Умова Ліпшиця:

![image-20220423193827936](https://s2.loli.net/2022/04/24/E3dFWqljxGwPZ5p.png)

## Методи розв'язання задачі Коші

Поділяють на точні, наближені та чисельні. (точні методи розглядаються в курсі диференціальних рівнянь)

### Наближені методи

Розв'язок отримується як границя $\overline{y}(x)$ деякої послідовності $\overline{y_n}(x)$, причому $\overline{y_n}(x)$ виражаються через елементарні функції або за допомогою квадратур. Обмежуючись кінцевим числом n, отримаємо наближений вираз для  $\overline{y}(x)$.
 Приклад: метод розкладання розв'язку в узагальнений степеневий ряд.

Можна застосовувати для порівняльно простих задач (таких як лінійні)

### Чисельні методи

це алгоритми обчислення наближений (іноді - точних) значень шуканого розв'язку $\overline{y}(x)$ на деякій вибраній сітці значень аргументу $x_n$. Розв'язок при цьому отримується у вигляді таблиці.

Чисельні методи не дозволяють отримати загальний розв'язок рівняння (2), вони можуть надати тільки якийсь частковий розв'язок. Вони можуть бути застосовані до широкого класу рівнянь і до всіх типів задач.
Чисельні методи можна застосувати тільки до конкретно поставлених задач. В цьому сенсі задача повинна бути добре обумовлена, тобто малі зміни початкових умов не повинні приводити до великих змін в розташуванні інтегральних кривих.

## Метод розкладання в узагальнений степеневий ряд (метод Коші - Тейлора)

Теорія - див. Демідович, Марон с128-134

Приклад:
![image-20220423195533835](https://s2.loli.net/2022/04/24/hdwsg8RKiPBcCZS.png)
Розв'язок шукаємо у вигляді ряда Маклорена, (частинний випадок ряда Тейлора)
![image-20220423195612020](https://s2.loli.net/2022/04/24/PMI8KfORkS9YxWZ.png)
З початкових умов:
![image-20220423195636978](https://s2.loli.net/2022/04/24/KeLD5I1hdHjE8Nk.png)

![image-20220423203204537](https://s2.loli.net/2022/04/24/qmZbWQr7MUP3cO9.png)
тобто отримали розкладення:
![image-20220423203224437](https://s2.loli.net/2022/04/24/pTXMxPKUm7zZu4c.png)
Якщо початкові умови задаються в довільній точці $x=x_0$, то розв'язок шукається у вигляді ряда Тейлора
![image-20220423203316567](https://s2.loli.net/2022/04/24/uyeJcCHXTSKvnbV.png)
Метод рядів Тейлора є універсальним для любого диференціального рівняння з любими початковими умовами. Однак, отримати загальний вигляд члена ряда (8) неможливо (а про збігання ряда можна судити тільки по членам ряда). Ряд (8) швидко збігається в околі початкової точки. Яцщо треба отримати розв'язок на значному інтервалі, де ряд може розбігатися, або збігатися дуже повільно, цей метод не застосовується.
Самостійного значення не має.

## Метод послідовних наближень Пікара

Теорію чистити в книжці Демидович, марок стор 134-140
Це - наближений метод.
Розглянемо на практиці:
![image-20220423203657125](https://s2.loli.net/2022/04/24/QswpE1bv597doRY.png)
(Розв'язок цього рівняння не виражається через елементарні функції)
Застосуємо формулу метода Пікара
![image-20220423203807316](https://s2.loli.net/2022/04/24/5xV9S3DgGtAIRQo.png)
Метод Пікара доцільно застосовувати, якщо інтеграли вдається виразити через елементарні функції.

# Методи Рунте-Кутти

## Метод ломаних Ейлера

Розглянемо на прикладі рівняння першого порядку:
![image-20220430212249559](https://s2.loli.net/2022/05/01/W2TnG1N4FOYmQRP.png)

Треба скласти таблицю значень функції розв'язку y(x) в точках $x_1=x_0+h$ ,    $x_2=x_0+2h$ ,    $x_3=x_0+3h$,....

Розглянемо вузол $x_k=x_0+kh$ 		$x=x_k$

тоді $y'_k=f(x_k,y_k)$

Зробимо заміну похідної кінцевою різницею:

![image-20220430212525763](https://s2.loli.net/2022/05/01/mMPwsuGiYIUK3hR.png)Формула (13) - це робоча формула метода Ейлера
Отримаємо геометричну інтерпретацію метода. Розглянемо інтервал $[x_k,x_{k+1}]$ на інтегральній кривій:

![image-20220430212946474](https://s2.loli.net/2022/05/01/XyljmW2qAF3iuMx.png)

проведемо дотичну до інтегральної кривої в точці $x_k$:
![image-20220430213030439](https://s2.loli.net/2022/05/01/5aYIRUL36PysDnH.png)
Тобто маємо формулу метода Ейлера (13)

Таким чином відрізок інтерполяційної кривої на інтервалі  $[x_k,x_{k+1}]$ замінюється відрізком прямої, яка співпадає з дотичною до інтегральної кривої в точці $x_k$ тобто маємо процес, зображений на рис 2.
![image-20220430213211038](https://s2.loli.net/2022/05/01/HCzKGET45yucWwr.png)
В методі Ейлера інтегральна крива апроксимується ламаною і метод називається методом ламаних. 
Отримаємо методом Ейлера розв'язок задачі Коші (9) на інтервалі $x\in [0,1] $ з кроком $h=0,25$
![image-20220430213325825](https://s2.loli.net/2022/05/01/NBumUIRsJp1AjOc.png)
Результати розрахунку представимо в табличному вигляді. В останньому стовпчику наведемо "точний" розв'язок $\overline{y_k}$, отриманий методом Пікара за формулою
![image-20220430213453536](https://s2.loli.net/2022/05/01/ULc7vTRZuXanfs2.png)
![image-20220430213502007](https://s2.loli.net/2022/05/01/tekKGo5rPcFA8zV.png)
Отримали у(1,0)=0.2204. точне значення за методом Пікара $\overline{y}(1,0)=0,3502$ значно відрізняється від отриманого. похибка складає
![image-20220430213615969](https://s2.loli.net/2022/05/01/NYzpivCIWZtqHOh.png)
Покажемо, що метод Ейлера є методом 1го порядку точності.
Розкладемо функцію розв'язку у(х) в ряд Тейлора в околі точки $x=x_k$:
![image-20220430213714076](https://s2.loli.net/2022/05/01/qVbQYphHDA7sjtO.png)
Порядок членів, що відкидуються, дорівнює 2. таким чином, сам метод має перший порядок.

## Формула метода ейлера для векторного рівняння (системи рівнянь)

![image-20220430213821753](https://s2.loli.net/2022/05/01/cwdrMFJqph4kx7b.png)

### Приклад:

![image-20220430213835580](https://s2.loli.net/2022/05/01/vWRpt7xBVbZCLHo.png)

![image-20220430213844347](https://s2.loli.net/2022/05/01/9R2PLDB3TahIniM.png)

### Зауваження:

Разом із значеннями функції розв'язку в вузлах $x_k$ ми маємо можливість отримувати значення похідної функції розв'язку $z_{k+1}=y'_{k+1}$

## Метод Ейлера з напівкроком

Метод розглянемо на прикладі рівняння першого порядку:
![image-20220430214032687](https://s2.loli.net/2022/05/01/Np42o8TZ1JDV3Rx.png)
Формулу методу запишемо у вигляді
![image-20220430214050477](https://s2.loli.net/2022/05/01/aOfEsV5gGUAwPC9.png)
де
![image-20220430214059136](https://s2.loli.net/2022/05/01/qsH35kWpUQm6CTM.png)
Таким чином, інтегральна крива апроксимується відрізками прямих, напрямок яких співпадає з напрямком дотичної до інтегральної кривої в середній точці інтервалу $[x_k,x_{k+1}]$ 
Формула (15) записується двома формулами:
![image-20220430214226127](https://s2.loli.net/2022/05/01/dKZh7OgHzPSr95V.png)
Застосуємо формули метода Ейлера з напівкором (16) до розв'язання <img src="https://s2.loli.net/2022/05/01/3mMCeSEGisZfcXY.png" alt="image-20220430214256248" style="zoom:50%;" />
З початковою умовою у(0)=0
Отримаємо розв'язок на інтервалі $[0,1]$
З кроком h=0,25

Результати представлені в таблиці. На кожному кроці використовуються дві формули (16):
Спочатку перша, потім друга.
![image-20220430214759491](https://s2.loli.net/2022/05/01/nboxBISVWzXtyT5.png)
Отримали: $y(1,)=0,3405$ Похибка результату:
$\Delta=0,3502-0,3405=0,0097$ значно менша похибки метода Ейлера.
В подальшому ми покажемо, що метод Ейлера з напівкроком - це метод другого порядку. Формула для векторного рівняння (або системи) має вигляд:
![image-20220430214951443](https://s2.loli.net/2022/05/01/MLlZ2ngoYAciGkF.png)

## Модифікований метод Ейлера

Розглянемо на прикладі рівняння першого порядку.
формула метода має вигляд:
![image-20220430215033828](https://s2.loli.net/2022/05/01/ghJ3dy2eHnMQNWq.png)
Таким чином, на інтервалі $[x_k,x_{k+1}]$ напрямок руху співпадає з напрямком прямої з кутовим коефіцієнтом 
![image-20220430215133824](https://s2.loli.net/2022/05/01/Y7VZfmEhcv3yQq5.png)
тобто
![image-20220430215145314](https://s2.loli.net/2022/05/01/gL3wejkIrmUcDob.png)
Це - наявний метод, бо в правій частині значення <img src="https://s2.loli.net/2022/05/01/Aj1zdJes6hGNYkg.png" alt="image-20220430215209294" style="zoom:50%;" /> залежить від $y_{k+1}$, яке ще не визначене. Формула (18) представляється у вигляді двох формул:
![image-20220430215309461](https://s2.loli.net/2022/05/01/6n5gKN9sL14MxTX.png)
Перша формула (19) називається предиктор, друга - коректор. На кожному кроці застосовується обидві формули, при чому перша - один раз, друга може застосовуватися декілька разів у вигляді
![image-20220430215411919](https://s2.loli.net/2022/05/01/YH1IpFcKxXL6Bvg.png)
Умова закінчення розрахунку на інтервалі
![image-20220430215432714](https://s2.loli.net/2022/05/01/Wj7COV61k8o3ulb.png)
Де Е - задається.
Буде показано, що модифікований метод Ейлера - це метод 2го порядку.
Для системи рівнянь формул метода мають вигляд:
![image-20220430215526175](https://s2.loli.net/2022/05/01/lhOagrXvsRpYEoP.png)



# Загальна схема методів Рунге-Кутти методи Рунге-Кутти 2го порядку

Застосуємо формулу Лагранжа про кінцеві прирости на відрізку $[x_k,x_{k+1}]$:
![image-20220430215642940](https://s2.loli.net/2022/05/01/v47mM2UTAank1LZ.png)
Позначимо
![image-20220430215653982](https://s2.loli.net/2022/05/01/wRaVodFiA6Xtq9u.png)
тоді
![image-20220430215705706](https://s2.loli.net/2022/05/01/mPfAaLU5Ksqtr9D.png)
Диференціальне рівняння <img src="https://s2.loli.net/2022/05/01/JBsZDVnmdxbF3rC.png" alt="image-20220430215723087" style="zoom:50%;" /> замінюється різницевим рівнянням
![image-20220430215745733](https://s2.loli.net/2022/05/01/bpKRGunUaqwiQmh.png)

Ідея Рунге-Кутти - введення в різницеву схему (3) низку додаткових параметрів, які уточнюють наближення $x^*$. Це означає, що будується апроксимація <img src="https://s2.loli.net/2022/05/01/MzQiZsOqAm3pNrE.png" alt="image-20220430215857135" style="zoom:50%;" />

Представимо (3_ у вигляді

![image-20220430215943317](https://s2.loli.net/2022/05/01/EyavmtZ1lPLVWHA.png)
Тут р1,р2,...,р3,d1,d2,..,$d_{e-1}$ - параметри, вибором яких можна забезпечити необхідний порядок апроксимації <img src="https://s2.loli.net/2022/05/01/392Paq4tVXg7ubY.png" alt="image-20220430220036728" style="zoom:50%;" />

Наприклад, якщо у випадку бе=1 взяти р1=1, $k_1=f(x_k,y_k)$,  будемо мати метод Ейлера (першого порядку):
![image-20220430220227571](https://s2.loli.net/2022/05/01/TnpaikdtvQewEL1.png)
Розглянемо схеми другого порядку. Покладемо в (4) е=2
Маємо:
![image-20220430220338176](https://s2.loli.net/2022/05/01/mrvs5PONj4zkBYM.png)
Покажемо, що при е=2 можна так вибрати р1,р2, щоб схема (6) мала другий порядок апроксимації.
З (5) для к1 і к2 маємо:
![image-20220430220424412](https://s2.loli.net/2022/05/01/xaeHSz7UEsGKfdQ.png)
Скористаємось розкладанням Тейлора:
![image-20220430220501222](https://s2.loli.net/2022/05/01/X3ifuq1JQhnlFmU.png)



Розкладемо функцію двох змінних $f(x,y)$ --- <img src="https://s2.loli.net/2022/05/01/4kmC3RbqQ7JWr5z.png" alt="image-20220430220612026" style="zoom: 80%;" /> в ряд тейлора, отримуємо лінійні члени по h:
![image-20220430220657008](https://s2.loli.net/2022/05/01/xMN2AHfGhOVmJTW.png)
Для того, щоб схема (16) мала другий порядок по h, необхідно, щоб одночасно коефіцієнти при $y'_k$ і при $y''_k$ дорівнювали 0
![image-20220430220811302](https://s2.loli.net/2022/05/01/4B5xVIt23TziPWp.png)



Тобто
![image-20220510151630232](https://s2.loli.net/2022/05/10/xBqYPbj8vn9ldMN.png)

Всі схеми при ![image-20220510151650977](https://s2.loli.net/2022/05/10/EeFj9J5dbtcsCkm.png), для яких має місце умова (17), мають другий порядок точності.

Розглянемо випадок, коли $p_2=1;\,\alpha_1=1/2;\,p_1=0$
Маємо:
![image-20220510151811326](https://s2.loli.net/2022/05/10/rBlesQXdIo3AF12.png)

Це розглянутий раніше метод Ейлера з напівкроком.

Тепер візьмемо ![image-20220510151904937](https://s2.loli.net/2022/05/10/ofDWMFNSLCXuIcH.png)
Маємо:
![image-20220510151918125](https://s2.loli.net/2022/05/10/5UXtQxmws93nERv.png)Це розглянутий раніше модифікований метод Ейлера.

Таким чином ми показали, що метод Ейлера з напівкроком і модифікований метод Ейлера - це методи Рунге-Кутти 2го порядку.

## Методи Рунге-Кутти 3го і 4го порядків

### Методи 3го порядку

Загальна схема методів 3го порядку:
![image-20220510152057150](https://s2.loli.net/2022/05/10/Yc9p3HiSIoObg8y.png)
Оскільки на момент обчислення к3 вже відомі к1 і к2, схему можна деталізувати:
![image-20220510152131467](https://s2.loli.net/2022/05/10/qouV4Iwn8ZtRjkd.png)
Як і у випадку методів 2го порядку, можна показати, що калетним(?) вибором <img src="https://s2.loli.net/2022/05/10/il2e93qjX1VEJ6F.png" alt="image-20220510152222491" style="zoom:50%;" /> можна забезпечити схемі (1)-(2) третій порядок точності.

Умова цього наступна:
![image-20220510152301762](https://s2.loli.net/2022/05/10/ZRJnqX6peYvWKNz.png)

Серед безліч схем 3го порядку наведемо наступні



- А)
  ![image-20220510152354107](https://s2.loli.net/2022/05/10/V3Sf5vl6QIqha2z.png)
  ![image-20220510152406674](https://s2.loli.net/2022/05/10/H85Jhcz1w7dQmAq.png)

- Б)
  ![image-20220510152421387](https://s2.loli.net/2022/05/10/eOHEnBkqPM8vjrc.png)

- В)
  ![image-20220510152435750](https://s2.loli.net/2022/05/10/omzxAfI9QLNZbst.png)

- Г)
  ![image-20220510152448296](https://s2.loli.net/2022/05/10/khsQ9OpCvimo1Bl.png)

  

Запишемо формули методів А)-Г) для векторного рівняння:

А)![image-20220510152530326](https://s2.loli.net/2022/05/10/SzLYj1GmHf572yD.png)

Б)
![image-20220510152547599](https://s2.loli.net/2022/05/10/O2qZhUSlnk3Yt5i.png)

В)
![image-20220510152556809](https://s2.loli.net/2022/05/10/aAxXr9kROwsfS8h.png)

Г)
![image-20220510152608507](https://s2.loli.net/2022/05/10/C8cd7ltBJnHp9Lx.png)

#### Приклад

Розглянемо систему:
![image-20220510152633014](https://s2.loli.net/2022/05/10/Mj5DdyZ8FfvkxnT.png)
Запишемо формули методу А):
![image-20220510152653325](https://s2.loli.net/2022/05/10/4KjOTVAebpmaG7H.png)
![image-20220510152708351](https://s2.loli.net/2022/05/10/oMV4QUzqeYKjm9x.png)

## Методи Рунге-Кутти 4го порядку

Цей метод найбільш часто використовується в технічних задачах.
Схема метода для рівняння першого порядку:
![image-20220510152820589](https://s2.loli.net/2022/05/10/AaqUtD3czMF7Ve6.png)
Значення <img src="https://s2.loli.net/2022/05/10/Ukl8gqdzhEaw251.png" alt="image-20220510152828492" style="zoom:80%;" /> отримані з умови співпадання різницевої схеми (8) з рядом тейлора включно до членів порядку $h^4$ 

Для цієї схеми ![image-20220510152935821](https://s2.loli.net/2022/05/10/EsYHq3iaGntXg8x.png)
Схема метода Рунге-Кутти 4го порядку для векторного рівняння ![image-20220510153003669](https://s2.loli.net/2022/05/10/aLxToMjGfOB89rn.png):

![image-20220510153017164](https://s2.loli.net/2022/05/10/D35nTXjWFmozksP.png)

### Приклад

Система:
![image-20220510153034769](https://s2.loli.net/2022/05/10/RC7VpZwdrWOlfh6.png)

![image-20220510153048546](https://s2.loli.net/2022/05/10/qpRXgGim6QAvT71.png)

## Висновки по методам Рунге-Кутти

1. Всі методи є явними (використовують значення аргументу $x\in [x_k,x_{k+1})$)
2. Методи є однокроковими (використовують інформацію про у і $f(x,y)$ тільки з інтервалу $[x_k,x_{k+1})$
3. Припускають обчислення із змінним кроком
4. легко переносяться на системи диференціальних рівнянь,

## Підвищення точності чисельних методів інтегрування звичайних диференціальних рівнянь Правило Рунге

Розглянемо диф рівняння
![image-20220510161125869](https://s2.loli.net/2022/05/10/tRxvXNlis8BISGA.png)
Нехай відомі значення точного розв'язку <img src="https://s2.loli.net/2022/05/10/SB4gsGdUJFPlz5R.png" alt="image-20220510161146993" style="zoom: 67%;" /> а наступне значення <img src="https://s2.loli.net/2022/05/10/Le1uz5JPt2ayN8H.png" alt="image-20220510161210331" style="zoom:67%;" /> розкладене по степеням кроку h в ряд Тейлора:
![image-20220510161242093](https://s2.loli.net/2022/05/10/4hm5qVdOrUu3PYa.png)

Застосуємо чисельний (наближенний) метод до точних значень ![image-20220510161314118](https://s2.loli.net/2022/05/10/GCKvudzSXNbVwsh.png) і отримаємо
![image-20220510161325297](https://s2.loli.net/2022/05/10/hyufpOWGUDxTP5g.png)
Розкладемо його в ряд Тейлора:
![image-20220510161341590](https://s2.loli.net/2022/05/10/9nrCtqoFTZvjJ6R.png)

Якщо для всіх n виконується рівність <img src="https://s2.loli.net/2022/05/10/6vGLzd7Q1OnV8I3.png" alt="image-20220510161412853" style="zoom:67%;" /> причому <img src="https://s2.loli.net/2022/05/10/kPRoqVHueDjIGc2.png" alt="image-20220510161420823" style="zoom:67%;" /> для деякого n, то число m називається **порядком точності** наближеного методу.

При цьому похибка методу на кожному кроці має порядок $O(h^{m+1})$.
Якщо число m (порядок) відомо, то для грубої оцінки похибки методу можна застосувати **принцип** **Рунге**

Розрахунок проводять на двох сітках значень аргументу х. Для першої сітки відстань між вузлами становить h, для другої - 2h.
Позначимо точний розв'язок рівняння (1), як $\overline{y}(x)$. Наближений розв'язок отриманий на густій сітці з кроком h позначимо, як <img src="https://s2.loli.net/2022/05/10/Eic8X6lWy9eLKJY.png" alt="image-20220510161833413" style="zoom:67%;" /> . Тоді на одному кроці обчислень маємо оцінку:

![image-20220510161900284](https://s2.loli.net/2022/05/10/VpHnKk7CvahEfNZ.png)

вважаючи А постійним для кожного кроку обчислень, зробимо 2n кроків по густій сітці.
Отримаємо:
![image-20220510161944667](https://s2.loli.net/2022/05/10/dztL2rbl9oqDWcX.png)

Тепер зробимо n кроків по розрідженій сітці (H=2h). Отриманий наближений розв'язок позначимо, як <img src="https://s2.loli.net/2022/05/10/GmXFtvq71z59E2h.png" alt="image-20220510162026558" style="zoom:67%;" />

![image-20220510162033218](https://s2.loli.net/2022/05/10/iY3KSGZVmxW1BAX.png)

Для цього розв'язку маємо:
![image-20220510162103108](https://s2.loli.net/2022/05/10/o6KqWm1VBpuUXyF.png)

Формула (6) дозволяє уточнити розв'язок, отриманий на густій сітці за рахунок розв'язку, що отриманий на розрідженій сітці.
Враховуючи (4), запишемо уточнений розв'язок
![image-20220510162649972](https://s2.loli.net/2022/05/10/jaIsKFHTQNEWrGD.png)
Підставимо 6 в 7:
![image-20220510162704528](https://s2.loli.net/2022/05/10/ZWS7gfwjPkH2uEs.png)
Формула (8) уточнює розв'язок <img src="https://s2.loli.net/2022/05/10/cOCaFigoMq2HUAN.png" alt="image-20220510162724868" style="zoom:67%;" /> в вузлах, що співпадають, поправка складає
![image-20220510162751853](https://s2.loli.net/2022/05/10/2FYtTZ6jvmLnNfx.png)

Значення поправок в решті вузлів густої сітки знайдемо на основі найпростішої інтерполяції:
![image-20220510162831737](https://s2.loli.net/2022/05/10/4MGBhHqzdiFv3c2.png)

### Приклад

![image-20220510162846588](https://s2.loli.net/2022/05/10/3DWNJYkO4mil8n5.png)

# 10.05.22

# Багатокрокові методи розв'язання задачі Коші. Метод Адамса 4го порядку

В раніше розглянутих методах Рунге-Кутти значення $y_{k+1}$ обчислювалося на основі апрокимацій функції $f(x^*,y^*)$ де $x^*\in [x_k,x_{k=1}]$. тобто використовувалися х і у, що відносилися тільки до одного кроку. Такі методи називаються **однокроковими**.
Логічно припустити, що більшу точність можна отримати, якщо використати інформацію з попередніх кроків:
![](https://i.imgur.com/EklVSn3.png)

Саме на цій ідеї основані багатокрокові мтеоди.

Розглянемо **лінійні** багатокрокові методи.

## Загальна формула

![](https://i.imgur.com/ynJyQMZ.png)

Формула 1 дає опис загального лінійного р-крокового методу.
Якщо $\beta_0=0$ - метод називається явним, інакше маємо неявну схему.
В цьому випадку для обчислення $y_{k+1}$ треба знати $f_{k+1}$, яке невідоме.

При застосуванні багатокрокових методів на кожному кроці обчислень звичайно використовують одночасно дві схеми - явну і неявну. Явна схема називається **предиктор**, неявна - **коректор**. Явна схема дає початкове наближення $y^0_{k+1}$, неявна - уточнює це наближення.

## Метод Адамса (Штермера)

Метод Адамса отриманий за допомогою другої інтерполяційної формули Ньютона, в якій утримуються кінцеві різниці до 4го порядку включно

### Робочі формули методу

1. Явна схема:
   ![](https://i.imgur.com/RudDjF2.png)
2. Неявна схема:
   ![](https://i.imgur.com/sYYUCwx.png)

### Схема рішення:

1) використати предиктор 2 для обчислення початкового наближення $y^0_{k+1}$
2) покласти i=0. По формулі коректора 3 знайти уточнення
   ![](https://i.imgur.com/AsRV55E.png)

### Зауваження

1. Щоб розпочати обчислення за формулою 2 необхідно мати значення
   ![](https://i.imgur.com/C0UbHi3.png)
   Для їх знаходження треба використати інший метод 4го порядку, наприклад, метод Рунге-Кутти. Тобто спочатку треба тричі використати метод Рунге-Кутти 4го порядку з кроком h, а тільки потім формулу 2. Така процедура називається **розгонною**
2. Схему **коректора** можна використовувати на кожному кроці декілька разів. За таких умов кінець розрахунків на кожному кроці задається нерівністю:
   ![](https://i.imgur.com/nnXoLVc.png)
   
   

У випадку, коли маємо систему диференціальних рівнянь, формули Адамса набувають вигляду:
![](https://i.imgur.com/iZsTsNJ.png)

Запишемо розрахункові формули метода Адамса для системи:
![](https://i.imgur.com/CZ1yNiP.png)

Предиктор:
![](https://i.imgur.com/2nxIxdK.png)

Коректор:
![](https://i.imgur.com/AvsNQOl.png)

Формула 6 (? про систему чи шо) дозволяє уточнити розв'язок, отриманий на густій сітці за рахунок розв'язку, що отриманий на розріженій сітці.
Враховуючи 4, запишемо уточнений розв'язок
![](https://i.imgur.com/XsZaTxS.png)

Підставимо 6 в 7:
![](https://i.imgur.com/yMV2TGX.png)

Формула 8 уточнює розв'язок $\tilde{y}(x, h)$ в вузлах, що співпадають, поправка складає
![](https://i.imgur.com/9WJj7Kb.png)

Значення поправок в решті вузлів густої сітки знайдемо на основі найпростішої інтерполяції:
![](https://i.imgur.com/FL1X0Oj.png)

### Приклад:

![](https://i.imgur.com/vc29vwM.png)

В таблиці останній стовпчик $\overline{y}(x)$ - точний розв'язок, отриманий раніше **методом Пікара**.

Використаний метод чисельного інтегрування - метод Ейлера $(m=1)$, тобто формула 9 набуває вигляду:
![](https://i.imgur.com/NOto4JX.png)

Другий стовпчик - наближений розв'язок з кроком h=0.25

Третій стовпчик - наближений розв'язок з кроком 2h=0.5

Четвертий стовпчик: добавка до розв'язку: в співпадаючих вузлах вираховується за формулою 10, в неспівпадаючих вузлах - за формулою 9.1

П'ятий стовпчик - уточнений розв'язок

### Висновок

Уточнений розв'язок точніший за розв'язок $\tilde{y}(x, h)$

# Жорсткі рівняння. Неявний метод Ейлера

## Попередні відомості

Постійна часу в розв'язку диференціального рівняння - це час, необхідний для його зменшення в $\frac{1}{2}$ разів.

### Приклад

Маємо рівняння
![](https://i.imgur.com/NTLVAyR.png)

Отримаємо загальний розв'язок:

![](https://i.imgur.com/fme7RJl.png)

Стійке диференціальне рівняння називається **жорстким**, якщо воно має частинний розв'язок у вигляді експоненти, що складає, постійна часу якого дуже мала у зрівнянні з довжиною інтервала, на якому шукається цей розв'язок.
Для системи $\bar{y}=\bar{f}(t, \bar{y})$

Швидкості спадання пов'язані з власними значеннями матриці якості
![](https://i.imgur.com/0myRvv4.png)

Розглянемо наспупний приклад:
Знайдемо розв'язок системи
![](https://i.imgur.com/nGvN8WJ.png)

Матриця Якості маж вигляд:
![](https://i.imgur.com/NMnc9vj.png)

Знайдемо власні значення:
![](https://i.imgur.com/4pVcyhp.png)

Нескладно бачити, що $\lambda_1=-1;\lambda_2=-1000$
Запишемо розв'язок системи 3 у вигляді:
![](https://i.imgur.com/FbiITDL.png)

Знайдемо <img src="https://i.imgur.com/BmDeeeX.png" style="zoom:80%;" />. Для цього продиверенціюємо 4:
![](https://i.imgur.com/C7jtMRy.png)

З початкових умов маємо:
![](https://i.imgur.com/6v2VwhD.png)

з 3 і 5 при t=0 отримаємо:
![](https://i.imgur.com/nzuECHk.png)

Таким чином
![](https://i.imgur.com/iXJ8l5Q.png)

![](https://i.imgur.com/lnDQC5o.png)

Отже розв'язок має вигляд:
![](https://i.imgur.com/k5eRp2O.png)

Знайдемо ектстремальні значення розв'язку 6
![](https://i.imgur.com/SBZA4yo.png)

Спробуємо знайти чисельний розв'язок системи 3 методом Ейлера:
Маємо робочі формули:
![](https://i.imgur.com/7DrSPaz.png)

Нехай h=0.01 зробимо один крок
![](https://i.imgur.com/LUnnSoY.png)

Отримали, що вже після першого кроку
![](https://i.imgur.com/jvehtIN.png)

Розглянемо неявний метод Ейлера:

![](https://i.imgur.com/sjR9Qye.png)

Який для системи 3 записуються так:

![](https://i.imgur.com/fm6er8m.png)

Формули 7 приводяться до вигляду:
![](https://i.imgur.com/DXT2IWA.png)

Зробимо один крок за схемою 8
![](https://i.imgur.com/8PQdpsA.png)

Система 9 дає

![](https://i.imgur.com/WvSa7yF.png)

Ці значення більш прийнятні, ніж отримані звичайним методом Ейлера
**Основне протиріччя жорстких систем** полягає в тому, що **малий крок** інтегрування, потрібний для відтворення щвидкоплинних процесів **не може бути збільшений** в подальшому, коли похідна розв'язку стає суттєво меншою за її початкове значення.
Перший участок (на рисунку) з швидким зростанням (спаданням) розв'язку називається **пограничним шаром**. Для розглянутої системи це $t\in[0;0.01]$

## Властивість жорсткості

Задача Коші

![](https://i.imgur.com/FkgbdPw.png)

Називається **жорсткою** в інтервалі $t\in[a,b]$, якщо <img src="https://i.imgur.com/kkfWBFu.png" style="zoom:80%;" /> відношення

![](https://i.imgur.com/5O3qlOH.png)

Де $\lambda_i$ - власні значення матриці Якості <img src="https://i.imgur.com/zKrIivJ.png" style="zoom:80%;" />, в яку підставлено розв'язок $\overline{y}(t)$ в точці t

Величину $\mu(t)$ можна назвати **коефіцієнтом жорсткості** системи 10
Для розглянутої систему 3 $\mu=\frac{1000}1>>1$, тобто система 3 - жорстка

# 17.05.22

# Чисельне методи розв'язання крайових задач

## Загальні відомості про крайові задачі

### Постановка задачі:

Для заданого диференціального рівняння
![](https://i.imgur.com/EXUTAF6.png)

треба знайти розв'язок $y=y(x),x\in[a,b]$, який задовольняє крайовим умовам:
![](https://i.imgur.com/SFa8Gtz.png)

Крайові задачі поділяють на лінійні і нелінійні. Лінійні задачі мають місце, коли диференціальне рівняння лінійне, і лінійні крайові умови.
Лінійні задачі **поділяються на однорідні і неоднорідні**

### Приклад

Найпростіша двоточкова крайова задача. Знайти функцію $y=y(x)$, яка задовольняє диференціальному рівнянню другого порядку
![](https://i.imgur.com/OK3lKVK.png)

І приймає при $x=a$ і $x=b (a<b)$ задані значення
$y(a)=A;y(b)=B$

Геометрично це означає, що треба знайти інтегральну криву рівняння 3, яка проходить через дані точки $M(a,A)$  і $N(b,B)$ 

![](https://i.imgur.com/AHmZVOg.png)

Крайова задача може:

а) не мати розв'язків
Б) мати єдиний
В) мати декілька, або нескінчено багато

### Приклад 2

Диференціальне рівняння
$$
y''+y=0\tag{4}
$$
має загальний розв'язок
<img src="https://i.imgur.com/jHrGDfD.png" style="zoom:80%;" />

А) нехай $y(0)=0;y(\pi)=0$ тоді $c_1=0,c_2$ - довільне, тобто маємо нескінчену множину розв'язків $y=c*sin(x)$

Б) Нехай $y(0)=1;y(\pi)=1$ тоді отримаємо <img src="https://i.imgur.com/zHtQM45.png" style="zoom:80%;" /> тобто розв'язків задача не має

В) Нехай $y(0)=1;y(\frac{\pi}{2})=1$, тоді ![](https://i.imgur.com/Ugk29bq.png)і маємо єдиний розв'язок ![](https://i.imgur.com/x5BFx6v.png)

## Редукція (зведення) лінійної крайової задачі до задачі з початковими умовами

Розглянемо метод на прикладі рівняння другого порядку
![](https://i.imgur.com/U3ClSRU.png)

З крайовими умовами:
![](https://i.imgur.com/6j2Rr0i.png)

Спочатку розглянемо однорідне рівняння:
![](https://i.imgur.com/RUQActk.png)

1) задамо початкові умови
   ![](https://i.imgur.com/RT6Pe6H.png)
   Розв'язуючи чисельно задачі Коші 7 8 знайдемо розв'язок $u_1(x)$
2) Задамо інші початкові умови
   ![](https://i.imgur.com/a6P330r.png)
   
   

і знайдемо розв'язок задачі 7 9 $u_2(x)$
Можна показати, що розв'язки $u_1(x)$ і $u_2(x)$ лінійно незалежні

Тоді маємо загальний розв'язок рівняння 7 у вигляді
![](https://i.imgur.com/HWCpsbg.png)

Тепер знайдемо розв'язок рівняння 5
![](https://i.imgur.com/CqkPt10.png)

З довільними початковими умовами, наприклад
![](https://i.imgur.com/OoPxei7.png)

і знайдений розв'язок рівняння 5 буде мати вигляд:
![](https://i.imgur.com/NKxI4dH.png)

Залишається визначити с1 і с2 з крайових умов 6
З 13 початкових умов 8 і 9 маємо
![](https://i.imgur.com/ZmfqoNe.png)де $u_1(b),u_2(b),v(b)$ знайдені в результаті рішення відповідних задач Коші
Далі диференціюємо 13
![](https://i.imgur.com/r9ohagR.png)

Звідки маємо:
![](https://i.imgur.com/pviAb58.png)

Значення $u_1'(b),u_2'(b),v'(b)$також знайдені в результаті розв'язування задач Коші.
Таким чином <img src="https://i.imgur.com/JXajmmB.png" style="zoom:80%;" /> отримали як залежності від с1 с2. Підстановка цих залежностей в крайові умови 6 призводить до системи лінійних рівнянь відносно с1 і с2:
![](https://i.imgur.com/EfhY7OK.png)

Розв'язуючи яку знайдемо невідомі с1 і с2
таким чином крайова задача звелась до розв'язання трьох задач Коші і системи лінійних рівнянь 17

## Зведення задачі до рівнянь в кінцевих різницях

Розглянемо рівняння другого порядку 
![](https://i.imgur.com/aGqgj2L.png)

Де права частина в загальному випадку - нелінійна функція, і крайові умови 6
Розіб'ємо інтервал [a,b] точками $x_0=a$, $x_1,x_2,..,x_{n-1},x_n=b$ на n рівних відрізків довжиною <img src="https://i.imgur.com/b5baICz.png" style="zoom:80%;" />. Треба знайти <img src="https://i.imgur.com/JQILplQ.png" style="zoom:67%;" />

Запишемо ряди Тейлора
![](https://i.imgur.com/5NdALJP.png)

Віднімемо 20 від 19, маємо
![](https://i.imgur.com/EJS1N32.png)

Звідкіля отримаємо:
![](https://i.imgur.com/27Dnqsw.png)

Додаючи 19 до 20 маємо:
![](https://i.imgur.com/cfLnPEL.png)

Таким чином для $x=x_k$ з 18 21 22 маємо з точністю до 0$(h^2)$
![](https://i.imgur.com/YUEAAfU.png)

В системі 23 всього n-1 рівняння відносно невідомих $y_0,y_1,..y_n$, яких n+1
Треба ці дві умови знайти. Їх знайдемо з граничних умов 6
Для цього запишемо ряди Тейлора:
![](https://i.imgur.com/aXvG2NA.png)

Домножимо 24 на 4 і віднімемо від нього 25:
![](https://i.imgur.com/2M0gYqN.png)

Для правого кінця також маємо:
![](https://i.imgur.com/CIkrEcu.png)

Отримаємо з 27 28:
![](https://i.imgur.com/QNzyWpF.png)

Підставимо вирази 26 29 в крайові умови і отримаємо з врахуванням 23 наступну систему рівнянь:
![](https://i.imgur.com/fiqnkbh.png)

Таким чином задача 18, 6 звелася до системи n+1 рівнянь з n+1 невідомими.
розглянемо випадок лінійного рівняння
![](https://i.imgur.com/wbOEipm.png)

Кінцево-різницевий аналог цього рівняння
![](https://i.imgur.com/ewiTtEt.png)

Тоді система 30 приймає вигляд:
![](https://i.imgur.com/gGb6E4u.png)

Це - трьохдіагональна система лінійних рівнянь. Її можна розв'язати звичайним методом Гайса, Але більш економічним методом її розв'язування є розглянутий раніше метод прогонки, який застосовується при інтерполяції сплайнами.



# Метод прогонки

При застосуванні методу кінцевих різниць до крайових задач для диференціальних рівнянь другого порядку маємо трьохдіагональну систему лінійних алгебраїчних рівнянь, кожне з яких містить три сусідні невідомі. Для розв'язування такої системи розроблений спеціальний метод - метод прогонки.

Розглянемо лінійне диференціальне рівняння
![](https://i.imgur.com/d6BHzuu.png)

З двоточечними лінійними крайовими умовами
![](https://i.imgur.com/fEkxhbl.png)

<img src="https://i.imgur.com/Kqlxbhi.png" style="zoom: 67%;" />- неперервні функції на [a,b]

Як було показано в попередній лекції, замість диференціального рівняння 1 отримаємо систему кінцево різницевих рівнянь:
![](https://i.imgur.com/4x49YvA.png)

Після нескладних перетворень запишемо 3 у вигляді
![](https://i.imgur.com/sgOPvIq.png)

Де позначено:
![](https://i.imgur.com/Nha3yGC.png)

Для похідних на кінцях $x_0=a;x_n=b$беремо односторнні похідні
![](https://i.imgur.com/fIcuhy5.png)

Звідсіля згідно умов 2 отримаємо
![](https://i.imgur.com/FOn0UgG.png)

Розглянемо метод прогонки: Розв'яжемо систему 4 відносно $y_i$ маємо:
![](https://i.imgur.com/ARBcGLn.png)

Нехай за допомогою повної системи 4 6 з рівняння 7 виключемо невідоме $y_{i-1}$' тоді це рівняння має вигляд
![](https://i.imgur.com/oSbhoVo.png)

де <img src="https://i.imgur.com/UaBOJ37.png" style="zoom:67%;" /> - деякі коефіцієнти. 3 8 маємо:
![](https://i.imgur.com/oUXtLYV.png)

Підставляючи цей вираз в рівняння 4 отримаємо:
![](https://i.imgur.com/D0VQ5Kf.png)

Порівнюючи 8 і 9 отримаємо для визначення с1 і d1 рекурентні формули
![](https://i.imgur.com/fB63dxt.png)

Визначимо окремо c0,d0 з першої крайової умови 6 отримаємо
![](https://i.imgur.com/f4s8Edc.png)

З іншого боку з формули 8 при i=0 маємо
![](https://i.imgur.com/63Mt4Zg.png)

Порівнюючи два останні рівняння знаходимо:
![](https://i.imgur.com/OUIjNXF.png)

На основі формул 10 11 послідовно визначаються коефіцієнти 
![](https://i.imgur.com/Ep0xs4K.png)

(прямим ходом)

## Зворотний хід

починається з визначення $y_n$
Використовуючи другу крайову умову 6 і формулу 8 при i=n-1 отримаємо систему двох рівнянь
![](https://i.imgur.com/jUKhyQy.png)

Розв'язуючу її відносно $y_n$, будемо мати
![](https://i.imgur.com/4NFf4Iy.png)

Тепер за формулою 8 послідовно знайдемо 
![](https://i.imgur.com/eAxsKL5.png)

Для найпростіших крайових умов
![](https://i.imgur.com/qrbjD9m.png)

Формулм для $c_0,d_0,y_0,y_n$ спрощуються
Дійсно, якщо ![](https://i.imgur.com/iXD7GND.png) з формул 12 маємо:
![](https://i.imgur.com/HRMBBYu.png)

Треба відмітити, що метод прогонки має стійкий обчислюваний алгоритм і похибки округлень не викликають нескінченного зростання похибки рішення

## Приклад

Методом прогонки знайти розв'язок крайової задачі
![](https://i.imgur.com/iPe3hAE.png)

**Рішення**

Візьмемо h=0.1, перейдемо від рівняння 17 до кінцеворізницевого аналого:
![](https://i.imgur.com/O2koXqd.png)

Згідно формули 15 маємо <img src="https://i.imgur.com/MuysPjd.png" style="zoom:50%;" />

# 24.05.22

# Лінійна прогонка із застосуванням спеціальної функції

Розглянемо лінійне диференціальне рівняння
$$
y^{\prime \prime}+p(x) y^{\prime}+q(x) y=f(x)\tag{1}
$$


З найпростішими крайовими умовами
$$
\tag{2}y(a)=A ; \quad y^{\prime}(b)=B
$$


Введемо спеціальну функцію вигляду:
$$
\tag{3}y^{\prime}=\tau(x) y+S(x)
$$
Де $\tau(x);s(x)$  - деякі неперервні функції на [a,b] Нехай $\tau(x);s(x)$  також неперервно диференційовані на [a,b]
Продиференціюємо 3, отримаємо 
$$
\begin{aligned}
y^{\prime \prime} &=r^{\prime} y+r y^{\prime}+s^{\prime} \\
r &=r(x), r^{\prime}=r^{\prime}(x), s^{\prime}=s^{\prime}(x)
\end{aligned}\tag{4}
$$
Підставимо замість $y'$ вираз 3:
$$
y^{\prime \prime}=r^{\prime} y+r(r y+s)+s^{\prime}=y\left(r+r^{2}\right)+r s+s^{\prime} \quad(s)\tag{5}
$$


Рівність 5 означає, що $y''(x)$​ розкладено в рід по степеням розв'язку $y(x)$​
З 1 маємо:
$$
y^{\prime \prime}=-p y^{\prime}-q y+f\tag{6}
$$
Замінемо в 6 $y'$ виразом 3:
$$
\begin{aligned}
&y^{\prime \prime}=-p(r y+s)-q y+f= \\
&=y(-p r-q)-p s+f
\end{aligned}\tag{7}
$$


Порівняємо розкладення 5 і 7
Прирівнюючи коефіцієнти при однакових степенях у маємо систему:
$$
\left\{\begin{array}{l}
r s+s^{\prime}=-p s+f \\
r^{\prime}+r^{2}=-p r-q
\end{array}\right.\tag{8}
$$


Тобто отримали систему двох диференціальних рівнянь першого порядку відносно $\tau(x)$​ і $s(x)$:
$$
\left\{\begin{array}{l}
s^{\prime}+s(r+p)-f=0 \\
r^{\prime}+r(r+p)+q=0
\end{array}\right.\tag{9}
$$


З крайових умов 2 отримаємо початкові умови для інтегрування системи 9 для $x=b$ з 3 отримаємо:

$y^{\prime}(b)=r(b) y(b)+S(b) .$

Оскільки $y(b)$ невідоме, покладемо 
$$
\tag{10}r(b)=0
$$
Тоді:
$$
S(b)=y^{\prime}(B)=B\tag{11}
$$


Таким чином отримали початкові умови для інтегрування системи 9 в **зворотному часі**
$$
r(b)=0 ; \quad S(b)=B\tag{12}
$$
Інтегруючи систему 9 від $x=b$​ до $x=a$​ з кроком h вибраним чисельним методом, отримаємо значення $\tau(a),s(a)$​
Тепер запишемо початкове рівняння 1 в формі Коші
$$
\left\{\begin{array}{l}
y^{\prime}=z \\
z^{\prime}=-p z-q y+f
\end{array}\right.\tag{13}
$$


З виразу 3 отримаємо другу початкову умову для інтегрування системи 13

 $\begin{aligned}
&y^{\prime}(a)=r(a) y(a)+s(a)= \\
&=r(a) \cdot A+s(a) .
\end{aligned}$

Виконаємо інтегрування системи 13 з початковими умовами
$$
y(a)=A, \quad y^{\prime}(a)=z(a)=A r(a)+S(a)
$$
Від $x=a$ до $x=b$ і тим самим розв'яжемо початкову крайову задачу.
Таким чином крайова задача звелася до двох задач з початковими умовами (задач Коші). При цьому інтегрування системи 9 в зворотному напрямку можна інтерпретувати, як зворотню прогонку, а інтегрування системи 13 - як пряму прогонку

## P.S

В деяких випадках процес інтегрування системи 9 може бути нестійким.
тоді можна пропонувати інший зв'язок між $y(x)$ і $y'(x)$, а саме:
![](https://i.imgur.com/hREAkbB.png)

Розглянемо процес лінійної прогонки для цього випадку. Диференціюєсо 14:
![](https://i.imgur.com/avEADg7.png)

Розв'яжемо 15 відносно старшої похідної
![](https://i.imgur.com/rtleimn.png)

Скористаємося виразом 6, підставивши в нього замість у вираз 14
![](https://i.imgur.com/WVRHTOp.png)

Вирази 16 і 17 - це розкладання функції $y''(x)$ в ряд по степеням $y'(x)$ прирівнюючи коефіцієнти при однакових степенях, маємо:
![](https://i.imgur.com/pej7Zyb.png)

Отже, маємо систему диференціальних рівнянь
![](https://i.imgur.com/Sl6jmvX.png)

Отримаємо початкові умови для інтегрування системи 18 з урахуванням вигляду крайових умов 2 і спеціальної функції 14:
![](https://i.imgur.com/UXuVLny.png)

Оскільки $y'(a) $ - невідоме, покладемо коефіцієнт при $y'(a)$

![](https://i.imgur.com/yoLa3YZ.png)

Отже інтегруємо систему 13 з початковими умовами 20 21 від $x=1$ до $x=b$ з кроком h, і в результаті знайдемо $\tau(b)$ і $s(b)$
Тепер можна знайти другу початкову умови для інтегрування системи 13:
![](https://i.imgur.com/E6OIqrB.png)

Інтегрування системи 13 здійснюємо в **зворотному часі** від $x=b$ до $x=a$ з кроком h і отримаємо розв'язок початкової крайової задачі.

## Приклад застосування методу прогонки з використанням спеціальної функції

Знайти розв'язок диференціального рівняння
![](https://i.imgur.com/ioISzD1.png)
З крайовими умовами
![](https://i.imgur.com/JpwbNNX.png)
На інтервалі $x\in[0,\frac{1}{2}]$ з кроком 0.1
Введемо спеціальну функцію
![](https://i.imgur.com/9BmPNvZ.png)

Оскільки $y(1/2)$ невідоме, то покладемо $\tau(1/2)=0$, тоді з 2 отримаємо:
![](https://i.imgur.com/6WvUFg1.png)

З 3 маємо:
![](https://i.imgur.com/uuwt0je.png)

Записуємо диференціальні рівняння відносно $\tau(x)$ і $s(x)$. Вони мають вигляд:
![](https://i.imgur.com/UQ4QQwJ.png)

Початкові умови для інтегрування системи 5:
![](https://i.imgur.com/SDflD9y.png)

Використаємо для інтегрування метод Ейлера. Результати представлені в табл 1. Інтегрування відбувається в зворотньому часі від х=0.5 до х=0 з кроком h=-0.1
![](https://i.imgur.com/L46CNZP.png)

Табл1

Робочі формули метода Ейлера для системи 5:
![](https://i.imgur.com/sG8aBps.png)

В таблиці позначено:
![](https://i.imgur.com/QvpGvHr.png)

Після інтегрування отримали:
![](https://i.imgur.com/gAGzbbI.png)

Тепер з 2 можна визначити 
![](https://i.imgur.com/dqQWw5q.png)

Це - друга початкова умова для інтегрування рівняння 1 від х=0 до х=0.5 з кроком h=0.1. Перша початкова умова $y(0)=1$
Інтегруємо рівняння 1 у вигляді системи:

![](https://i.imgur.com/UB58CPP.png)

Використаємо метод Ейлера. Результати представлені в табл. Робочі формули метода Ейлера для системи 7
![](https://i.imgur.com/JfjL7BL.png)

Позначимо:
![](https://i.imgur.com/uH8IMmI.png)

![](https://i.imgur.com/g66oL1t.png)

Табл 2 

$Z_n=z(0)=y'(0)=4.257$

Отже отримали розв'язок крайової задачі який представлений другим та третім стовпчиками табл2

#### Перевірка розв'язку

Крайова умова $y(0.5)=0.5$ не виконана, бо отримали $y(0.5)=0.019$. Похибка обумовлена вибраним методом першого порядку і великим кроком чисельного інтегрування.

# Метод стрільби (балістичний) для систем диференціальних рівнянь

 

​     Ще один спосіб зведення крайової задачі до задач Коші дає так званий балістичний метод, або метод стрільби.

​     Розглянемо крайову задачу для системи двох диференціальних рівнянь першого порядку з нелінійними крайовими умовами:
$$
\begin{aligned}
&u^{\prime}(x)=f_{1}(x, u, v), \\
&v^{\prime}(x)=f_{2}(x, u, v)
\end{aligned} \quad x \in(a, b)\tag{5.1}
$$

$$
\varphi[u(a), v(a)]=0, \quad \psi[u(b), v(b)]=0\tag{5.2}
$$

​     Виберемо довільне значення  $u(a)=\eta$  і розглядатимемо першу з крайових умов (5.2) як алгебраїчне рівняння  $\varphi[\eta, v(a)]=0$ звідки визначимо $v(a)=\zeta(\eta)$  Візьмемо значення $u(a)=\eta, v(a)=\xi$, за початкові умови задачі Коші для системи (5.1). Зінтегрувавши цю задачу, одержимо розв’язок, залежний від параметра: $u=u(x, \eta), \quad v=v(x, \eta)$   Знайдений розв’язок справджує першу з крайових умов (5.2), але, взагалі кажучи, не справджуватиме другу з цих умов.

​     Отже, параметр η слід підібрати таким чином, щоб
$$
\bar{\psi}(\eta) \equiv \psi[u(b, \eta), v(b, \eta)]=0\tag{5.3}
$$
Знайти корінь алгебраїчного рівняння (5.3) можна різними наближеними методами.

## Метод дихотомії.

 Робимо «пробні постріли» – розрахунки з довільним чином вибраними значеннями $\eta_i$  допоки серед величин $\overline{\psi}(\eta_i)$  не буде різних за знаком. Пара відповідних їм значень параметра $\eta_i$  та $\eta_{i+1}$  утворять першу «вилку», в межах якої міститься корінь рівняння (5.3). Поділяючи «вилку» послідовно навпіл до одержання потрібної точності, здійснюємо «пристрілку» параметра η. Саме завдяки цьому процесу метод і одержав назву методу стрільби.

​     Однак знаходження кожного нового значення функції $\bar{\psi}(\eta)$  вимагає числового інтегрування системи (5.1), тобто є досить громіздким. Тому для відшукання кореня рівняння (5.3) доцільно застосовувати більш швидкі методи.

## Метод січних.

Перші два «постріли» $\eta_0$ та $\eta_1$ робимо навмання, а наступні значення обчислюємо згідно з формулою січних:
$$
\eta_{i+1}=\eta_{i}-\frac{\left(\eta_{i}-\eta_{i-1}\right) \bar{\psi}\left(\eta_{i}\right)}{\bar{\psi}\left(\eta_{i}\right)-\bar{\psi}\left(\eta_{i-1}\right)}, \quad i=1,2, \ldots\tag{5.4}
$$
​     Можна використовувати й інші подібні методи.

​     Особливо просто за допомогою методу стрільби розв’язуються лінійні крайові задачі. Справді, нехай задача (5.1),(5.2) є лінійною, тобто має вигляд
$$
\begin{aligned}
&u^{\prime}(x)=p_{1}(x) u+q_{1}(x) v+r_{1}(x) \\
&v^{\prime}(x)=p_{2}(x) u+q_{2}(x) v+r_{2}(x),\\
&x\in (a,b)
\end{aligned}\tag{5.5}
$$
​     
$$
\alpha_{1} u(a)+\beta_{1} v(a)=\gamma_{1}, \quad \alpha_{2} u(a)+\beta_{2} v(a)=\gamma_{2}\tag{5.6}
$$
​     Тоді початковими значеннями відповідної задачі Коші будуть
$$
u(a)=\eta, \quad v(a)=\xi \equiv \beta_{1}^{-1}\left(\gamma_{1}-\alpha_{1} \eta\right)\tag{5.7}
$$
​     Легко бачити, що розв’язок задачі Коші (5.5),(5.7) лінійно залежатиме від параметра η, тому функція $\bar{\psi}(\eta)$  також буде лінійною. Але лінійна функція одного аргументу цілком визначається своїми значеннями в довільних двох точках $\eta_0$  і $\eta_1$ , а її графіком є пряма, тобто вона співпадає зі своєю січною. Тому знайдене за формулою (5.4) значення $\eta_2$  є точним коренем рівняння (5.3), тобто розрахунок із цим значенням дає шуканий розв’язок крайової задачі (5.5),(5.6). Отже, для розв’язання лінійної крайової задачі достатньо трикратного інтегрування задач Коші. 

​     Зауважимо, що для лінійних задач можна суттєво зменшити обсяг роз-рахунків, врахувавши структуру загального розв’язку системи (5.5). Як відомо з курсу звичайних диференціальних рівнянь, загальний розв’язок лінійної неод-норідної системи рівний сумі загального розв’язку відповідної однорідної системи та деякого частинного розв’язку неоднорідної системи.

​     Знайдемо частинний розв’язок системи (5.5), що відповідає значенню $\eta_0=0$  і позначимо його через $u_0(x),v_0(x)$   Розглянемо задачу Коші для відповідної однорідної системи вигляду
$$
\begin{gathered}
u^{\prime}(x)=p_{1}(x) u+q_{1}(x) v, \quad x \in(a, b) ; \\
v^{\prime}(x)=p_{2}(x) u+q_{2}(x) v, \\
u(a)=\eta_{1}=1, \quad v(a)=-\alpha_{1} \beta_{1}^{-1}
\end{gathered}
$$
знайдемо її розв’язок і позначимо його через $u_1(x),v_1(x)$   Тоді загальним розв’язком неоднорідної системи, який справджуватиме першу з крайових умов (5.6), буде однопараметрична сім’я вигляду
$$
u(x)=u_{0}(x)+C u_{1}(x), \quad v(x)=v_{0}(x)+C v_{1}(x)\tag{5.8}
$$
​     Значення параметра *С* знаходимо з другої з крайових умов (5.6):
$$
C=-\frac{\alpha_{2} u_{0}(b)+\beta_{2} v_{0}(b)-\gamma_{2}}{\alpha_{2} u_{1}(b)+\beta_{2} v_{1}(b)} .
$$
​     Підклавши знайдене значення *С* в (5.8), одержимо розв’язок крайової задачі (5.5),(5.6).

​     Метод стрільби є простим і успішно застосовним до більшості крайових задач типу (5.1),(5.2), а також до звичайних диференціальних рівнянь: адже, як відомо, будь-яке диференціальне рівняння *п*-го порядку можна звести до системи *п* рівнянь першого порядку. Труднощі виникають тоді, коли крайова задача (5.1),(5.2) добре обумовлена, а відповідна їй задача Коші погано обумов-лена. При цьому чисельне інтегрування задачі Коші визначає функцію $\bar{\psi}(\eta)$ з великою похибкою, що ускладнює організацію ітерацій. У такому випадку пробують задавати початкові умови на правому кінці заданого проміжку $x=b$  і інтегрувати справа наліво; нерідко при цьому стійкість схем покращується. Якщо й це не допомагає, то таку крайову задачу слід розв’язувати або спеціаль-ними, або різницевими методами.

 

### ПРИКЛАД

 За допомогою методу стрільби знайти розв’язок крайової задачі:
$$
y^{\prime \prime}-2 x^{-2} y=2 x^{-1}, \quad x \in(1 ; 2)\tag{5.9}
$$

$$
9 y(1)-5 y^{\prime}(1)=0, \quad y(2)-y^{\prime}(2)+1=0\tag{5.10}
$$

#### Розв’язання

 Задача (5.9),(5.10) є лінійною, тому згідно з алгоритмом методу стрільби для відшукання її розв’язку достатньо інтегрування трьох задач Коші для рівняння (5.9) з початковими умовами $y(1)=\eta_i,y'91)=-1.8\eta_i,i=0,2,..$   ; тут значення похідної в точці $x=1$ визначені з першої з крайових умов (5.10). Перші два «постріли» $\eta_0$  та $\eta_1$  робимо навмання, беручи довільні два числа, а значення $\eta_2$  обчислюємо за формулою січних (5.4), в якій з урахуванням другої з крайових умов (5.10) слід узяти 
$\bar{\psi}(\eta_i)=y_i(2)-y'_i(2)=1$ де $y_i(x)$  – розв’язок задачі Коші для рівняння (5.9) з параметром $\eta_i$ 

​     Нехай зроблені «постріли», наприклад, $\eta_0=5,\eta-1=0$ Зінтегрувавши рівняння (5.9) спершу при початкових умовах $y_0(1)=5,y'_0(1)=9$  і вдруге – при початкових умовах$y_1(1)=0,y'_1(1)=0$   одержимо розв’язки відповідних задач Коші: 
$$
y_{0}(x)=\frac{2}{3}\left(8 x^{2}+x^{-1}\right)-x, \quad y_{1}(x)=\frac{1}{3}\left(2 x^{2}+x^{-1}\right)-x
$$
  Тоді згідно з формулою січних (5.4)
$$
\eta_{2}=\eta_{1}-\frac{\left(\eta_{1}-\eta_{0}\right) \bar{\psi}\left(\eta_{1}\right)}{\bar{\psi}\left(\eta_{1}\right)-\bar{\psi}\left(\eta_{0}\right)}=\frac{5\left(y_{1}(2)-y_{1}^{\prime}(2)+1\right)}{y_{1}(2)-y_{1}^{\prime}(2)+1-\left(y_{0}(2)-y_{0}^{\prime}(2)+1\right)}\tag{5.11}
$$
​     Підклавши в (5.11) знайдені функції $y_0(x)$  та $y_1(x)$  одержимо значення $\eta_2=-5$  Зінтегрувавши рівняння (5.9) втретє, цього разу при початкових умовах $y_2(1)=-5,y'_2(1)=-9$  одержимо розв’язок відповідної задачі Коші
$$
y_{2}(x)=-x(4 x+1)\tag{5.12}
$$
який згідно з алгоритмом методу стрільби для лінійних крайових задач повинен бути розв’язком крайової задачі (5.9),(5.10). Безпосереднім підкладанням легко переконатися, що функція (5.12) дійсно справджує обидві крайові умови з (5.10). Отже, розв’язок крайової задачі (5.9),(5.10) $y(x) \equiv y_{2}(x)=-x(4 x+1)$ 
