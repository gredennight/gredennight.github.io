# [На главную](./index.html)

# Генадій Юрійович Мартиненко

# 10.02.22 Принципи організації баз даних і СУБД

Запись: https://youtu.be/osxnfQ12tao

## 1. Традиційні файлові системи

Попередниками баз даних є файлові системи. Це набір прикладних програм, які виконують для користувачів деякі операції.
Недолік - кожна програма зберігає свої власні дані і керує ними.

### Обмеження файлової системи:

     1. Поділ і ізоляція даних
     2. Дублювання даних
     3. залежність від даних
     4. несумісність файлів
     5. фіксовані запити

## 2. Бази даних

Новий підхід - використання бази даних (БД) або Database (DB) і системи управління базами даних (СУБД) або Database Managment System (DBMS)

<u>База даних</u> - спільно використовуваний набір логічно пов'язаних даних (і опис цих даних), призначений для задоволення інформаційних потреб.

База даних - єдине велике сховище даних, яке одноразово визначається а потім використовується одночасно багатьма користувачами. Базу даних також називають набором інтегрованих записів з самоописом.
В сукупності опис даних називається системним каталогом або словником даних, а самі елементи опису називаються мета-даними, тобто даними про дані.

Наявність самоопису даних в БД забезпечує в ній незалежність програм від даних (Program Data independence).

Поняття **<u>логічно пов'язаний</u>** означає, що при аналізі інформаційних потреб виділяють сутності, атрибути і зв'язки.

**<u>Сутністю</u>** (entity) називається окремий тип об'єкта (людина, місце або річ, поняття або подія), який потрібно представити у БД.

**<u>Атрибутом</u>** (Attribute) називається властивість, яка описує деяку характеристику даного об'єкта.

**<u>Зв'язок</u>** (Relationship) - це те, що об'єднує кілька сутностей.

## 3. Системи управління базами даних.

СУБД - це програмне забезпечення, за допомогою якого користувач можуть викликати, створювати, підтримувати БД і здійснювати контрольований доступ до неї:

### Можливості СУБД:

1. Створення БД - за допомогою мови визначення даних (DDL - Data Definition Language)
2. Вставка, оновлення, видалення і здобування інформації з БД - за допомогою мови маніпулювання даними (DML - Data Manipulation Language), з використанням мови структурованих запитів (SQL - Strucktured Query Language).

### Основні компоненти середовища СУБД

1. Апаратне забезпечення

2. Програмне забезпечення

3. Дані

4. Процедури

5. Користувачі

6. Адміністратори даних і БД - відповідає за управління даними, включаючи планування в БД, розробку і супровід стандартів, прикладних алгоритмів і процедур, концептуальне і логічне проектування БД.

7. Розробники логічної і фізичної БД - перші з них займаються ідентифікацією БД, тобто сутностей їх атрибутів, зв'язків між даними і встановлюють обмеження на збережені дані, а його робота поділяється на два етапи:

   1. #### Концептуальне проектування БД

      яке абсолютно не залежить від конкретної цільової СУБД, мов програм, або інших фізичних характеристик.

   2. #### Логіне проектування бази даних

      яке проводиться з урахуванням особливостей обраної моделі даних.

      Розробник фізичної БД отримує готову логічну модель даних і займається її фізичною реалізацією.

8. Прикладні програмісти - розробляють додатки, що надають функціональні можливості

9. Кінцеві користувачі

## 4. Рівні опису Елементів даних

![image-20220330122131984](https://s2.loli.net/2022/03/30/a1v2xVKzQILgGHm.png)

### <u>**Зовнішній рівень**</u>

 описує ту частину бази даних, яка відноситься до кожного користувача і складається з декількох різних зовнішніх уявлень баз даних.

### **<u>Концептуальний рівень</u>**

описує те, які дані зберігаються в БД, а також зв'язки між ними. Він містить структуру:

1. Всі сутності, їх атрибути та зв'язки.
2. Обмеження, що накладаються на дані.
3. Семантична інформація про дані.
4. Інформація про безпеку і цілісність даних.

### **<u>Внутрішній рівень</u>**

фізичне подання БД у ПК

### <u>**Фізичний рівень**</u>

контролюється ОС, але під керування СУБД.

## 5. Моделі даних

### Категорії моделей даних

**<u>Модель даних</u>** - це інтегрований набір понять для опису та оброблення даних, зв'язків між ними та обмежень, що накладаються на дані.

Модель є зображення реального світу, об'єктів і подій, а також існуючих між ними моделей зв'язків. 
Мета побудови моделі даних полягає у поданні даних у зрозумілому вигляді.

### Існують 3 пов'язані моделі даних:

1. Зовнішня модель - предметна область

2. Концептуальна модель - логічне представлення

3. Внутрішня - використання цільової СУБД

4. об'єктні моделі

   1. модель типу "сутність - зв'язок"
   2. семантична
   3. функціональна
   4. об'єктно орієнтована

5. Моделі на основі записів

   1. реляційна
   2. мережева
   3. ієрархічна

6. Фізичні моделі даних

   1. узагальнююча модель
   2. модель пам'яті кадрів

## 6. Життєвий цикл додатка БД

### Етапи:

1. Планування розробки БД
2. Визначення вимог системи
3. Збір і аналіз вимог користувачів
4. Проектування БД
5. Вибір цільової СУБД
6. Розробка додатків
7. Реалізація
8. Перетворення і завантаження даних
9. Тестування
10. Експлуатація та супровід.

### Підходи до проектування БД:

1. Висхідний - від властивостей, сутностей і зв'язків до відношень, призначений для проектування простих БД.
2. Низхідний - від моделей з високорівневими сутностями і зв'язками до подальшого низхідного уточнення

### Основні етапи проектування бази даних:

1. Концептуальне - процес створення моделі інформації, незалежної від будь-яких фізичних аспектів її подання.
2. Логічне - процес створення моделі інформації на основі обраної моделі організації даних, без урахування типу цільової СУБД і фізичних аспектів реалізації.
   Мета: створення логічної моделі даних на основі, наприклад, реляційної моделі.
3. Фізичне - використовується з використання конкретної СУБД

## 7. Реляційна модель даних

### Поняття реляційної моделі:

1. Відношення (таблиця)
2. Атрибут (стовпець)
3. Кортеж (рядок)

У реляційній моделі все дані логічно структуровані всередині відношення (таблиці)
Кожне відношення має ім'я і складається з іменованих атрибутів (стовпців).
Кожен кортеж (рядок) даних містить по одному значенню кожного з атрибутів

Реляційна модель заснована на математичному понятті відношення, елементах теорії множин і реляційній алгебрі.

# 17.02.22 Реляційна модель даних

## ссылка:

https://youtu.be/93RgXhDbLKA

## Реляційна модель даних

описує які дані можуть зберігатися в базах даних а також способи маніпулювання такими даними. У спрощеному вигляді основна ідея реляційної моделі полягає в тому, що дані повинні зберігатися в таблицях і тільки в таблицях.

<u>Класична реляційна модель даних</u> вимагає щоб дані зберігалися в так званих плоских таблицях.

## Плоска таблиця

таблиця, кожна комірка якої може бути однозначно ідентифікована зазначенням рядка та стовпця таблиці, а в одному стовпці всі комірки повинні містити дані одного простого типу.

На <u>найнижчому рівні опису</u> (теорії множин)використовується 3 основних поняття:

1. множина
2. підмножина декартового добутку
3. кортеж

На наступному рівні (реляційної моделі) їм відповідають:

1. домен
2. відношення
3. кортеж

На верхньому третьому рівні (рівні стандарту SQL і конкретних реалізацій) їм відповідають терміни:

1. тип даних
2. таблиця
3. рядок таблиці

## Елементи теорії множин

<u>Множину</u> можна уявити собі як с<u>укупність елементів, що мають деяку загальну властивість</u>. Для того щоб деяку сукупність елементів можна було назвати множиною, <u>необхідно, щоб виконувалися</u> **дві умови**:

1. Має існувати правило, що дозволяє визначити чи належить вказаний елемент сукупності.
2. Має існувати правило, що дозволяє відрізняти елементи один від одного. 

А це означає, що множина не може містити двох однакових елементів. І це є головною властивістю множини.

Множини (зазвичай позначаються великими літерами латинського алфавіту):

1. елемент х належить множині А: х є А
2. множина В є підмножиною множини А: <img src="https://s2.loli.net/2022/03/30/OJTgzi5cvrw7Z6n.png" alt="image-20220330122234248" style="zoom:67%;" />
3. Підмножина В множина А називається власною підмножиною якщо: <img src="https://s2.loli.net/2022/03/30/XsZTGNwziBf934m.png" alt="image-20220330122256929" style="zoom:67%;" />

### Операції над множинами:

Def 1.об'єднання <img src="https://s2.loli.net/2022/03/30/KXnGYmelqMxOTk9.png" alt="image-20220330122314957" style="zoom:67%;" />

Def 2. перетин <img src="https://s2.loli.net/2022/03/30/DCHuKYZNUyTI2P4.png" alt="image-20220330122334076" style="zoom:67%;" />

Def 3. Різниця <img src="https://s2.loli.net/2022/03/30/QBMPvI7Sa1oUEcN.png" alt="image-20220330122353353" style="zoom:67%;" />

Доповнення множини А: <img src="https://s2.loli.net/2022/03/30/OtcVHAUFlWEKmLz.png" alt="image-20220330122412424" style="zoom:67%;" />

### Декартів добуток множин:

Упорядкована пара: (a,b), де<img src="https://s2.loli.net/2022/03/30/hv65ZXYrzAx3tGe.png" alt="image-20220330122433314" style="zoom:67%;" />
Рівність (a,b)=(c,d), означає що а=с і b=d.

Упорядкована n-ка, набір або кортеж:
(а1,а2,...аn), де <img src="https://s2.loli.net/2022/03/30/kqTWQ3wbiRe6amu.png" alt="image-20220330122502503" style="zoom:67%;" />

Def 4. Декартів (прямий) добуток множин <img src="https://s2.loli.net/2022/03/30/coMgJkhs5EAKqZr.png" alt="image-20220330122522777" style="zoom:67%;" /> - це множина упорядкованих n-ок <img src="https://s2.loli.net/2022/03/30/se4ZqpcIXKYvydG.png" alt="image-20220330122542346" style="zoom:67%;" />

Def 5. Степінь декартового добутку<img src="https://s2.loli.net/2022/03/30/B8cXKtvmz6qNQaT.png" alt="image-20220330122620736" style="zoom:67%;" /> - це число множин n.

Якщо всі множини Аi однакові, то використовують позначення: <img src="https://s2.loli.net/2022/03/30/IwTy1LKXrpAYNhB.png" alt="image-20220330122643353" style="zoom:67%;" />

Декартів добуток множин є одним із способів конструювання нових ооб'єктів з уже наявних  множин, тому що створює всілякі перебори.

#### Наприклад,

дано множини A={1,2,3}; B={4,5,6}.
Тоді AxB:     

(1,4) (2,5) (3,6) 
(1,5) (1,6)
(2,4) (2,6)
(3,4) (3,5)
Всього 3*3=9 переборів.

### Відношення:

Def 6. Відношення ступеня n (n-арне відношення) - це підмножина R декартова добутку множин ![image-20220330122706596](https://s2.loli.net/2022/03/30/rqMeZCadtS5VAoD.png)

Def 7. Потужність відношень R - це потужність множин кортежів, що входять у відношення R.

#### Приклад:

{(1,"Іванов",1000), (2,"Петров",2000), (3,"Сидоров",3000)} - відношення,
{(1),(1,2),(1,2,3)} - множина з різнотипних числових кортежів. 

### Нетривіальність поняття відношення, степінь якого більше 1 полягає в двох моментах:

1. Всі елементи відношення є однотипні кортежі. Однотипність кортежів дозволяє вважати їх аналогами рядків в простій таблиці. Тобто в такій таблиці, в якій всі рядки складаються з однакового числа комірок і в відповідних комірках містяться однакові типи даних.

   Наприклад:
   ![image-20220330122730183](https://s2.loli.net/2022/03/30/nvFm1OjCLrYhofA.png)

2. За винятком крайнього випадку, коли відношенням є сам декартів добуток А1хА2хАn, відношення включає в себе не всі можливі кортежі з декартова добутку. 
   Це означає, що для кожного відношення є критерій, що дозволяє визначити які кортежі входять у відношення, а які ні. Цей критерій по суті визначає сенс або семантику відношення. Дійсно кожному відношенню можна поставити у відповідність деякий логічний вираз, що залежить від n параметрів, котрий визначає чи буде саме цей кортеж належати відношенню R.

### Предикат:

Цей логічний вираз P(x1,x2,...,xn) називають предикатом відношення R.
Кортеж (а1,а2,...,аn) належить відношенню R тоді і тільки тоді, коли
P(x1,x2,...,xn)=істина

#### Приклади відношень:

1. Бінарні відношення або відношення степеню 2 (відношення, що задані декартовом добутку двох множин А1хА2).
2. n-арні відношення або відношення степеню n (відношення, задані декартовом добутку більш ніж двох множин).

#### Приклад (університет):

У деякому університеті на математичному факультеті навчаються студенти Іванов, Петров, Сидоров. Лекції їм читають викладачі Антонов, Михайлов, Ніколаєв, причому відомі такі факти:

1. Антонов читає лекції з алгебри і баз даних відповідно 40 і 80 годин семестру.
2. Михайлов читає лекції з геометрії 50 годин в семестр.
3. Ніколаєв читає лекції з алгебри і геометрії відповідно 40 і 50 годин в семестр.
4. Студент Іванов відвідує лекції з алгебри у Ніколаєва і з БД у Антонова.
5. Студент Петров відвідує лекції з алгебри у Антонова, і з геометрії у Михайлова.
6. Студент Сидоров відвідує лекції з геометрії у Михайлова і з БД у Антонова.

Предметна область - університет
Треба зберігати - факультет, викладачі, часи, т.д.

Щоб формально описати ситуацію введемо три множини:

1. множина викладачів А= {Антонов, Михайлов, Ніколаєв}
2. множина предметів В={Алгебра, Геометрів, БД}
3. множина студентів С={Іванов, Петров, Сидоров}

Наявні факти можна розділити на 2 групи:

1. група (факти 1-3) - факти про викладачів
2. група (4-6) - факти про студентів

щоб відобразити факти 1-3 (що характеризують викладачів і лекції, які вони читають), введемо відношення R1, на декартовому добутку AxBxQ, де Q - множина раціональних чисел.

Упорядкована трійка xyn належить відношенню R1 тоді і тільки тоді, коли викладач х читає лекції з предмету в кількості n годин в семестр. Це є предикат відношення R1.

Назвемо таке відношення "Читає лекції по...", а множину кортежів, що утворюють відношення R1, представимо у зручному вигляді, а саме у вигляді таблиці: 
![image-20220330122752300](https://s2.loli.net/2022/03/30/DetgCQFbd9W2Ryi.png)

Відношення це не таблиця, але його можна представити у вигляді таблиці.

Щоб відобразити факти 4-6 введемо відношення R2 на декартовому  добутку CxBxA.
упорядкована трійка (zyx) - належить відношенню R2 тоді і тільки тоді, коли студент z відвідує лекції з предмету y у викладача х. Назвемо це відношення "Відвідувати лекції" і представимо у вигляді таблиці:
![image-20220330122811489](https://s2.loli.net/2022/03/30/JVLg6FAsemyctw7.png)

Відношення R2 задано на декартовому добутку![image-20220330122827787](https://s2.loli.net/2022/03/30/ECF7lsBjqKO81mx.png)

$\Omega$ можна назвати "Студенти-Лекції-Викладачі" 

Множина $\Omega$ - це сукупність всіх можливих варіантів відвідування студентами лекцій.

Відношення R2 - це поточний стан, що є змінним в часі відношення.

Використання табличної форми для візуалізації відношень можливо  оскільки:

1. Всі використовувані множини є скінченні.
2. При додаванні або видаленні студентів, предметів або викладачів просто додаються або видаляються відповідні рядки в таблиці.

#### Зауваження:

1. Не будь-який рядок можна додати в таблицю "Відвідувати лекції", а саме не можна додати два однакових рядки, оскільки таблиця зображує відношення R2, а у відношенні, як і у будь-якій множині не може бути двох однакових елементів.
   Це приклад <u>синтаксичного обмеження</u>.
2. В таблицю "Відвідувати лекції" не можна додати кортеж. 
   Не можна додати Іванов-Геометрія-Антонов, оскільки Антонов не читає предмет Геометрія. Це випливає з таблиці, яка представляє відношення R1. Таким чином таблиці істотно пов'язані одна з одною.
   Це приклад <u>семантичного обмеження</u>.

## Транзитивне замикання відношень:

Def 8. Нехай відношення R задано на декартовому квадраті $A^2$ деякої множини А.

Транзитивне замикання відношення R - це нове відношення, що складається з кортежів (х,у) для яких виконується:

1. або кортеж (х,у)єR
2. або знайдеться скінчена послідовність елементів z1,z2,...,zn є А, що всі кортежі (х,z1), (z1,z2), .... , (zn,y) належить відношенню R.

### Приклад:

Множина деталей і конструкцій А={Болт, Гайка, Двигун, Колесо, Вісь}.

![image-20220330123045827](https://s2.loli.net/2022/03/30/UihGQJBH1Psme4L.png)

# 31.03.22 Реляційна модель даних

## ссылка

https://youtu.be/vG0dx6vZsMc

## Реляційна модель даних складається з 3х частин:

### 1. Структурна частина

​	описує які об'єкти розглядаються реляційною моделлю. Постулюється що єдиною структурою даних, яка використовується в реляційній моделі є нормалізовані n-арні відношення (визначені на n множинах).

### 2. цілісна частина

​	описує обмеження спеціального види, які повинні виконуватися для будь-яких відношень в будь яких реляційних базах даних. це цілісність сутностей, цілісність зовнішніх ключей.

### 3. маніпуляційна частина

​	описує два еквівалентних способи маніпулювання реляційними даними. це реляційна алгебра і реляційне числення.

## 4. Структурна частина реляційної моделі

Реляційна модель вимагає, щоб типи використовуваних даних були простими.

### Типи даних

як правило типи даних діляться на три групи:

1. прості або атомарні типи даних не мають внутрішньої структури.
   дані такого типу називають скалярами
   До них відносяться:
   Логічний (L), строковий C, чисельний N, цілий, речовинний, дата D, час T, грошовий, перелічувальний, інтервальний
2. Структуровані типи призначені для завдання складних структур даних. Вони конструюються зі складових елементів званих компонентами, які в свою чергу можуть мати структуру.
   До них відносяться:
   Масиви, запити (структури)
3. Посилальні типи даних (вказівники) призначені для забезпечення можливості вказівки на інші дані.
   Вказівники характерні для мов процедурного типу.

#### Висновок

Для реляційної моделі даних - тип даних не важливий, а вимога, щоб він був простим означає що в реляційних операціях не повинна враховуватись внутрішня структура даних

### Домени

В реляційній моделі даних поняття "тип даних" тісно пов'язано поняття "домен", яке можна вважати уточненням типів даних

#### Домен - семантичне поняття

Домен можна розглядати як підмножину деякого типу даних, що мають певний сенс. Якщо тип даних можна вважати величиною кількості всіх можливих значень даного типу, то домен нагадує підмножину цієї множини.

#### Домен характеризується його властивостями:

- Домен має унікальне ім'я в межах бази даних
- Домен визначений на деякому простому типу данинх або на іншому домені
- Домен може мати деяку логічну умову, що дозволяє описати підмножину даних допустиму для цього домену
- Домен несе певне сенсове навантаження

##### Приклад

Домен - D сенс "Вік співробітника"
$$
D=\{n \in N: n \geq 18 \text { and } n \leq 60\}
$$
Домен створений на множині простих чисел.

#### Відмінність домену від поняттся підмножини

полягає в тому, що домен відображає семантику, визначену предметною областю.

Може бути кілька доменів які збігаються як підмножини але які мають різний сенс.

##### Приклад

Домени "вага деталі" і "наявна кількість" можна однаково описати як множину нвід'ємних простих чисел, але зміст доменів буде різним і не це будуть різні домени.
Основне значення доменів полягає в тому, що домени обмежують порівняння.
Некоректно порівнювати значення з різних доменів навіть якщо вони мають однаковий тип "ціна" і "вага".
В цьому і проявляється сенсове обмеження доменів.

###### Зауваження

1. Поняття домену допомагає правильно моделювати предметну область.
   на запит наданий вище система може дати відповідь але вона  буде безглуздою.
2. Не всі домени мають логічну умову, що обмежує можливі значення домена
   В такому випадку множина можливих значень домену збігається з множиною можливих значень типу даних
3. Не завжди очевидно як задати логічну умову що обмежую можливі значення домену.
   наприклад
   умова на строковий тип даних що задає домен "прізвище співробітника"

### Відношення, атрибути, кортежі відношень

#### Атрибут відношення

пара виду <ім'я атрибута: ім'я домену>

Імена атрибутів повинні бути унікальними в межах відношення. Часто імена атрибутів відношення збігаються з іменами відповідних доменів

#### Відношення R

визначене на множину доменів $D,D_1,...D_n$  (не обов'язково різних), містить 2 частини: **заголовок** і **тіло**

##### Заголовок

містить фіксовану кількість атрибутів $(<A_1:D_1>,<A_2:D_2>,..,<A_n,D_n>)$

##### Тіло відношення

містить множину кортежів відношення

###### Кортеж відношення

це множина пар виду $<\text{Ім'я атрибута: Значення атрибута}>:(<A_1:Val_1>,<A_2:Val_2>,..,<A_n:Val_n>)$, таких що значення $Val_i$ атрибута $A_i\in \text{домену}D_i$

#####  Степінь (або -арність) відношення

Число атрибутів у відношенні

##### Потужність відношення

потужність множини кортежів відношення

###### Зауваження:

1. Заголовок відношення описує декартів добуток доменів, на якому задано відношення. Він статичний та не змінюється під час роботи з БД.
2. Тіло відношення являє собою набір кортежів тобто підмножину декартового добутку доменів. Вона може змінюватись під час роботи з БД.

##### Позначення відношення

$$
R\left(< A_{1}: D_{1}>,<A_{2}: D_{2}>, \ldots,< A_{n}: D_{n}>)\right.
$$

або
$$
R(A_1,A_2,..,A_n)
$$
або
$$
R
$$

###### Приклад

Відношення "Співробітники" задано на доменах "Номер співробітника", "прізвище", "Зарплата","номер відділу".

Заголовок відношення
Працівники(Ns:НомерСпівробітника,F:Прізвище,Z:Зарплата, No:НомерВідділу).
Поточний стан (3кортежи): (1,Іванов,1000,1),(2,Петров,2000,2),(3,Сидоров,3000,1)

###### Поточний стан у вигляді таблиці

![image-20220331172613259](https://s2.loli.net/2022/03/31/Oc19fAsgbdmipNI.png)

#### Реляційна БД - Набір відношень

#### Схема реляційної БД - набір заголовків відношень що входять в БД

#### Відповідність реляційної і табличних БД

| База даних            | Набір таблиць            |
| --------------------- | ------------------------ |
| Схема бази даних      | Набір заголовків таблиць |
| Відношення            | Таблиця                  |
| Заголовок відношення  | Заголовок таблиці        |
| тіло відношення       | Тіло таблиці             |
| Атрибут відношення    | Найменування стовпця     |
| Кортеж відношення     | Рядок таблиці            |
| Степінь відношення    | Кількість стовпців       |
| Потужність відношення | Кількість рядків         |
| Домени і типи даних   | Типи даних в комірках    |

#### Властивості відношень (визначають відмінності між відношеннями і таблицями)

1. У відношеннях немає однакових кортежів
2. Кортежі невпорядковані (зверху вниз)
3. Атрибути не впорядковані (зліва направо)
4. Всі значення атрибутів атомарні

#### Перша нормальна форма (1НФ)

Відношення R знаходяться в 1НФ якщо:

1. Воно задовольняє  визначенню відношення
2. Його атрибути містять тільки скалярні (атомарні) значення
3. Воно є плоскою таблицею

## 5. Цілісна частина реляційної моделі (цілісність реляційних даних)

### Два обмеження будь-якої БД:

1. Цілісність сутностей
2. Цілісність зовнішніх ключей

### Null-Значення

У реальному світі часто зустрічається така ситуація коли дані невідомі або не повні. Наприклад місце проживання або дата народження. Щоб обійти проблему неповних або невідомих даних у БД можуть використовуватися типи даних заповнені Null-значеннями

Null-значення - не значення, а маркер, що показує що значення невідоме

#### Коли можлива поява невідомих або неповних значень на вибір є 2 варіанти:

1. Обмежитися використанням звичайних типів даних і не використовувати null, а заносити в комірки "адрес невідомий"
2. Використовувати null значення замість невідомих але тоді виникає проблема пов'язана з тризначною логікою (And Or Not)

<img src="https://s2.loli.net/2022/03/31/bcz9J1GuW5ty8fk.png" alt="image-20220331174810169" style="zoom:150%;" />

### Потенційні ключі

За визначенням, тіло відношення є множиною кортежів тому відношення не можуть містити однакові кортежі.
Це значить що кожен кортеж повинен мати властивість унікальності.
Насправді властивість унікальності в межах відношення можуть мати окремі атрибути або групи атрибутів, такі унікальні атрибути зручно використовувати для ідентифікації кортежів

##### Def 1

Підмножина атрибутів K відношення R називається **потенційним ключем** якщо К маж такі властивості:

1. Властивість унікальності - у відношення не може бути різних кортежів, з однаковим значенням К
2. Властивість ненадлишковості - ніяка підмножина в К не має властивість унікальності.

Будь-яке відношення має, прийманні, один потенційний ключ, але може мати і декілька. Тоді один з них оголошується **первинним**, а решта - **альтернативними**.
Потенційний ключ, що складається з одного атрибута - **простий**, з декількох - **складений**

##### **Потенційний ключ** - це семантичне поняття

Відображає зміст понять предметної області

**Відношення "Співробітники"**

| Табельний номер | Прізвище | Зарплати |
| :-------------: | -------- | -------- |
|        1        | Іванов   | 1000     |
|        2        | Петров   | 2000     |
|        3        | Сидоров  | 3000     |

Табельний номер має бути унікальним

| A    | B       | C    |
| ---- | ------- | ---- |
| 1    | Іванов  | 1000 |
| 2    | Петров  | 2000 |
| 3    | Сидоров | 3000 |

Для атрибутів $A,B,C$ не можна зробити висновків про унікальність не знаючи їх сенсу відповідно до предметної області

###### Зауваження

1. Потенційні ключі служать засобом ідентифікації об'єктів предметної області дані про які зберігаються у відношенні
2. Потенційні ключі служать єдиним засобом адресації на рівні кортежів у відношенні

### Правило цілісності утностей

Атрибути що входять до складу деякого потенційного ключа не можуть приймати null-значення

# 07.04.22 Реляційна модель даних

### [запись](https://youtu.be/OmMMrNCl-PU)

### Зовнішні ключі

Різні об'єкти предметної області завжди пов'язані один з одним

#### Приклад 1 Співробітник має дітей

Відношення "Постачальники і деталі, що поставляються"

| Номер постачальника | Найменування постачальника | Номер деталі | Найменування деталі | Кількість, що поставляється |
| ------------------- | -------------------------- | ------------ | ------------------- | --------------------------- |
| 1                   | Іванов                     | 1            | Болт                | 100                         |
| 1                   | Іванов                     | 2            | Гайка               | 200                         |
| 1                   | Іванов                     | 3            | Винт                | 300                         |
| 2                   | Петров                     | 1            | Болт                | 150                         |
| 2                   | Петров                     | 2            | Гайка               | 250                         |
| 3                   | Сидоров                    | 3            | Винт                | 1000                        |

Потенційний ключ пара атрибутів
{"Номер постачальника","номер деталі"}

##### Проблеми у відношенні

1. Якщо зміниться найменування постачальника, то "Найменування постачальника" потрібно одночасно змінити у всіх кортежах, де воно зустрічається, інакше дані стануть суперечливими. Така ж ситуація з найменуванням деталі.
   **Висновок 1**
   Дані зберігаються у цьому відношення з великою надмірністю.
2. Якщо Петров тимчасово припинив поставки, то:
   1. Або видалити всі кортежі в яких "Найменування постачальника"="Петров"
      **Висновок 2.1**
      Це неможливо оскільки, якщо видалити усі кортежі з інформацією про постачання цього постачальника, то загубляться дані про самого Петрова як постачальника.
   2. Або залишити у відношення кортеж типу
      (2,Петров,NULL,NULL,NULL)
      **Висновок 2.2**
      Це неможливо оскільки атрибут "номер деталі" входить до складу потенційного ключа і не може містити NULL-значень

##### Узагальнення

Подібні проблеми виникають тому, що в цьому відношенні змішані різні об'єкти предметної області. Це інформація про постачальників, про деталі та про поставки деталей.
Кажуть - **відношення погано нормалізовано**
Спробуємо рознести дані по 3 відношенням - "Постачальники", "Деталі", "Поставки" і встановити яким чином дані в цих відношення взаємопов'язані між собою.

Зв'язок визначається семантично предметної області і описується фразами які відображають різні теми взаємозв'язків.

1. Постачальники виконують поставки
2. Деталі поставляються через поставки
3. Деталі поставляються постачальниками

### Типи взаємозв'язків в реляційних БД:

1. Один до багатьох
   **Приклад**: "один постачальник може виконувати кілька поставок", або "одна деталь може поставлятися кількома постачальниками"
2. Багато до багатьох
   Декілька "Один до багатьох"
   **Приклад**: "Кілька деталей поставляються кількома постачальниками"

### Батьківське відношення

те, що входить в зв'язок з боку "один"(постачальники)

### Дочірні відношення

те, що входить в зв'язок з боку "багато" (поставки)

Механізм реалізації взаємозв'язку полягає в тому, що у дочірні відношення додаються атрибути які є посиланнями на ключові атрибути батьківського відношення.

### Зовнішні ключі

Атрибути, які визначають з якими кортежами батьківського відношення пов'язані кортежі дочірнього відношення (також називаються мігруючими з батьківського відношення). У відношення поставки атрибути "номер поставок" і "номер деталі" є посиланнями на ключові атрибути відношень "постачальники і деталі", а значить зовнішніми ключами.

### Продовження прикладу постачальники деталей

**відношення "постачальники"**

| Номер постачальника | Найменування постачальника |
| ------------------- | -------------------------- |
| 1                   | Іванов                     |
| 2                   | Петров                     |
| 3                   | Сидоров                    |

**відношення "поставки"**

| Номер постачальника | Номер деталі | Кількість, що поставляється |
| ------------------- | ------------ | --------------------------- |
| 1                   | 1            | 100                         |
| 1                   | 2            | 200                         |
| 1                   | 3            | 300                         |
| 2                   | 1            | 150                         |
| 2                   | 2            | 250                         |
| 3                   | 3            | 1000                        |

**відношення деталі**

| Номер деталі | Найменування деталі |
| ------------ | ------------------- |
| 1            | Болт                |
| 2            | Гайка               |
| 3            | Гвинт               |

#### Висновок

Дані відношення вільні від недоліків описаних вище коли все зберігається в одному відношенні

### Def 2

Підмножина атрибутів FK відношення R називається зовнішнім ключем якщо:

1. Існує відношення S (R і S необов'язково рівні з потенційним ключем K)
2. Кожне значення FK у відношенні r завжди збігається зі значенням K для деякого кортежу з S або є NULL-значенням

#### Зауваження:

1. Зовнішній ключ так само як і потенційних може бути простим і складовим
2. Зовнішній ключ повинен бути визначений на тих самих доменах, що і відповідний первинний ключ батьківського відношення.
3. Зовнішній ключ як правило не має властивості унікальності
4. Якщо зовнішній ключ все таки має властивість унікальності, то зв'язок між відношеннями має тип "один до одного", а це означає, що якесь відношення було невірно розділене на 2 відношення.
5. Хоч кожне значення зовнішнього ключа і забов'язане збігатися зі значеннями потенційного ключа в деякому кортежі батьківського відношення, то зворотне не вірно
6. Для зовнішнього ключа непотрібно щоб він був компонентом деякого потенційного ключа
7. NULL-значення для атрибутів зовнішнього ключа припустимі тільки тоді, коли атрибути зовнішнього ключа не входять до складу жодного потенційного ключа.

### Правило цілісності зовнішніх ключів

Зовнішні ключі не повинні бути неузгодженими, тобто для кожного значення зовнішнього ключа має існувати відповідне значення первинного ключа в батьківському відношенні.

Порушення правила цілісності зовнішніх ключів або посилальної цілісності може трапитись в результаті операцій що змінюють стан БД.

Визначені посилальної цілісності беруть участь у відношеннях батьківське і дочірнє в кожному з них можливе 3 операції "вставка", "оновлення", "видалення". Тому взагалом повинні розглядатися 6 різних варіантів (3 для дочірніх, 3 для батьківських)

#### Операції що можуть порушити посилальну цілісність

1. Оновлення кортежу в батьківському відношенні
2. Видалення кортежу в батьківському відношенні
3. Вставка кортежу в дочірнє відношення
4. Оновлення кортежу в дочірньому відношенні

#### Стратегії підтримки посилальної цілісності:

1. RESTRICT (обмежити)
2. CASCADE (каскадувати)
3. SET NULL (встановити в NULL)
4. SET DEFAULT (вставити за умовчанням)
5. IGNORE (нехтувати)

## 6. маніпуляційна частина реляційної моделі даних (реляційна алгебра)

Третя частина реляційної моделі, маніпуляційна частина, стверджує, що доступ до реляційних даних здійснюється за допомогою реляційної алгебри або еквівалентної реляційному численню.

У реалізаціях конкретних реляційних СУБД зараз не використовуються в чистому виде ні реляційна алгебра, не реляційне числення.

Фактичним стандартом доступу до реляційних даних є мови SQL

### Мова SQL

являє собою суміш операторів реляційної алгебри і виразів реляційного числення. Вона використовує синтаксис близький фразам англійської мови і розширена додатковими можливостями, які відсутні в реляційній алгебрі та численні

### Замкнутість реляційної алгебри

Реляційна алгебра  являє собою набір операторів, що використовують відношення в якості аргументів і повертають відношення як результат.

Реляційний оператор $f:R=f(R_1,R_2,..,R_n)$ (аналог функції).
Реляційна алгебра є замкнутою, оскільки в якості аргументів в реляційні оператори можна підставити цнші реляційні оператори які підходять за типом $R=f(f_1(R_{11},R_{12},..),f_2(R_{21},R_{22},..),..)$

Тому в реляційних виразах можна використовувати вкладені вирази будь якої складної структури.

**Кожне відношення забов'язане мати унікальне ім'я в межах бази даних**
Але можна не вимагати імен від відношень якщо ці відношення підставляються в якості аргументів в інші реляційні вирази, такі відношення називають **неіменованими відношеннями**

### 2 групи реляційних операторів

Теоретико-множинні оператори

1. Об'єднання
2. Перетин
3. Віднімання
4. Декартів добуток

Спеціальні реляційні оператори

1. Вибірка
2. Проекція
3. З'єднання
4. Ділення

# 14.04.22

## [запись](https://youtu.be/KUkMxvE5uuo)

### Відношення, сумісні за типом

#### Def1

Відношення є сумісним за типом, якщо вони мають ідентичні заголовки, тобто:

1. Відношення мають одну і ту ж саму множину імен атрибутів
2. Атрибути з однаковими іменами визначені на одних й тих самих доменах

Деякі відношення не є сумісними за типом але стають ними після перейменування атрибутів.

### Оператор перейменування атрибутів (допоміжний)

#### Синтаксис:

R RENAME Atr1, Atr2, ..., AS NewAtr1, NewAtr2,..

#### приклад:

City RENAME Cite_Name AS CityID

## 6.1 Теоретико-множинні оператори

### Об'єднання

#### def2

Об'єднання двох сумісних за типом відношень А і В - це відношення з тим же заголовком, що і у відношень А і В, та тілом, що складається з кортежів або А, або В, або обом відношенням.

**Відношення А**

| Табельний номер | Прізвище | Зарплата |
| --------------- | -------- | -------- |
| 1               | Іванов   | 1000     |
| 2               | Петров   | 2000     |
| 3               | Сидоров  | 3000     |

**Відношення В**

| Табельний номер | Прізвище | Зарплата |
| --------------- | -------- | -------- |
| 1               | Іванов   | 1000     |
| 2               | Антонов  | 2500     |
| 4               | Сидоров  | 3000     |

#### Приклад:

**А UNINON B**

| табельний номер | Прізвище | Зарплата |
| --------------- | -------- | -------- |
| 1               | Іванов   | 1000     |
| 2               | Петров   | 2000     |
| 3               | Сидоров  | 3000     |
| 2               | Антонов  | 2500     |
| 4               | Сидоров  | 3000     |

#### Зауваження

Потенційні ключі відношень А і В не успадковують їх об'єднання
[подбронее](https://youtu.be/KUkMxvE5uuo?t=1230)

### Перетин

#### def3

Перетин двох сумісних за типом відношень А і В - це відношення з тим же заголовком, що і у відношень А і В, та тілом, що складається з кортежів, які належать одночасно і А, і В

#### Приклад:

| Відношення      | A intersect B | <-       |
| --------------- | ------------- | -------- |
| табельний номер | прізвище      | зарплата |
| 1               | іванов        | 1000     |

#### Синтаксис:

A INTERSECT B

#### Зауваження

Ніякі реляційні оператори не передають результуючому відношенню ніяких даних про потенційні ключі.
Ключі явно задаються для кожного відношення видячи з його змісту та моделі предметної області.

### Віднімання

#### Def4

Віднімання двох сумісних за типом відношень А і В це відношення з тим же заголовком, що у А і В, та типом, що складається з кортежів, які належать А і не належать В

#### Синтаксис:

A MINUS B

#### Приклад:

| Табельний номер | Прізвище | Зарплата |
| :-------------: | -------- | -------- |
|        2        | Петров   | 2000     |
|        2        | Сидоров  | 3000     |

### Декартів добуток

#### def5

Декартів добуток двох відношень А( $A_1,..,A_n$) i B($B_1,..B_m$) - це відношення заголовком якого є значення заголовків відношень А і В
($A_1,..A_n,B_1,..,B_m$)

А тіло складається з кортежів, які є значеннями кортежів А і В
($a_1,..,a_n,b_1,..,b_m$)
Таких що $(a_1,..,a_n)\in A,(b_1,..,b_m)\in B$

#### Синтаксис:

A TIMES B

#### Зауваження

1. Потужність A TIMES B (колво кортежів) дорівнює добутку потужностей А і В. Тому що кожен кортеж А з'єднується з кожним кортежом В.

2. Якщо у відношеннях А і В є атрибути з однаковими найменуваннями, то перед виконанням операції декартового добутку такі атрибути потрібно перейменувати

3. Перемножувати можна будь які 2 відношення сумісність за типом при цьому не потрібна

4. Для реальних запитів ця операція майже ніколи не використовується, однак вона важлива для виконання спеціальних реляційних операцій.

   #### Приклад:

   **Відношення А (постачальники)**

   | Номер постачальника | Найменування постачальника |
   | :-----------------: | :------------------------: |
   |          1          |           Іванов           |
   |          2          |           Петров           |

   **Відношення В (деталі)**

| Номер деталі | Найменування деталі |
| ------------ | ------------------- |
| 1            | Болт                |
| 2            | Гайка               |

**Відношення А TIMES B**

| Номер постачальника | Найменування деталі | Номер деталі | найменування деталі |
| ------------------- | ------------------- | ------------ | ------------------- |
| 1                   | Іванов              | 1            | Болт                |
| 1                   | Іванов              | 2            | Гайка               |
| 2                   | Петров              | 1            | Болт                |
| 2                   | Петров              | 2            | Гайка               |

## 6.2  Спеціальні реляційні оператори

### Вибірка (обмеження, селекція)

#### def6

Вибірка на відношення А з умовою с - це відношення з тим же заголовком, що і у відношення А, та тілом, що складається з кортежів, значення атрибутів яких при підстановці в с дають значення ІСТИНА
с - логічний вираз, до якого можуть входити атрибути А та (або) скалярні вирази

$\Theta$ - виборка (обмеження, селекція, Theta) с має вид $X\Theta Y$ де $\Theta$ - це $=,\not{=},<,\leq,>,\geq$ тощо, а Х і У - атрибути А або скалярні значення

#### Синтаксис

A WHERE c
або
A WHERE $X\Theta Y$
(Все з А виконується в с)

#### Приклад:

**Відношення А**

| Табельний номер | Прізвище | Зарплата |
| --------------- | -------- | -------- |
| 1               | Іванов   | 1000     |
| 2               | Петров   | 2000     |
| 3               | Сидоров  | 3000     |

**A WHERE зарплата<3000**

| Табельний номер | Прізвище | Зарплата |
| --------------- | -------- | -------- |
| 1               | Іванов   | 1000     |
| 2               | Петров   | 2000     |

### Проекція

#### def7

Проекція А по атрибутам X,Y,..,Z, де кожен з атрибутів належить А - це відношення із заголовком (X,Y,...,Z) і тілом, що містить множину кортежів виду (x,y,..z) таких, для яких у А знайдуться кортежі зі значенням атрибута Х, що дорівнює х, значенням атрибута У, що дорівнює у,...,значенням атрибута Z що дорівнює z

#### Синтаксис:

A[X,Y,...,Z]

#### Зауваження

1. Операція вибірки даж горизонтальний зріз відношення по деякій умові
2. Операція проекції дає вертикальний зріз відношення з видаленням дублекатів кортежів

#### Приклад:

**Відношення А(постачальники)**

| Номер | Найменування | Місто   |
| ----- | ------------ | ------- |
| 1     | іванов       | київ    |
| 2     | петров       | харків  |
| 3     | сидоров      | харків  |
| 4     | сидоров      | донецьк |

**Відношення А[місто постачальника]**

| Місто   |
| ------- |
| київ    |
| харків  |
| донецьк |

### З'єднання (різновиди операції)

1. загальна операція з'єднання
2. $\Theta$ - з'єднання (тета - з'єднання)
3. Екві - з'єднання
4. Природне з'єднання

#### Загальна операція з'єднання

##### def8

З'єднання відношень А і В за умовою це відношення виду (A times B) where c
c являє собою логічний вираз,  в який можуть входити атрибути відношень А і В та(або) скалярні вирази
Операція з'єднання є результатом послідовного виконання декартового добутку і вибірки

#### $\Theta$- з'єднання

##### def9

нехай відношення А містить атрибут У, відношення В містить атрибут У, а $\Theta$ - один з операторів порівняння, тоді $\Theta$ - з'єднання відношення А по атрибуту У з відношення В по атрибуту У - це відношення
**(A TIMES B) WHERE X $\Theta$ Y **
Або
**A[X$\Theta$Y]B**
![image-20220419170156848](https://s2.loli.net/2022/04/19/9waiCfyvo7PVBXK.png)

#### Екві-з'єднання

Окремий випадок $\Theta$-з'єднання, коли тета є просто рівність:
**A[X=Y]B**
Недоліком цієї операції є 2 атрибута з однаковими значеннями в результуючому відношенні

![image-20220419170220340](https://s2.loli.net/2022/04/19/6qDtkdRAO8XZw4E.png)

# 23.04.22

## [ссылка](https://youtu.be/XNqEe8WwAwk)

### Природне з'єднання

#### def10

Нехай дано відношення $A(A_1,A_2,..A_n,X_1,X_2,..,X_p)$ і $B(X_1,X_2,..X_p,B_1,B_2,..B_m)$, що мають однакові атрибути $X_1,X_2,..,X_p$ (тобто атрибути з однаковими іменами і визначені на однакових доменах).
Тоді **природне з'єднання** відношень А і В - це відношення із заголовком $(A_1,A_2,..A_n,X_1,X_2,..X_p,B_1,B_2,..,B_m)$ і тілом що містить множину кортежів $(a_1,a_2,..a_n,x_1,x_2,..x_p,b_1,b_2,.,b_m)$, таких що $(a_1,a_2,.a_n,x_1,x_2,..,x_p)\in A$ і $(x_1,x_2,..,x_p,b_1,b_1,..,b_m)\in B$

#### синтаксис

A JOIN B

#### Зауваження

1. Природне з'єднання виконується по всім однаковим атрибутам
2. Природне з'єднання еквівалентно наступній послідовності реляційних операцій:
   1. Перейменувати однакові атрибути у відношеннях
   2. Виконати декартів добуток відношень
   3. Виконати вибірку та з співпадаючими значеннями атрибутів які мали однакові імена
   4. Виконати проекцію видаливши повторювані атрибути.
   5. Перейменувати атрибути повернувши їм початкові імена
3. Природне з'єднання має властивість ассоціативності тобто:
   **(A JOIN B) JOIN C = A JOIN (B JOIN C) = A JOIN B JOIN C**

#### Приклад

Постачальники Р деталі D і постачання PD:
Запитання: Які деталі поставляються якими постачальниками?
Відповідь на запитання:
P JOIN PD JOIN D
![image-20220423150944087](https://s2.loli.net/2022/04/23/poLIhGk49EwVJnr.png)

### Ділення

#### def11

Нехай відношення $A(X_1,X_2,..X_p,Y_1,Y_2,..Y_m)$ і $B(Y_1,Y_2,..Y_m)$ причому **атрибути** $Y_1,Y_2,..Y_m$ - **загальні** для двох відношень.

**Діленням** відношень А і В називається **відношення** з заголовком $(X_1,X_2,..X_p)$ і тілом, що містить множину кортежів $(x_1,x_2,..,x_p)$ таких що для всіх кортежів $(y_1,y_2,..,y_m)\in B$ у відношенні А знайдеться кортеж $(x_1,x_2,..x_P,y_1,y_2,..y_m)$.

Відношення А - **ділене**, відношення В  **дільник**

#### Синтаксис

A DEVIDEBY B

#### Приклад

Постачальники Р деталі D іі постачання (PD)

Запитання:
Які постачальники поставляють всі деталі?

Відповідь на запитання:
X DEVIDEBY Y, де X=PD[PNUM,DNUM] i Y=D[DNUM]
![image-20220423151948973](https://s2.loli.net/2022/04/23/VsBpCb1vLFe4tPR.png)

#### Зауваження

Типові запити які реалізуються за допомогою операції ділення в своєму формулюванні мають слово "ВСІ"
[пример](https://youtu.be/XNqEe8WwAwk?t=2220)

## 6.3. Приклади використання реляційних операторів

### Приклад

постачальники Р, деталі D і постачання PD:

1. Отримати імена постачальників, що поставляють деталь номер 2.
   Розв'язок:
   ((PD JOIN P) WHERE DNUM=2)[PNAME]
2. Отримати імена постачальників, що поставляють принаймні одну гайки.
   Розв'язок:
   (((D WHERE DNAME = Гайка) JOIN PD) JOIN P) [PNAME]
   або
   (((D JOIN PD) JOIN P) WHERE DNAME = Гайка) [PNAME]
3. Отримати імена постачальників, що поставляють всі деталі
   Розв'язок:
   ((PD [PNUM, DNUM] DEVIDEBY D  [DNUM]) JOIN P) [PNAME]
4. Отримати імена постачальників, що не постачають деталь номер2?

# Нормальні форми відношень

## 1. Етапи розробки бази даних

Метою розробки будь-якої БД є зберігання й використання інформації про будь-яку предметну область.
Для реалізації цієї мети використовують інструменти

1. Реляційна модель даних як зручний спосіб представлення даних предметної області
2. Мова SQL - як універсальний спосіб маніпулювання такими даними

Для однієї і тієї ж предметної області реляційні відношення можна спроектувати безліччю різних способів. Наприклад, або кілька відношень з великою кількістю атрибутів, або навпаки - рознести всі атрибути по великому числу дрібних відношень.

### Рівні моделювання БД:

1. Предметна область 
2. Модель предметної області
3. Логічна модель даних
4. Фізична модель даних
5. БД і додатки

### Предметна область

частина реального світу дані про яку ми хочемо відобразити

### Модель предметної області 

наші знання про предметну область, які можуть бути як у вигляді неформальних знань так і виражені формально за допомогою будь-яких засобів

### Логічна модель даних

описує поняття предметної області їх взаємозв'язок, а також обмеження на дані що надаються предметною областю, вона є початковим прототипом майбутньої БД.

### Фізична модель даних 

описує дані засобами вже конкретної СУБД

### БД

Реалізується на конкретній програмно - апаратній основі

## 2. Критерії оцінки якості логічної моделі даних

### 1. Адекватність БД предметної області

- стан БД в кожен момент часу має відповідати стану предметної області
- зміна стану предметної області має призводити до відповідної зміни стану БД

### 2. Легкість розробки с супроводу БД

- практично будь-яка БД за винятком елементарних містить деяку кількість прогромного коду у вигляді тригерів і збережуваних процедур

#### Збережувані процедури

це процедури і функції, що зберігаються безпосередньо у БД у відкомпільованому вигляді я які можуть запуститися користувачем або додатками.
Вони пишуться або на спеціальному процедурному розширенні мови SQL, наприклад PL\SQL для Oracle, або на деякій універсальній мові програмування, наприклад, с++ з включенням в код операторів SQL

#### Тригери

Збережувані процедури пов'язані з деякими подіями, що відбуваються під час роботи БД. Наприклад, операції оновлення, вставки та видалення для рядків таблиці.

Основне призначення тригерів - автоматична підтримка цілісності БД

#### Висновок

Чим більше програмного коду у вигляді тригерів і збережуваних процедур містить БД, тим складніша її розробка і подальший супровід

### 3. Швидкість операцій оновлення даних (Вставка, оновлення,  видалення)

Чим більше атрибутів має таблиція, тим більше для неї буде оголошено індексів. Швидкість виконання операцій вставки зменшується при збільшенні кількості індексів у таблиці і мало залежить від числа рядків таблиці.

Швидкість виконання операцій оновлення і видалення також зменшується при збільшенні кількості індексів і не залежить від числа рядків.

#### висновок

Чим більше атрибутів мають відношення, тим повільніше будуть виконуватись операції оновлення даних, за рахунок втрати часу на перебудову великої кількості індексів

### Швидкість операцій вибірки даних

Одне з призначень БД - надання інформації користувачам яке виконується за допомогою оператора SELECT мови SQL, що заснований на операції з'єднання

#### Висновок

Збільшення кількості відношень призводить до уповільнення виконання операцій вибірки даних особливо якщо запити заздалегідь невідомі.

# Лекція 28.04

## [посилання](https://youtu.be/XTsnoQIUI5A)

## 3.1 Перша нормальна форма відношення (1НФ)

**Перша нормальна форма** - звичайне відношення

На першому кроці будемо зберігати дані в одному відношенні, що має такі атрибути:
Співробітники-Відділи-Проекти (НСПІВР, ПРІЗВ,НВІД,ТЕЛ,НПРО,ПРОЕКТ,НЗАВД)

- НСПІВР - табельний номер співробітника
- ПРІЗВ - прізвище
- НВІД - номер відділення співробітника
- ТЕЛ - телефон
- НПРО - номер проекти
- НЗАВД - номер завдання

Оскільки кожен співробітника в кожному проекті виконує рівно одне завдання, то потенційний ключ - {НСПІВР,НПРО}
![image-20220430175338089](https://s2.loli.net/2022/04/30/Hv4DUg8N5LzjQ2M.png)

## 3.4 Аномалії оновлення

### Види аномалій:

1. Аномальність вставки (INSERT)
   У відношенні (1) - не можна вставити дані про співробітника який поки не бере участь ні в одному проекті (наприклад 4, Антонов,2 707-22-22, null, null,null)

   -не можна вставити дані про проект, над яким поки не працює жоден співробітник.

2. Аномалії оновлення (UPDATE)
   Якщо співробітник змінює прізвище, або проект змінює найменування, або змінюється номер телефону, то такі зміни необхідно одночасно виконати в усіх місцях інакше відношення стане некоректним

Оновлення бд однією дією неможливе

3. Аномалії видалення (DELETE)
   при видаленні деяких даних може трапитися втрата іншої інформації, наприклад якщо закрти проект Турбіна і видалити всі рядки в яких він зустрічається, то будуть втрачені всі дані про співробітника Сидорова.

Причина аномалій

Зберігання в одному відношенні різнорідної інформації (і співробітники, і проекти, і роботи по проекту)

#### Висновок

Логічна модель даних неадекватна моделі предметної області. БД заснована на такій моделі даних буде працювати неправильно.

## 3.5 Функціональні залежності

Для усунення зазначених аномалій і правильного проектування моделі даних застосовується метод нормалізації відношень. Ця нормалізація застосована на понятті функціональної залежності атрибутів відношення.

### def1

Нехай R - відношення множина атрибутів У функціонально залежна від множини атрибутів Х, коли для будь-яких кортежів <img src="https://s2.loli.net/2022/04/30/nwqhZYipI3R7kTa.png" alt="image-20220430180542881" style="zoom:50%;" /> - з того що <img src="https://s2.loli.net/2022/04/30/ayoiUcXmqsuIx6W.png" alt="image-20220430180601928" style="zoom:50%;" /> випливає, що<img src="https://s2.loli.net/2022/04/30/67vDGW9xuEAkSYB.png" alt="image-20220430180617697" style="zoom:50%;" />

Позначення функціональної залежності:

![image-20220430180745396](https://s2.loli.net/2022/04/30/7YqXGBCzTUI8eNw.png)

Функціональна залежність означає що у всіх кортежах що мають однакові значення атрибутів Х значення атрибутів У також збігаються у бідь-якому стані відношення R
В функціональній залежності множина атрибутів Ч (від чого залежить) називається - **детермінантом**
Функціональна залежність а множини атрибутів У (що залежить) називається - **залежною частиною**

#### Зауваження

якщо атрибути Х складають потенційний ключ відношення R то будь-який атрибут відношення R функціонально залежить від Х

випишемо всі функціональні залежності у відношенні 

СПІВРОБІТНИКИ-ВІДДІЛИ-ПРОЕКТИ:

1. Залежність атрибутів від ключа відношення:

![image-20220430181305274](https://s2.loli.net/2022/04/30/k8J5xBEW4DlzqL2.png)

2. залежність атрибутів що характеризують співробітника від табельного номера співробітника:
   ![image-20220430181339023](https://s2.loli.net/2022/04/30/vCKEiY9uQGM3Xfq.png)
3. Залежність найменування проекту від номера проекту:
   ![image-20220430181402500](https://s2.loli.net/2022/04/30/zCKiBJ9wQAPnuas.png)
4. Залежність номера телефону від номера відділу:
   ![image-20220430181429555](https://s2.loli.net/2022/04/30/t5sVQUhFPzg691X.png)

#### Зауваження

1. наведені функціональні залежності не виведені з зовнішнього вигляду відношення табл (1).
   Ті залежності відображають взаємозв'язки між об'єктами предметної області і є додатковими обмеженнями які визначаються предметною областю.
2. функціональна залежність атрибутів стверджує лише те, що для кожного конкретного стану БД за значенням одного атрибуту (детермінанта) можна однозначно визначити значенням іншого атрибуту (залежної частини), але конкретні значення залежної частини можуть бути різними в різних станах БД

## 3.7 друга нормальна форма (2НФ)

### def2

відношення R знаходиться в 2НФ тоді і тільки тоді, коли відношення знаходиться в 1НФ і немає неключових атрибутів, залежних від частини складного ключа.

**Неключовий атрибут** - це атрибут, який не входить до складу жодного потенційного ключа.

### Зауваження

Якщо потенційний ключ відношення є простим, то відношення автоматично перебуває в 2НФ

## 3.8 Приведення до 2НФ

для того щоб усунути залежність атрибутів від частини складного (складеного) ключа, потрібно зробити декомпозицію відношення на кілька відношень.
При цьому ті атрибути які залежать від частини складного ключа виносяться в окреме відношення разом з цією частиною потенційного ключа і ця ж частина ключа залишається в вихідному відношення для зв'язку відношень.

Відношення (1) не знаходиться в 2НФ тому є атрибути які залежать від частини складного ключа

![image-20220430192050967](https://s2.loli.net/2022/05/01/qlsvjQ6SruDft5W.png)

Відношення (1) депомпозуємо на 3 відношення

1. СПІВРОБІТНИКИ-ВІДДІЛИ(1_1)
2. ПРОЕКТИ(1_2)
3. ЗАВДАННЯ(1_3)

1. Відношення СПІВРОБІТНИКИ-ВІДДІЛИ (НСПІВР, ПРІЗВ, НВІД, ТЕЛ)
   Функціональні залежності:
   ![image-20220430192246444](https://s2.loli.net/2022/05/01/V6BxNXrP9WYis23.png)
2. Відношення ПРОЕКТИ (НПРО, ПРОЕКТ)
   Функціональні залежності:
   ![image-20220430192321105](https://s2.loli.net/2022/05/01/kYUr6Rfx1BLjZl9.png)
3. Відношення ЗАВДАННЯ (НСПІВР, НПРО, НЗАВД)
   Функціональні залежності:
   ![image-20220430192355663](https://s2.loli.net/2022/05/01/8vVDnSXgTl4Yhsx.png)

![image-20220430192415543](https://s2.loli.net/2022/05/01/Nef1OhZRjorV43b.png)

![image-20220430192424480](https://s2.loli.net/2022/05/01/Uox4WXja61hyFL8.png)

![image-20220430192443296](https://s2.loli.net/2022/05/01/5XGvLh3MAKTDylV.png)

## 3.10 аналіз декомпозованих відношень

Відношення отримані в результаті декомпозиціх знаходяться в 2НФ тому що відношення (1_1)(1_2) мають прості ключі а у відношені  завдання (1_3) що має складнеий ключ є єдиний не ключовий атрибут що залежить від всього ключа.

#### Висновок

**Частина аномалій оновлення усунена** і тепер дані про співробітників і проекти зберігається у різних відношеннях.
Так наприклад при появі співробітників, які не беруть участь ні в одному проекті просто додаються кортежі у (1_1) так само при появі проекту
Прізвище і найменування тепер зберігаються буз надмірності і оновлення необхідно робити в одному місці

**Частину аномалій усунути не вдалося**
Решта аномалій:

1. Аномалія вставки (INSERT)
   у відношенні (1_1) не можна вставити кортеж (4, антонов, 1, 606-22-22) оскільки при цьому вийде що 2 співробітника з одного відділу (іванов, антонов) мають різні номера телефонів
   Це суперечить моделі предметної області
2. Аномалій оновлення (UPDATE)
   Одні й ті ж номера телефонів повторюються в багатьох кортежах відношення.
   Оновлення БД однією дією неможливо
3. Аномалії видалення (DELETE)
   При видаленні деяких даних як і раніше може статися втрата інших даних, наприклад при видаленні Петрова та буде втрачена інформація про те що в відділу 2 знаходиться телефон 606-22-22
   Причина аномалій:
   Зберігання в одному відношенні різноманітних даних

##### Висновок

Логічна модель даних неадекватна моделі предметної області БД заснована на такій моделі буде працбювати неправильно

## 3.11 Третя нормальна форма (3НФ)

### def3

Атрибути називаються взаємно незалежними якщо жодеен з них не є функціонально залежним від іншого

### def4

Відношення R знаходиться у 3НФ тоді і тільки тоді коли відношення знаходиться в 2НФ і всі неключові атрибути взаємно незалежні.

## 3.12 приведення 3НФ

Для того щоб усунути залежність неключових атрибутів треба зробити декомпозицію відношення на кілька відношень при цьому ті не ключові атрибути які є залежними виносяться в окреме відношення разом з детермінантами функціональних залежностей і ці ж детермінанти залишаються в вихідному відношенні для їх зв'язку.

Відношення (1_2) в 3НФ
Відношення (1_1) не в 3НФ тому що є функціональна залежність неключових атрибутів (залежність НВІД - ТЕЛ)

Відношення (1_1) - декомпонуємо на 2 співробітники (2_1) відділи (2_2)

1. Відношення (2_1) (НСПІВР,ПРІЗВ, НВІД)
   функціональна залежність:

   ![image-20220430195426368](https://s2.loli.net/2022/05/01/bHOmKLy8k1uWAoD.png)

2. Відношення ВІДДІЛИ (НВІД, ТЕЛ)
   ![image-20220430195504269](https://s2.loli.net/2022/05/01/ltNfUgRHhVByALX.png)
   Атрибут НВІД що не був ключовим у 1_1 стає потенційним ключем у 2_1 і за рахунок цього усувається надмірність у номерах телефонів

## Повна модель бази даних

Повна модель БД в природі - це реляційна моедль, що складається з чотирьох відношень (1_2), (1_3)(2_1)(2_2)

**схема:**
![image-20220430195702379](https://s2.loli.net/2022/05/01/d8izemMfahpGRjt.png)

